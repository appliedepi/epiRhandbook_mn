<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>8 Дата цэвэрлэгээ ба үндсэн функцууд | Тархвар судлаачийн R гарын авлага</title>
<meta name="author" content="гарын авлагын баг">
<meta name="description" content="Энэ бүлэгт датаг “цэвэрлэхэд” хэрэглэгддэг нийтлэг аргууд болон R-ын дата менежментийн үндсэн функцуудыг сурах болно. Дата цэвэрлэгээ хийх алхам бүрийг “raw” (түүхий) дата (linelist) импортлохоос...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="8 Дата цэвэрлэгээ ба үндсэн функцууд | Тархвар судлаачийн R гарын авлага">
<meta property="og:type" content="book">
<meta property="og:description" content="Энэ бүлэгт датаг “цэвэрлэхэд” хэрэглэгддэг нийтлэг аргууд болон R-ын дата менежментийн үндсэн функцуудыг сурах болно. Дата цэвэрлэгээ хийх алхам бүрийг “raw” (түүхий) дата (linelist) импортлохоос...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="8 Дата цэвэрлэгээ ба үндсэн функцууд | Тархвар судлаачийн R гарын авлага">
<meta name="twitter:description" content="Энэ бүлэгт датаг “цэвэрлэхэд” хэрэглэгддэг нийтлэг аргууд болон R-ын дата менежментийн үндсэн функцуудыг сурах болно. Дата цэвэрлэгээ хийх алхам бүрийг “raw” (түүхий) дата (linelist) импортлохоос...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.20/datatables.js"></script><link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style_bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Тархвар судлаачийн R гарын авлага</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li class="book-part">Preview pages</li>
<li><a class="" href="%D1%80%D0%B5%D0%B4%D0%B0%D0%BA%D1%86%D0%B8%D0%B9%D0%BD-%D0%B1%D0%BE%D0%BB%D0%BE%D0%BD-%D1%82%D0%B5%D1%85%D0%BD%D0%B8%D0%BA%D0%B8%D0%B9%D0%BD-%D1%82%D1%8D%D0%BC%D0%B4%D1%8D%D0%B3%D0%BB%D1%8D%D0%BB.html"><span class="header-section-number">1</span> Редакцийн болон техникийн тэмдэглэл</a></li>
<li><a class="" href="%D0%B3%D0%B0%D1%80%D1%8B%D0%BD-%D0%B0%D0%B2%D0%BB%D0%B0%D0%B3%D0%B0-%D3%A9%D0%B3%D3%A9%D0%B3%D0%B4%D0%BB%D0%B8%D0%B9%D0%B3-%D1%82%D0%B0%D1%82%D0%B0%D0%B6-%D0%B0%D0%B2%D0%B0%D1%85.html"><span class="header-section-number">2</span> Гарын авлага, өгөгдлийг татаж авах</a></li>
<li><a class="" href="r-%D1%81%D1%83%D1%83%D1%80%D1%8C-%D0%BE%D0%B9%D0%BB%D0%B3%D0%BE%D0%BB%D1%82%D1%83%D1%83%D0%B4.html"><span class="header-section-number">3</span> R суурь ойлголтууд</a></li>
<li><a class="" href="r-%D1%80%D1%83%D1%83-%D1%88%D0%B8%D0%BB%D0%B6%D0%B8%D1%85.html"><span class="header-section-number">4</span> R руу шилжих</a></li>
<li><a class="" href="%D1%81%D0%B0%D0%BD%D0%B0%D0%BB-%D0%B1%D0%BE%D0%BB%D0%B3%D0%BE%D1%85-%D0%B1%D0%B0%D0%B3%D1%86%D1%83%D1%83%D0%B4.html"><span class="header-section-number">5</span> Санал болгох багцууд</a></li>
<li><a class="" href="r-%D1%82%D3%A9%D1%81%D3%A9%D0%BB.html"><span class="header-section-number">6</span> R төсөл</a></li>
<li><a class="" href="%D1%84%D0%B0%D0%B9%D0%BB-%D0%B8%D0%BC%D0%BF%D0%BE%D1%80%D1%82%D0%BB%D0%BE%D0%B6-%D1%8D%D0%BA%D1%81%D0%BF%D0%BE%D1%80%D1%82%D0%BB%D0%BE%D1%85.html"><span class="header-section-number">7</span> Файл импортлож экспортлох</a></li>
<li><a class="active" href="%D0%B4%D0%B0%D1%82%D0%B0-%D1%86%D1%8D%D0%B2%D1%8D%D1%80%D0%BB%D1%8D%D0%B3%D1%8D%D1%8D-%D0%B1%D0%B0-%D2%AF%D0%BD%D0%B4%D1%81%D1%8D%D0%BD-%D1%84%D1%83%D0%BD%D0%BA%D1%86%D1%83%D1%83%D0%B4.html"><span class="header-section-number">8</span> Дата цэвэрлэгээ ба үндсэн функцууд</a></li>
<li><a class="" href="%D0%BE%D0%B3%D0%BD%D0%BE%D0%BE%D1%82%D0%BE%D0%B9-%D0%B0%D0%B6%D0%B8%D0%BB%D0%BB%D0%B0%D1%85-%D0%BD%D1%8C.html"><span class="header-section-number">9</span> Огноотой ажиллах нь</a></li>
<li><a class="" href="%D0%BA%D0%B0%D1%80%D0%B0%D0%BA%D1%82%D0%B5%D1%80-%D0%B1%D0%B0-%D1%81%D1%82%D1%80%D0%B8%D0%BD%D0%B3%D1%81.html"><span class="header-section-number">10</span> Карактер ба стрингс</a></li>
<li><a class="" href="%D1%84%D0%B0%D0%BA%D1%82%D0%BE%D1%80.html"><span class="header-section-number">11</span> Фактор</a></li>
<li><a class="" href="%D0%B4%D0%B0%D1%82%D0%B0%D0%B3-%D0%BF%D0%B8%D0%B2%D0%BE%D1%82-%D1%85%D0%B8%D0%B9%D1%85.html"><span class="header-section-number">12</span> Датаг пивот хийх</a></li>
<li><a class="" href="%D0%B4%D0%B0%D1%82%D0%B0%D0%B3-%D0%B1%D2%AF%D0%BB%D1%8D%D0%B3%D0%BB%D1%8D%D1%85.html"><span class="header-section-number">13</span> Датаг бүлэглэх</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="дата-цэвэрлэгээ-ба-үндсэн-функцууд" class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> Дата цэвэрлэгээ ба үндсэн функцууд<a class="anchor" aria-label="anchor" href="#%D0%B4%D0%B0%D1%82%D0%B0-%D1%86%D1%8D%D0%B2%D1%8D%D1%80%D0%BB%D1%8D%D0%B3%D1%8D%D1%8D-%D0%B1%D0%B0-%D2%AF%D0%BD%D0%B4%D1%81%D1%8D%D0%BD-%D1%84%D1%83%D0%BD%D0%BA%D1%86%D1%83%D1%83%D0%B4"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-figure"><img src="images/cleaning.png" width="265" height="10%" style="display: block; margin: auto;"></div>
<p>Энэ бүлэгт датаг “цэвэрлэхэд” хэрэглэгддэг нийтлэг аргууд болон R-ын дата менежментийн үндсэн функцуудыг сурах болно.</p>
<p>Дата цэвэрлэгээ хийх алхам бүрийг “raw” (түүхий) дата (linelist) импортлохоос авахуулаад хийгдэх үйлдэл бүрийг нэг бүрчлэн тайлбарлах болно. R- дата цэвэрлэгээ “pipe” (хоолой) холбоосоор дамжин хийгддэг бөгөөд “pipe” <code>%&gt;%</code> буюу холбогч оператор дамжуулах үйлдлийг гүйцэтгэдэг.</p>
<div id="үндсэн-функцууд" class="section level3 unnumbered">
<h3>Үндсэн функцууд<a class="anchor" aria-label="anchor" href="#%D2%AF%D0%BD%D0%B4%D1%81%D1%8D%D0%BD-%D1%84%D1%83%D0%BD%D0%BA%D1%86%D1%83%D1%83%D0%B4"><i class="fas fa-link"></i></a>
</h3>
<p>Энэхүү номонд <a href="https://www.tidyverse.org/"><strong>tidyverse</strong></a> -ын харъяа багцууд, тэдний функцуудыг голчлон тайлбарлна. Гол хэрэглэгдэх функцуудыг дор жагсаав.</p>
<p><strong>tidyverse</strong> багцын нэг <a href="https://dplyr.tidyverse.org/"><strong>dplyr</strong></a> багцын дата засаж, янзалдаг “үйл үгэн” функцууд түлхүү орсон (<strong>dplyr</strong> багцын нэр “data frame-<a href="https://www.thefreedictionary.com/plier#:~:text=also%20ply%C2%B7er%20(pl%C4%AB%E2%80%B2,holding%2C%20bending%2C%20or%20cutting.)(%D1%85%D2%AF%D1%81%D0%BD%D1%8D%D0%B3%D1%82%D0%B8%D0%B9%D0%B3%20%D0%B7%D0%B0%D1%81%D0%B0%D1%85)%22%20%D0%B3%D1%8D%D1%81%D1%8D%D0%BD%20%D1%83%D1%82%D0%B3%D0%B0%D1%82%D0%B0%D0%B9">plier</a> буюу”хүснэгт засагч” гэсэн утгатай).( <strong>tidyverse</strong> –ын бусад багцуудад <strong>ggplot2</strong>,<strong>tidyr</strong>,<strong>stringr</strong>,<strong>tibble</strong>,<strong>purrr</strong>,<strong>magrittr</strong>,<strong>forcats</strong> ордог).</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="34%">
<col width="44%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Utility</th>
<th>Package</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>%&gt;%</code></td>
<td>“pipe” (хоолой) нь датаг нэг функцээс нөгөөд дамжуулна</td>
<td><pre><code>| **magrittr**</code></pre></td>
</tr>
<tr class="even">
<td><code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code></td>
<td>Баганыг үүсгэж, хувиргаж, өөрчилдөг | **dp</td>
<td>lyr**</td>
</tr>
<tr class="odd">
<td><code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code></td>
<td>Баганыг үлдээж, арилгаж, шинээр нэр өгдөг</td>
<td>| <strong>dplyr</strong>
</td>
</tr>
<tr class="even">
<td><code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code></td>
<td>Баганыг шинээр нэрлэдэг</td>
<td><pre><code>  | **dplyr**</code></pre></td>
</tr>
<tr class="odd">
<td><code>clean_names()</code></td>
<td>Баганын нэрсийг жигд болгодог | **janit</td>
<td>or**</td>
</tr>
<tr class="even">
<td>
<code><a href="https://rdrr.io/r/base/character.html">as.character()</a></code>, <code><a href="https://rdrr.io/r/base/numeric.html">as.numeric()</a></code>, <code><a href="https://rdrr.io/r/base/as.Date.html">as.Date()</a></code>, etc.</td>
<td>Баганадах дата төрлийг өөрчилнө. | | *</td>
<td>*base** R</td>
</tr>
<tr class="odd">
<td><code><a href="https://dplyr.tidyverse.org/reference/across.html">across()</a></code></td>
<td>Олон баганыг зэрэг хувиргана | <strong>dplyr</strong>
</td>
<td></td>
</tr>
<tr class="even">
<td>
<strong>tidyselect</strong> functions</td>
<td>Баганыг сонгохдоо logic ашиглана |</td>
<td>| <strong>tidyselect</strong>
</td>
</tr>
<tr class="odd">
<td><code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code></td>
<td>Тодорхой мөрүүдийг авч үлдэх</td>
<td><pre><code>     | **dplyr**</code></pre></td>
</tr>
<tr class="even">
<td><code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct()</a></code></td>
<td>Мөрүүдийг давхардалтыг арилгах</td>
<td><pre><code> | **dplyr**</code></pre></td>
</tr>
<tr class="odd">
<td><code><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise()</a></code></td>
<td>Мөр дагуу үйлдэл хийх | **dplyr</td>
<td>**</td>
</tr>
<tr class="even">
<td><code><a href="https://tibble.tidyverse.org/reference/add_row.html">add_row()</a></code></td>
<td>Мөрийг гараар нэмэх | |</td>
<td><strong>tibble</strong></td>
</tr>
<tr class="odd">
<td><code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code></td>
<td>Мөрийг эрэмбэлэх</td>
<td><pre><code> | **dplyr**</code></pre></td>
</tr>
<tr class="even">
<td><code><a href="https://dplyr.tidyverse.org/reference/recode.html">recode()</a></code></td>
<td>Баганадах утгыг дахин өгөх |</td>
<td><strong>dplyr</strong></td>
</tr>
<tr class="odd">
<td><code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code></td>
<td>Баганад илүү нарийвчилсэн логик шалгуураар утга оруулна| **dplyr</td>
<td>**</td>
</tr>
<tr class="even">
<td>
<code><a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/na_if.html">na_if()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/coalesce.html">coalesce()</a></code>
</td>
<td>Баганад утга өгөх тусгай функцууд</td>
<td><strong>tidyr</strong></td>
</tr>
<tr class="odd">
<td>
<code>age_categories()</code> and <code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code>
</td>
<td>Тоон утгатай баганаас ангилал үүсгэ | * | *epikit</td>
<td>
<strong>and</strong> base** R</td>
</tr>
<tr class="even">
<td><code>clean_variable_spelling()</code></td>
<td>Датаны тайлбар толийг ашиглан баганын утгыг өөрчлөх, арилг</td>
<td>ах | <strong>linelist</strong>
</td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/base/which.html">which()</a></code></td>
<td>Логик шалгуур ашиглах; Индексийг харуулах (return indices)</td>
<td><pre><code>             | **base** R</code></pre></td>
</tr>
</tbody>
</table></div>
<p>Эдгээр функцууд Stata болон SAS программ дээр хэрхэн бичигддэг талаар [Transition to R] -линкээс үзэж болно.</p>
<p>Датаг янзалж байхад R-ын <strong>data.table</strong> багцын операторууд болох <code>:=</code>,<code>[ ]</code> гарч ирж болно. <strong>data.table</strong> багцын хэрэглэгддэг синтакс, аргачлалыг [Data Table] хуудаст товч оруулсан.</p>
</div>
<div id="нэр-томьёо" class="section level3 unnumbered">
<h3>Нэр томьёо<a class="anchor" aria-label="anchor" href="#%D0%BD%D1%8D%D1%80-%D1%82%D0%BE%D0%BC%D1%8C%D1%91%D0%BE"><i class="fas fa-link"></i></a>
</h3>
<p>Энэхүү номонд хувьсагч (variable) -ийг багана, ажиглалт (observations) -ийг мөр гэж нэрших болно. Тархвар судлалын ихэнх датаг гол бүрдүүлдэг зүйлс бол багана, мөр, доторх утга гэж <a href="https://tidyr.tidyverse.org/articles/tidy-data.html">“tidy data”</a> -д тайлбарласан байдаг.</p>
<p><em>Variables</em> (Хувьсагч) нь ижил хэв шинжтэй утгуудыг агуулсан байдаг (насны бүлэг, өвчин эхэлсэн огноо, эмчилгээний үр дүн гэх мэт). <em>Observations</em> (Ажиглалт) гэж тухайн нэгжид хийгдсэн бүх хэмжилтүүдийг хэлнэ (хүн, газар, лабораторийн дээж материал). Эдгээр шинж талуудыг бодитоор, барьцтай илэрхийлэх нь бэрхшээлтэй.</p>
<p>“Tidy” (цэгцтэй) датанд багана болгон хувьсагч, мөр болгон ажиглалт, нэг нүд болгон нэг утгыг зааж байдаг. Цэгцтэй загварт хэлбэржээгүй дата зарим тохиолдол бий. Тухайлбал “wide”(өргөн) дата гэхэд хувьсагч нь хэд хэдэн баганад хуваагдан байрладаг. Үүний жишээг [Pivoting data]-т хэсэгт харуулсан. Ажиглалт ч гэсэн хэд хэдэн мөрөнд хуваагдан байрласан байх тохиолдол бий.</p>
<p>Энэ номонд бид датаг хэрхэн хувиргаж, янзлаж, менежмент хийд талаар харуулахыг илүү эрмэлзсэн. Тийм ч учраас хувьсагч, ажиглалт зэрэг хийсвэр ойлголт хэрэглэхийн оронд мөр, багана зэрэг бодитой бүтэц заасан нэршилийг хэрэглэхээр шийдсэн. Харин статистик дүн шинжилгээний талаар тайлбарласан хэсгүүдэд хувьсагч, ажиглалт гэсэн нэршил илүү хэрэглэгдсэн.</p>
<!-- ======================================================= -->
<!-- ======================================================= -->
<!-- ======================================================= -->
</div>
<div id="цэвэрлэх-холбоос" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> Цэвэрлэх холбоос<a class="anchor" aria-label="anchor" href="#%D1%86%D1%8D%D0%B2%D1%8D%D1%80%D0%BB%D1%8D%D1%85-%D1%85%D0%BE%D0%BB%D0%B1%D0%BE%D0%BE%D1%81"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Энэ хэсэгт дата цэвэрлэгээг үе шат тус бүрээр нь тайлбарласан. Цэвэрлэгээний явцыг “pipe” цэвэрлэх холбоост нэг бүрчлэн залгаж үзүүлсэн.</strong></p>
<p>Тархвар судлалд датаг янзлах, цэвэрлэх нь хоорондоо холбоотой дараалласан үйлдлүүдээс бүрддэг. R программ дээр цэвэрлэгээг хийхдээ мөн адил <em>датаг нэг цэвэрлэх шатнаас нөгөөд угсруулан үйлддэг.</em></p>
<p>Ийм угсруулсан үйлдлүүдийг <strong>dplyr</strong> -ын “үйл үгт” функцуууд болон <strong>magrittr</strong>-ын pipe<code>%&gt;%</code> холбогч оператор хамтран гүйцэтгэдэг. Цэвэрлэгээ түүхий датагаар (“linelist_raw.xlsx”) эхлээд R -ын “цэвэрхэн” хүснэгт (<code>linelist</code>) болж гардаг. Үүнийг шууд ашиглаж, хадгалж, экспортлож болно.</p>
<p>Цэвэрлэгээ хийж байхад үйлдлийн дараалал чухал. Нийтлэг хийгддэг үйлдлийн дараалалд:</p>
<ul>
<li>Датаг оруулж ирэх<br>
</li>
<li>Баганын нэрсийг өөрчлөх, арилгах<br>
</li>
<li>Давхардсан утгуудыг арилгах<br>
</li>
<li>Багана нэмж, хувиргах (утгыг дахин кодлох, стандардчилах гэх мэт)<br>
</li>
<li>Мөрүүдийг шүүж, хасаж, нэмэх</li>
</ul>
<!-- ======================================================= --><!-- ======================================================= --><!-- ======================================================= -->
</div>
<div id="багцуудыг-ачааллах" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> Багцуудыг ачааллах<a class="anchor" aria-label="anchor" href="#%D0%B1%D0%B0%D0%B3%D1%86%D1%83%D1%83%D0%B4%D1%8B%D0%B3-%D0%B0%D1%87%D0%B0%D0%B0%D0%BB%D0%BB%D0%B0%D1%85"><i class="fas fa-link"></i></a>
</h2>
<p>Дараах кодыг уншуулж шаардлагатай багцуудыг ачааллана. Энэ номонд багцыг ачааллахад <strong>pacman</strong> -ны <code><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load()</a></code>-ыг голчлон хэрэглэнэ. Учир нь энэ функц шаардлагатай багцыг автоматаар татаж авч, ачааллаад ажиллахад бэлэн болгодог. <strong>base</strong> R-ын багцыг <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>-аар та өөрөө шууд (татаж авалгүйгээр ) ачааллаж бас болно. [R basics] хэсгээс энэ талаар нэмж үзнэ үү.</p>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span>
  <span class="va">rio</span>,        <span class="co"># дата оруулах  </span>
  <span class="va">here</span>,       <span class="co"># файлын холбоотой замыг тогтоох </span>
  <span class="va">janitor</span>,    <span class="co"># дата, хүснэгт цэвэрлэх</span>
  <span class="va">lubridate</span>,  <span class="co"># огноотой ажиллах</span>
  <span class="va">epikit</span>,     <span class="co"># age_categories() функц</span>
  <span class="va">tidyverse</span>   <span class="co"># дата менежмент ба график зураглал</span>
<span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
<!-- ======================================================= -->
<!-- ======================================================= -->
</div>
<div id="датаг-импортлох" class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> Датаг импортлох<a class="anchor" aria-label="anchor" href="#%D0%B4%D0%B0%D1%82%D0%B0%D0%B3-%D0%B8%D0%BC%D0%BF%D0%BE%D1%80%D1%82%D0%BB%D0%BE%D1%85"><i class="fas fa-link"></i></a>
</h2>
<div id="импорт-хийх" class="section level3 unnumbered">
<h3>Импорт хийх<a class="anchor" aria-label="anchor" href="#%D0%B8%D0%BC%D0%BF%D0%BE%D1%80%D1%82-%D1%85%D0%B8%D0%B9%D1%85"><i class="fas fa-link"></i></a>
</h3>
<p>Түүхий дата агуулсан Excel файлыг <strong>rio</strong>-ын <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> функцээр импортлоно. <strong>rio</strong> нь файлын олон янзын төрөлтэй ажиллаж чаддагаараа давуу (.xlsx, .csv, .tsv, .rds. гэх мэт). [Import and export] хэсгээс дэлгэрүүлж үзнэ үү.</p>
<p>Энэ бүлгийн дасгалыг хамт хийх бол датаг дараах линкээс татаж авна уу. <a href="https://github.com/epirhandbook/Epi_R_handbook/raw/master/data/case_linelists/linelist_raw.xlsx" class="download-button">линк дээр дарж “түүхий” linelist -ыг татаж ав</a> ( .xlsx файл).</p>
<p>Хэмжээ том датасетийн хувьд импортлоход хугацаа их шаарддаг учраас импорт хийх коммандаа pipe залгааснаас салангид уншуулж, түүхий датагаа тусдаа файлаар хадгалах нь тохиромжтой. Ингэснээр мөн анхны болон цэвэрлэгдсэн дата хувилбаруудыг харьцуулахад хялбар болдог.</p>
<p>Дорх жишээнд бид Excel-ийн түүхий файлыг импортлоод <code>linelist_raw</code> гэсэн хүснэгт болгож хадгаллаа.Энэхүү файлыг та өөрийн ажлын хавтас эсвэл R төслийн үндсэн хавтастаа байрлуулна гэж тооцсон учир файлын замыг бичихэд дэд хавтсыг оруулсангүй.</p>
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"linelist_raw.xlsx"</span><span class="op">)</span></code></pre></div>
<p>Үүссэн хүснэгтийн эхний 50 мөрийг дараахаас харж болно. Тэмдэглэл: <strong>base</strong> R”-ын <code>head(n)</code> функцээр эхний <code>n</code> мөрийг R console дээр шууд харж болдог.</p>
<div id="htmlwidget-30d730dd5cdcb4ecca63" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-30d730dd5cdcb4ecca63">{"x":{"filter":"none","vertical":false,"data":[["5fe599","8689b7","11f8ea","b8812a","893f25","be99c8","07e3e8","369449","f393b4","1389ca","2978ac","57a565","fc15ef","2eaa9a","bbfa93","c97dd9","f50e8a","3a7673","7f5a01","ddddee","99e8fa","567136","9371a9","bc2adf","403057","8bd1e8","f327be","42e1a9","90e5fe","959170","8ebf6e","e56412","6d788e","a47529","67be4e","da8ecb","148f18","2cb9a5","f5c142","70a9fe","3ad520","062638","c76676","baacc1","497372","23e499","38cc4a","3789ee","c71dcd","6b70f0"],[4,4,2,3,3,3,4,4,4,4,4,4,6,5,6,9,10,8,7,6,7,6,8,6,10,8,6,12,5,8,7,9,11,5,8,5,6,11,7,9,7,8,9,12,13,9,8,10,8,7],["2014-05-08T00:00:00Z",null,null,"2014-05-04T00:00:00Z","2014-05-18T00:00:00Z","2014-05-03T00:00:00Z","2014-05-22T00:00:00Z","2014-05-28T00:00:00Z",null,null,"2014-05-30T00:00:00Z","2014-05-28T00:00:00Z","2014-06-14T00:00:00Z","2014-06-07T00:00:00Z","2014-06-09T00:00:00Z",null,null,null,"2014-06-23T00:00:00Z","2014-06-18T00:00:00Z","2014-06-24T00:00:00Z",null,null,"2014-07-03T00:00:00Z",null,"2014-07-10T00:00:00Z","2014-06-14T00:00:00Z",null,"2014-06-18T00:00:00Z","2014-06-29T00:00:00Z","2014-07-02T00:00:00Z","2014-07-12T00:00:00Z","2014-07-12T00:00:00Z","2014-06-13T00:00:00Z","2014-07-15T00:00:00Z","2014-06-20T00:00:00Z",null,null,"2014-07-20T00:00:00Z",null,"2014-07-12T00:00:00Z","2014-07-19T00:00:00Z","2014-07-18T00:00:00Z","2014-07-18T00:00:00Z","2014-07-27T00:00:00Z",null,"2014-07-19T00:00:00Z","2014-07-26T00:00:00Z","2014-07-24T00:00:00Z",null],["2014-05-13","2014-05-13","2014-05-16","2014-05-18","2014-05-21","2014-05-22","2014-05-27","2014-06-02","2014-06-05","2014-06-05","2014-06-06","2014-06-13","2014-06-16","2014-06-17","2014-06-18","2014-06-19","2014-06-22","2014-06-23","2014-06-25","2014-06-26","2014-06-28","2014-07-02","2014-07-08","2014-07-09","2014-07-09","2014-07-10","2014-07-12","2014-07-12","2014-07-13","2014-07-13","2014-07-14","2014-07-15","2014-07-16","2014-07-17","2014-07-17","2014-07-18","2014-07-19","2014-07-22","2014-07-22","2014-07-24","2014-07-24","2014-07-25","2014-07-25","2014-07-27","2014-07-29","2014-07-30",null,"2014-08-01","2014-08-02","2014-08-03"],["2014-05-15T00:00:00Z","2014-05-14T00:00:00Z","2014-05-18T00:00:00Z","2014-05-20T00:00:00Z","2014-05-22T00:00:00Z","2014-05-23T00:00:00Z","2014-05-29T00:00:00Z","2014-06-03T00:00:00Z","2014-06-06T00:00:00Z","2014-06-07T00:00:00Z","2014-06-08T00:00:00Z","2014-06-15T00:00:00Z","2014-06-17T00:00:00Z","2014-06-17T00:00:00Z","2014-06-20T00:00:00Z","2014-06-19T00:00:00Z","2014-06-23T00:00:00Z","2014-06-24T00:00:00Z","2014-06-27T00:00:00Z","2014-06-28T00:00:00Z","2014-06-29T00:00:00Z","2014-07-03T00:00:00Z","2014-07-09T00:00:00Z","2014-07-09T00:00:00Z","2014-07-11T00:00:00Z","2014-07-11T00:00:00Z","2014-07-13T00:00:00Z","2014-07-14T00:00:00Z","2014-07-14T00:00:00Z","2014-07-13T00:00:00Z","2014-07-14T00:00:00Z","2014-07-17T00:00:00Z","2014-07-17T00:00:00Z","2014-07-18T00:00:00Z","2014-07-19T00:00:00Z","2014-07-20T00:00:00Z","2014-07-20T00:00:00Z","2014-07-22T00:00:00Z","2014-07-24T00:00:00Z","2014-07-26T00:00:00Z","2014-07-24T00:00:00Z","2014-07-27T00:00:00Z","2014-07-25T00:00:00Z","2014-07-27T00:00:00Z","2014-07-31T00:00:00Z","2014-08-01T00:00:00Z","2014-08-03T00:00:00Z","2014-08-02T00:00:00Z","2014-08-02T00:00:00Z","2014-08-04T00:00:00Z"],[null,"2014-05-18T00:00:00Z","2014-05-30T00:00:00Z",null,"2014-05-29T00:00:00Z","2014-05-24T00:00:00Z","2014-06-01T00:00:00Z","2014-06-07T00:00:00Z","2014-06-18T00:00:00Z","2014-06-09T00:00:00Z","2014-06-15T00:00:00Z",null,"2014-07-09T00:00:00Z",null,"2014-06-30T00:00:00Z","2014-07-11T00:00:00Z","2014-07-01T00:00:00Z","2014-06-25T00:00:00Z","2014-07-06T00:00:00Z","2014-07-02T00:00:00Z","2014-07-09T00:00:00Z","2014-07-07T00:00:00Z","2014-07-20T00:00:00Z",null,"2014-07-22T00:00:00Z","2014-07-16T00:00:00Z","2014-07-14T00:00:00Z","2014-07-20T00:00:00Z","2014-07-16T00:00:00Z","2014-07-19T00:00:00Z","2014-07-27T00:00:00Z","2014-07-19T00:00:00Z",null,"2014-07-26T00:00:00Z","2014-08-14T00:00:00Z","2014-08-01T00:00:00Z","2014-07-23T00:00:00Z","2014-08-28T00:00:00Z","2014-07-28T00:00:00Z","2014-07-19T00:00:00Z",null,"2014-08-03T00:00:00Z",null,null,null,"2014-08-06T00:00:00Z","2014-08-21T00:00:00Z","2014-09-13T00:00:00Z","2014-08-04T00:00:00Z",null],[null,"Recover","Recover",null,"Recover","Recover","Recover","Death","Recover","Death","Death","Death","Recover","Recover",null,"Recover",null,null,"Death","Death","Recover",null,null,null,"Death",null,"Death","Death",null,"Death","Recover","Death","Recover","Death","Recover",null,"Death","Recover","Recover","Death",null,null,"Death","Death","Death","Death","Recover",null,"Death","Death"],["m","f","m","f","m","f","f","f","m","f","m","m","m","f","f","m","f","f","f","f","m","m","f","m","f","m","m","f","m","f","f","f","m","m","f","m","f","f","f","m","f","m","f","m","m","f","m","f","m","m"],["Other",null,"St. Mark's Maternity Hospital (SMMH)","Port Hospital","Military Hospital","Port Hospital",null,null,null,null,"Port Hospital","Military Hospital",null,null,"Other","Port Hospital","Port Hospital","Port Hospital",null,"Other","Port Hospital","Port Hospital","St. Mark's Maternity Hospital (SMMH)",null,"Other",null,"St. Marks Maternity Hopital (SMMH)","Military Hospital","Port Hospital","Central Hospital","Military Hospital","Central Hospital",null,"Military Hospital","Other",null,null,"Port Hospital","Port Hospital","Port Hospital",null,"Central Hospital","Military Hospital","Other","Other","Other",null,"St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)",null],[-13.2157351064963,-13.2152339775486,-13.212910703914,-13.2363711169728,-13.2228638912441,-13.222625321098,-13.2331547837254,-13.2320975453153,-13.2225511595637,-13.2572163655863,-13.2206286746001,-13.253989309478,-13.2385127873491,-13.209391925612,-13.2157278814899,-13.2243437095992,-13.2336087079551,-13.21422143145,-13.2339681355349,-13.2535640411465,-13.2250089377786,-13.2160657166043,-13.2680671272333,-13.2266742923612,-13.2160179088168,-13.2482584611565,-13.2156319199566,-13.2142410663192,-13.2614879104088,-13.2452992638476,-13.2630592726116,-13.2343341712241,-13.2199077448676,-13.2227293309912,-13.2343062806506,-13.218781651651,-13.2483677722899,-13.2097478342339,-13.2680867723786,-13.2587535457526,-13.262635786914,-13.2697246824573,-13.2209026809759,-13.2330734719715,-13.2680923666905,-13.2547212675054,-13.2573683214693,-13.2137356012883,-13.2175973322257,-13.2486407324245],[8.46897295100924,8.45171855856465,8.46481700596819,8.4754761613651,8.46082377490923,8.46183062600728,8.46272931462646,8.46144367534271,8.46191259217774,8.47292327643506,8.48401630165138,8.45837125340844,8.47761705512509,8.47570184950483,8.47779946878972,8.47145134147474,8.47804840685363,8.48528034195779,8.46957530395867,8.45957352078114,8.47404889511544,8.48802917129884,8.473437335922,8.48408263734462,8.46242233645879,8.47026822126572,8.46398447480533,8.4641347894342,8.45623094629607,8.48334624336805,8.47493999153642,8.47832062438022,8.4693933891765,8.48480589906514,8.47121232619015,8.48438437371817,8.48466158574339,8.47714159984428,8.46238127010609,8.45568597813113,8.4632880274758,8.47940722413856,8.46353857052336,8.46178968158864,8.47508713872833,8.45825808128071,8.4532568143863,8.4732571907655,8.47911586641933,8.48480340615605],["f547d6",null,null,"f90f5f","11f8ea","aec8ec","893f25","133ee7",null,null,"996f3a","133ee7","37a6f6","9f6884","4802b1",null,null,null,"a75c7f","8e104d","ab634e",null,null,"b799eb",null,"5d9e4d","a15e13",null,"ea3740","beb26e","567136","894024","36e2e7","a2086d","7baf73","eb2277",null,null,"d6584f",null,"312ecf","52ea64","cfd79c","d145b7","174288",null,"53608c","3b096b","f5c142",null],["other",null,null,"other","other","other","other","other",null,null,"other","other","other","other","other",null,null,null,"other","other","other",null,null,"other",null,"other","other",null,"other","funeral","other","funeral","other","other","other","funeral",null,null,"other",null,"other","other","other","other","other",null,"funeral","other","other",null],["2","3","56","18","3","16","16","0","61","27","12","42","19","7","7","13","35","17","11","11","19","54","14","28","6","3","31","6","67","14","10","21","20","45","1","12","3","15","20","36","7","13","14","3","10","1","0","20","26","14"],["years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],[27,25,91,41,36,56,47,0,86,69,67,84,68,44,34,66,78,47,53,47,71,86,53,69,38,46,68,37,100,56,50,57,65,72,29,69,37,48,54,71,47,61,47,35,53,16,13,59,69,67],[48,59,238,135,71,116,87,11,226,174,112,186,174,90,91,152,214,137,117,131,150,241,131,161,80,69,188,66,233,142,110,182,164,214,26,157,39,154,133,168,100,125,123,67,134,31,36,125,183,169],[22,22,21,23,23,21,21,22,22,22,22,22,22,21,23,22,23,21,22,23,21,23,21,24,23,22,24,23,20,24,24,20,24,21,22,21,23,22,23,23,23,22,23,22,22,22,23,22,22,22],["no",null,null,"no","no","no",null,"no","no","no","no","no","no","no","no","no","no","no",null,"no","no","no","no","no",null,"no","no","no",null,null,"no","no",null,"no","no",null,null,"no","no",null,"no","no",null,"no","no","no","no","no","no",null],["no",null,null,"no","no","no",null,"no","no","no","no","no","no","no","no","no","yes","no",null,"no","no","no","yes","no",null,"no","no","yes",null,null,"no","no",null,"no","no",null,null,"no","no",null,"no","no",null,"no","yes","no","no","no","no",null],["yes",null,null,"no","yes","yes",null,"yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes",null,"yes","yes","yes","yes","yes",null,"yes","yes","yes",null,null,"yes","yes",null,"yes","yes",null,null,"yes","yes",null,"yes","yes",null,"yes","yes","yes","yes","yes","no",null],["no",null,null,"no","no","no",null,"no","no","no","no","no","no","no","no","yes","no","no",null,"no","no","no","no","no",null,"no","no","no",null,null,"no","no",null,"no","no",null,null,"yes","yes",null,"no","no",null,"no","no","no","no","no","no",null],["yes",null,null,"no","yes","yes",null,"yes","yes","no","yes","no","no","no","yes","no","no","no",null,"no","yes","no","no","no",null,"no","no","no",null,null,"no","yes",null,"yes","yes",null,null,"yes","yes",null,"yes","yes",null,"yes","yes","no","yes","yes","yes",null],[36.8,36.9,36.9,36.8,36.9,37.6,37.3,37,36.4,35.9,36.5,36.9,36.5,37.1,36.5,37.3,37,38,38,36,37,36.7,36.9,36.5,37,36.5,37.6,36.6,36.6,36.2,36.4,37.1,37.5,37.5,37.4,36.9,36.4,37.3,37,37.8,36.5,37.5,36.7,37,37.3,36.6,36.5,36.6,37.6,36.8],[null,"09:36","16:48","11:22","12:60","14:13","14:33","09:25","11:16","10:55","16:03","11:14","12:42","11:06","09:10","08:45",null,"15:41","13:34","18:58","12:43","16:33","14:29","07:18","08:11","16:32","16:17","07:32","17:45",null,"13:24","14:43","02:33","11:36","17:28","16:27",null,"20:49",null,"11:38","14:25","13:42","21:22","13:33","19:06","17:14","20:09",null,"10:23","09:09"],["a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a"],["b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b","b"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>generation<\/th>\n      <th>infection date<\/th>\n      <th>date onset<\/th>\n      <th>hosp date<\/th>\n      <th>date_of_outcome<\/th>\n      <th>outcome<\/th>\n      <th>gender<\/th>\n      <th>hospital<\/th>\n      <th>lon<\/th>\n      <th>lat<\/th>\n      <th>infector<\/th>\n      <th>source<\/th>\n      <th>age<\/th>\n      <th>age_unit<\/th>\n      <th>row_num<\/th>\n      <th>wt_kg<\/th>\n      <th>ht_cm<\/th>\n      <th>ct_blood<\/th>\n      <th>fever<\/th>\n      <th>chills<\/th>\n      <th>cough<\/th>\n      <th>aches<\/th>\n      <th>vomit<\/th>\n      <th>temp<\/th>\n      <th>time_admission<\/th>\n      <th>merged_header<\/th>\n      <th>...28<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,9,10,15,16,17,18,24]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="тоймлон-үзэх" class="section level3 unnumbered">
<h3>Тоймлон үзэх<a class="anchor" aria-label="anchor" href="#%D1%82%D0%BE%D0%B9%D0%BC%D0%BB%D0%BE%D0%BD-%D2%AF%D0%B7%D1%8D%D1%85"><i class="fas fa-link"></i></a>
</h3>
<p>Дата хүснэгтийн талаарх ерөнхий тойм мэдээг авахдаа <strong>skimr</strong> -ын <code>skim()</code> функцыг хэрэглэж болно. ([Descriptive tables] хэсгээс нэмж харна уу). Баганууд numeric (тоон), character (үсгэн) зэргээр төрөл төрлөөрөө тоймлогддог. Тэмдэглэл: “POSIXct” гэдэг нь нэг төрлийн боловсруулагдаагүй огноо датаны төрөл ([Working with dates] хэсгээс харна уу).</p>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">skimr</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/skimr/reference/skim.html">skim</a></span><span class="op">(</span><span class="va">linelist_raw</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table style="width: auto;" class="table table-condensed">
<caption>
<span id="tab:unnamed-chunk-153">Table 8.1: </span>Data summary
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:left;">
linelist_raw
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of rows
</td>
<td style="text-align:left;">
6611
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of columns
</td>
<td style="text-align:left;">
28
</td>
</tr>
<tr>
<td style="text-align:left;">
_______________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Column type frequency:
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
17
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
POSIXct
</td>
<td style="text-align:left;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
________________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Group variables
</td>
<td style="text-align:left;">
None
</td>
</tr>
</tbody>
</table></div>
<p><strong>Variable type: character</strong></p>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
empty
</th>
<th style="text-align:right;">
n_unique
</th>
<th style="text-align:right;">
whitespace
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
case_id
</td>
<td style="text-align:right;">
137
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5888
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
date onset
</td>
<td style="text-align:right;">
293
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
580
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
outcome
</td>
<td style="text-align:right;">
1500
</td>
<td style="text-align:right;">
0.77
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
gender
</td>
<td style="text-align:right;">
324
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
hospital
</td>
<td style="text-align:right;">
1512
</td>
<td style="text-align:right;">
0.77
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
infector
</td>
<td style="text-align:right;">
2323
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2697
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
source
</td>
<td style="text-align:right;">
2323
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
107
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
age_unit
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
fever
</td>
<td style="text-align:right;">
258
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
chills
</td>
<td style="text-align:right;">
258
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
cough
</td>
<td style="text-align:right;">
258
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
aches
</td>
<td style="text-align:right;">
258
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
vomit
</td>
<td style="text-align:right;">
258
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
time_admission
</td>
<td style="text-align:right;">
844
</td>
<td style="text-align:right;">
0.87
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1091
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
merged_header
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
…28
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table></div>
<p><strong>Variable type: numeric</strong></p>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
p0
</th>
<th style="text-align:right;">
p25
</th>
<th style="text-align:right;">
p50
</th>
<th style="text-align:right;">
p75
</th>
<th style="text-align:right;">
p100
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
generation
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
16.60
</td>
<td style="text-align:right;">
5.71
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
13.00
</td>
<td style="text-align:right;">
16.00
</td>
<td style="text-align:right;">
20.00
</td>
<td style="text-align:right;">
37.00
</td>
</tr>
<tr>
<td style="text-align:left;">
lon
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
-13.23
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-13.27
</td>
<td style="text-align:right;">
-13.25
</td>
<td style="text-align:right;">
-13.23
</td>
<td style="text-align:right;">
-13.22
</td>
<td style="text-align:right;">
-13.21
</td>
</tr>
<tr>
<td style="text-align:left;">
lat
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
8.47
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
8.45
</td>
<td style="text-align:right;">
8.46
</td>
<td style="text-align:right;">
8.47
</td>
<td style="text-align:right;">
8.48
</td>
<td style="text-align:right;">
8.49
</td>
</tr>
<tr>
<td style="text-align:left;">
row_num
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
3240.91
</td>
<td style="text-align:right;">
1857.83
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1647.50
</td>
<td style="text-align:right;">
3241.00
</td>
<td style="text-align:right;">
4836.50
</td>
<td style="text-align:right;">
6481.00
</td>
</tr>
<tr>
<td style="text-align:left;">
wt_kg
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
52.69
</td>
<td style="text-align:right;">
18.59
</td>
<td style="text-align:right;">
-11.00
</td>
<td style="text-align:right;">
41.00
</td>
<td style="text-align:right;">
54.00
</td>
<td style="text-align:right;">
66.00
</td>
<td style="text-align:right;">
111.00
</td>
</tr>
<tr>
<td style="text-align:left;">
ht_cm
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
125.25
</td>
<td style="text-align:right;">
49.57
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:right;">
91.00
</td>
<td style="text-align:right;">
130.00
</td>
<td style="text-align:right;">
159.00
</td>
<td style="text-align:right;">
295.00
</td>
</tr>
<tr>
<td style="text-align:left;">
ct_blood
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
21.26
</td>
<td style="text-align:right;">
1.67
</td>
<td style="text-align:right;">
16.00
</td>
<td style="text-align:right;">
20.00
</td>
<td style="text-align:right;">
22.00
</td>
<td style="text-align:right;">
22.00
</td>
<td style="text-align:right;">
26.00
</td>
</tr>
<tr>
<td style="text-align:left;">
temp
</td>
<td style="text-align:right;">
158
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
38.60
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
35.20
</td>
<td style="text-align:right;">
38.30
</td>
<td style="text-align:right;">
38.80
</td>
<td style="text-align:right;">
39.20
</td>
<td style="text-align:right;">
40.80
</td>
</tr>
</tbody>
</table></div>
<p><strong>Variable type: POSIXct</strong></p>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:left;">
min
</th>
<th style="text-align:left;">
max
</th>
<th style="text-align:left;">
median
</th>
<th style="text-align:right;">
n_unique
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
infection date
</td>
<td style="text-align:right;">
2322
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:left;">
2012-04-09
</td>
<td style="text-align:left;">
2015-04-27
</td>
<td style="text-align:left;">
2014-10-04
</td>
<td style="text-align:right;">
538
</td>
</tr>
<tr>
<td style="text-align:left;">
hosp date
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
2012-04-20
</td>
<td style="text-align:left;">
2015-04-30
</td>
<td style="text-align:left;">
2014-10-15
</td>
<td style="text-align:right;">
570
</td>
</tr>
<tr>
<td style="text-align:left;">
date_of_outcome
</td>
<td style="text-align:right;">
1068
</td>
<td style="text-align:right;">
0.84
</td>
<td style="text-align:left;">
2012-05-14
</td>
<td style="text-align:left;">
2015-06-04
</td>
<td style="text-align:left;">
2014-10-26
</td>
<td style="text-align:right;">
575
</td>
</tr>
</tbody>
</table></div>
<!-- ======================================================= --><!-- ======================================================= --><!-- ======================================================= -->
</div>
</div>
<div id="баганын-нэрс" class="section level2" number="8.4">
<h2>
<span class="header-section-number">8.4</span> Баганын нэрс<a class="anchor" aria-label="anchor" href="#%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D1%8B%D0%BD-%D0%BD%D1%8D%D1%80%D1%81"><i class="fas fa-link"></i></a>
</h2>
<p>Хүснэгт импортлоход хамгийн эхний, толгой мөрийг баганын <em>нэр</em> гэж R уншдаг. Синтакст мөн энэ нэр хэрэгдэгднэ.</p>
<p>SAS, STATA зэрэг бусад статистик программд баганын толгой дох товчилсон нэрнээс гадна <em>“labels” (дэлгэрэнгүй нэр)</em> гэж байдаг. R дээр багана тус бүрт label өгөх боломжтой ч өргөн хэрэглэдэггүй. График дээр баганын нэрийг хэвлэлд үзэмжтэй харагдахуйцаар болгоход график хэвлэх комманддаа дэлгэцийн тохируулгад нь зааж өгч болно (тэнхлэгийн (axis) нэрс, ялгах тэмдгийн (legends), нэрс, багана толгой гэх мэт. <a href="https://epirhandbook.com/ggplot-tips.html#ggplot_tips_scales">scales section of the ggplot tips page</a> болон <a href="https://epirhandbook.com/tables-for-presentation.html#tables-for-presentation">Tables for presentation</a> хуудсаас нэмж уншна уу). Баганад label өгөх талаар <a href="https://cran.r-project.org/web/packages/expss/vignettes/labels-support.html">here</a> болон <a href="https://cran.r-project.org/web/packages/labelled/vignettes/intro_labelled.html">here</a> линкүүдээс үзэж болно.</p>
<p>Баганын нэрс R дээр байнга хэрэглэгдэх тул “цэвэр” синтакстай байх нь чухал. Дараах аргаар нэрлэвэл тохиромжтой:</p>
<ul>
<li>Богино</li>
<li>Зай авахгүй, доогуур зураас _ хэрэглэх</li>
<li>Өвөрмөц тэмдэглэгээ оруулахгүй (&amp;, #, &lt;, &gt;, …)</li>
<li>Төстэй нэрлэх ( жишээ нь бүх огноотой баганыг <strong>date_</strong>onset, <strong>date_</strong>report, <strong>date_</strong>death гэж нэрлэх)</li>
</ul>
<p><strong>base</strong> R –ын <code><a href="https://rdrr.io/r/base/names.html">names()</a></code> функцээр <code>linelist_raw</code>–дах баганын нэрсийг хэвлэж харахад:</p>
<ul>
<li>Зарим нэрс зай авсан (жишээ нь <code>infection date</code>)<br>
</li>
<li>Огноотой баганууд жигд бус нэрлэгдсэн (жишээ нь <code>date onset</code> багана <code>infection date</code> ээс өөр)<br>
</li>
<li>.xlsx файл дээр нь сүүлийн хоёр баганын толгой нэгтгэгдсэн (merged) байсан нь харагдаж байна. Учир нь нэгтгэгдсэн баганын эхний баганын нэр R -т “merged_header” гэж импортлогдоод хоёр дах баганын нэр “…28” гэж импортлогдсон байна ( хоосон 28 -р багана байсан).</li>
</ul>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">linelist_raw</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "case_id"         "generation"      "infection date"  "date onset"     
##  [5] "hosp date"       "date_of_outcome" "outcome"         "gender"         
##  [9] "hospital"        "lon"             "lat"             "infector"       
## [13] "source"          "age"             "age_unit"        "row_num"        
## [17] "wt_kg"           "ht_cm"           "ct_blood"        "fever"          
## [21] "chills"          "cough"           "aches"           "vomit"          
## [25] "temp"            "time_admission"  "merged_header"   "...28"</code></pre>
<p><span style="color: black;"><strong><em>ТЭМДЭГЛЭЛ:</em></strong> зай авсан баганы нэрийг хойшоо харсан дан хашилтад хийдэг. Жишээ нь: linelist$<code>` '\x60infection date\x60'`</code>. Ингэхдээ компьютерийн гаран дээрх хойшоо харсан дан хашилт (`) бичгийн дан хашилтаас ( ’ ) өөр гэдгйиг анхаарна уу.</span></p>
<div id="автомат-цэвэрлэгээ" class="section level3 unnumbered">
<h3>Автомат цэвэрлэгээ<a class="anchor" aria-label="anchor" href="#%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82-%D1%86%D1%8D%D0%B2%D1%8D%D1%80%D0%BB%D1%8D%D0%B3%D1%8D%D1%8D"><i class="fas fa-link"></i></a>
</h3>
<p><strong>janitor</strong> багцын <code>clean_names()</code> функц баганын нэрсийн өвөрмөц байдлыг алдуулалгүйгээр жигдрүүлдэг. Ингэхдээ:</p>
<ul>
<li>Бүх баганыг зөвхөн доогуур зураас, тоо, үсгээс бүрдсэн нэртэй болгож хувиргана.<br>
</li>
<li>Өргөгдсөн эгшгүүд ASCII хэлрүү галиглагдна (Герман хэлний ö –г “o”-руу, Испани хэлний “enye” -г “n” болгох гэх мэт)<br>
</li>
<li>Үсгийн том жижгийг <code>case =</code> аргументэд зааж өгч болно (“snake” хэлбэр default сонголт, “sentence”, “title”, “small_camel” гэх мэт өөр сонголтууд буй)<br>
</li>
<li>Нэр өөрчлөх, орлуулахдаа <code>replace =</code> аргументийг ашиглаж болно (ж: <code>replace = c(onset = "date_of_onset")</code>)<br>
</li>
<li>Онлайн <a href="https://cran.r-project.org/web/packages/janitor/vignettes/janitor.html#cleaning">vignette</a> –г эндээс харж болно</li>
</ul>
<p>Цэвэрлэх процесс <code>clean_names()</code> -эд түүхий linelist –ийг оруулснаар эхэлнэ:</p>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># түүхий датагаа clean_names() –д холбоод, үр дүнг нь "linelist" -доноо</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># баганын шинэ нэрс</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "case_id"         "generation"      "infection_date"  "date_onset"     
##  [5] "hosp_date"       "date_of_outcome" "outcome"         "gender"         
##  [9] "hospital"        "lon"             "lat"             "infector"       
## [13] "source"          "age"             "age_unit"        "row_num"        
## [17] "wt_kg"           "ht_cm"           "ct_blood"        "fever"          
## [21] "chills"          "cough"           "aches"           "vomit"          
## [25] "temp"            "time_admission"  "merged_header"   "x28"</code></pre>
<p><span style="color: black;"><strong><em>ТЭМДЭГЛЭЛ:</em></strong> сүүлийн баганын нэр “…28” байснаа “x28” болж хувирсан”.</span></p>
</div>
<div id="баганын-нэрийг-гараар-цэвэрлэх" class="section level3 unnumbered">
<h3>Баганын нэрийг гараар цэвэрлэх<a class="anchor" aria-label="anchor" href="#%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D1%8B%D0%BD-%D0%BD%D1%8D%D1%80%D0%B8%D0%B9%D0%B3-%D0%B3%D0%B0%D1%80%D0%B0%D0%B0%D1%80-%D1%86%D1%8D%D0%B2%D1%8D%D1%80%D0%BB%D1%8D%D1%85"><i class="fas fa-link"></i></a>
</h3>
<p>Баганын нэрсийг дээрх байдлаар жигдрүүлсний дараа гараар цэвэрлэх хэрэг заавал гардаг. Дорх кодонд <strong>dplyr</strong> –ын <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code> -ыг pipe холбоост залгаж зарим баганын нэрийг янзалсан. <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code> функц <code>NEW = OLD</code>– гэсэн дарааллаар аргументээ авдаг. Эхлээд шинэ, дараа нь хуучин нэрийг бичнэ.</p>
<p>Дараах цэвэрлэгээний процесст нэр өгөх комманд нэмэгдэж орсныг ажиглаарай. Уншихад амар болгож зарим газар зай авсан.</p>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ЦЭВЭРЛЭХ 'PIPE' ХОЛБООС (түүхий датаг үе шаттайгаар дамжуулан цэвэрлэдэг холбоос) </span>
<span class="co">##################################################################################</span>

<span class="co"># Цэвэрлэх холбоосыг эхлэх</span>
<span class="co">###########################</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    
    <span class="co"># баганын нэрсийг жигдрүүлэх</span>
    <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    
    <span class="co"># зарим баганын нэрийг гараар өөрчил</span>
           <span class="co"># ШИНЭ нэр             # ХУУЧИН нэр</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>date_infection       <span class="op">=</span> <span class="va">infection_date</span>,
           date_hospitalisation <span class="op">=</span> <span class="va">hosp_date</span>,
           date_outcome         <span class="op">=</span> <span class="va">date_of_outcome</span><span class="op">)</span></code></pre></div>
<p>Баганын нэрс өөрчлөгдсөн байна:</p>
<pre><code>##  [1] "case_id"              "generation"           "date_infection"      
##  [4] "date_onset"           "date_hospitalisation" "date_outcome"        
##  [7] "outcome"              "gender"               "hospital"            
## [10] "lon"                  "lat"                  "infector"            
## [13] "source"               "age"                  "age_unit"            
## [16] "row_num"              "wt_kg"                "ht_cm"               
## [19] "ct_blood"             "fever"                "chills"              
## [22] "cough"                "aches"                "vomit"               
## [25] "temp"                 "time_admission"       "merged_header"       
## [28] "x28"</code></pre>
<div id="баганын-байрлалаар-нь-нэр-өгөх" class="section level4 unnumbered">
<h4>Баганын байрлалаар нь нэр өгөх<a class="anchor" aria-label="anchor" href="#%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D1%8B%D0%BD-%D0%B1%D0%B0%D0%B9%D1%80%D0%BB%D0%B0%D0%BB%D0%B0%D0%B0%D1%80-%D0%BD%D1%8C-%D0%BD%D1%8D%D1%80-%D3%A9%D0%B3%D3%A9%D1%85"><i class="fas fa-link"></i></a>
</h4>
<p>Баганыг нэрийг солихдоо нэрээр нь дуудахаас гадна байрлалыг нь дуудаж болдог. Жишээ нь:</p>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>newNameForFirstColumn  <span class="op">=</span> <span class="fl">1</span>,
       newNameForSecondColumn <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
</div>
<div id="selectболон-summarise-ашиглан-нэр-өгөх" class="section level4 unnumbered">
<h4>
<code>select()</code>болон <code>summarise()</code> ашиглан нэр өгөх<a class="anchor" aria-label="anchor" href="#select%D0%B1%D0%BE%D0%BB%D0%BE%D0%BD-summarise-%D0%B0%D1%88%D0%B8%D0%B3%D0%BB%D0%B0%D0%BD-%D0%BD%D1%8D%D1%80-%D3%A9%D0%B3%D3%A9%D1%85"><i class="fas fa-link"></i></a>
</h4>
<p>Нэр өгөхдөө <strong>dplyr</strong> -ын <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>болон <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> функцуудыг хавсран ашиглавал арай түргэн. <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>–ээр ажиллах гэж буй багануудаа сонгож авахад хэрэглэдэг (дараагийн хэсгүүдэд дахин дурьдна).<code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code>–ын талаар [Grouping data] болон [Descriptive tables] хэсгүүдэд тайлбарласан. Эдгээр функц мөн адил <code>new_name = old_name</code> гэсэн дарааллаар аргументээ авна. Жишээ:</p>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="co"># ШИНЭ нэр              # ХУУЧИН нэр</span>
         date_infection       <span class="op">=</span> <span class="va">`infection date`</span>, <span class="co"># нэрийг солиод, ЗӨВХӨН тухайн багануудыг л авч үлднэ</span>
         date_hospitalisation <span class="op">=</span> <span class="va">`hosp date`</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="бусад" class="section level3 unnumbered">
<h3>Бусад<a class="anchor" aria-label="anchor" href="#%D0%B1%D1%83%D1%81%D0%B0%D0%B4"><i class="fas fa-link"></i></a>
</h3>
<div id="excel-дээрх-баганын-нэр-хоосон-байх" class="section level4 unnumbered">
<h4>Excel дээрх баганын нэр хоосон байх<a class="anchor" aria-label="anchor" href="#excel-%D0%B4%D1%8D%D1%8D%D1%80%D1%85-%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D1%8B%D0%BD-%D0%BD%D1%8D%D1%80-%D1%85%D0%BE%D0%BE%D1%81%D0%BE%D0%BD-%D0%B1%D0%B0%D0%B9%D1%85"><i class="fas fa-link"></i></a>
</h4>
<p>R-т баганын нэргүй дата байх боломжгүй. Тухайлбал Excel –ийн хүснэгт хоосон толгойтой баганатай R –луу импортлогдвол баганын байрлалаас нь хамаарч R автоматаар “…1”, “…2” гэх мэтээр нэр өгдөг (жишээ нь хүснэгтийн 4 дэх багана нэргүй хоосон орж ирсэн бол R тэр баганыг “…4” гэж нэрлэнэ).</p>
<p>Энэ автоматаар өгөгдсөн нэрсийг байрлалынх нь дугаараар (дээр дурьдсан жишээний дагуу), эсвэл оноосон нэрээр нь дуудаж гараар цэвэрлэх боломжтой (<code>linelist_raw$...1</code>.</p>
</div>
<div id="excel-багана-нүднүүд-нэтгэгдсэн-merged-байх" class="section level4 unnumbered">
<h4>Excel багана, нүднүүд нэтгэгдсэн (merged) байх<a class="anchor" aria-label="anchor" href="#excel-%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D0%B0-%D0%BD%D2%AF%D0%B4%D0%BD%D2%AF%D2%AF%D0%B4-%D0%BD%D1%8D%D1%82%D0%B3%D1%8D%D0%B3%D0%B4%D1%81%D1%8D%D0%BD-merged-%D0%B1%D0%B0%D0%B9%D1%85"><i class="fas fa-link"></i></a>
</h4>
<p>Заримдаа Excel –ийн файл ыг хүлээж аваад харахад хүснэгтийн нүднүүд нэтгэгдсэн (merged) байдаг. Нэгтгэгдсэн нүдтэй хүснэгт хүн уншихад амар боловч, “цэгцтэй дата/tidy data” хэлбэрт ороогүй учраас компьютерт сайн уншигддаггүй ([Transition to R] хэсэгт тайлбарласан). R –дээр нэгтгэгдсэн нүднүүд уншигдахгүй.</p>
<p>Дата оруулж буй хүмүүстээ <strong>хүнд уншигддаг дата машинд уншигддаг дата хоёр өөр</strong> гэдгийг сайн ойлгуулах хэрэгтэй. Цэгцтэй датаны <a href="https://r4ds.had.co.nz/tidy-data.html"><strong>tidy data</strong></a> зарчмыг ойлгуулахыг мөн эрмэлз. Болж өгвөл дата оруулах аргачлалд нь өөрчлөлт хийж аль болох цэгцэрсэн, ямар нэг нэгтгэсэн нүдгүй дата хүлээж авахаар зохицуулбал сайн.</p>
<ul>
<li>Хувьсагч тус бүр баганатай байна.<br>
</li>
<li>Ажиглалт тус бүр мөртэй байна<br>
</li>
<li>Утга тус бүр өөрийн нүдэнд байна.</li>
</ul>
<p><strong>rio-ын</strong> <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> -ээр дата импортлож байхад нэтгэгдсэн нүд датанд байх тохиолдолд тухайн нүд задарч, доторх утга эхний нүдэнд бичигдээд дараах нүднүүд нь хоосон орхигддог.</p>
<p>Нэтгэгдсэн нүдний асуудлыг <strong>openxlsx</strong> багцын <code>readWorkbook()</code>функцээр шийдвэрлэх боломжтой. Үүний <code>fillMergedCells =</code> аргументийг TRUE гэж тохируулбал нэтгэгдсэн нүднүүд задрахад доторх утга бүгдэд нь зэрэг хуваарилагдан ордог онцлогтой.</p>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist_raw</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/readWorkbook.html">readWorkbook</a></span><span class="op">(</span><span class="st">"linelist_raw.xlsx"</span>, fillMergedCells <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><span style="color: red;"><strong><em>АЮУЛТАЙ:</em></strong> <code>readWorkbook()</code> -өөр баганын нэрс нэгтгэгдсэн бол давхардсан нэртэй багануудтай болчихдог. Үүнийг гараар цэвэрлэх шаардлагатай. R давхардсан нэртэй ажиллахдаа муу! Давхар нэртэй багануудын нэрийг байршлаар нь дуудаж янзалж болно (баганын нэрийг гараар цэвэрлэх хэсэгт тайлбарласан)</span></p>
<!-- ======================================================= -->
<!-- ======================================================= -->
<!-- ======================================================= -->
</div>
</div>
</div>
<div id="багана-сонгох-болон-эрэмбэлэх" class="section level2" number="8.5">
<h2>
<span class="header-section-number">8.5</span> Багана сонгох болон эрэмбэлэх<a class="anchor" aria-label="anchor" href="#%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D0%B0-%D1%81%D0%BE%D0%BD%D0%B3%D0%BE%D1%85-%D0%B1%D0%BE%D0%BB%D0%BE%D0%BD-%D1%8D%D1%80%D1%8D%D0%BC%D0%B1%D1%8D%D0%BB%D1%8D%D1%85"><i class="fas fa-link"></i></a>
</h2>
<p><strong>dplyr</strong>-ын <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> –д баганыг дуудаж оруулахдаа дэс дарааг нь зааж өгч болно.</p>
<p><span style="color: orange;"><strong><em>БОЛГООМЖЛОЛ:</em></strong> <code>linelist</code>- датаг <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> –ээр янзалсан байгааг жишээ болгож харуулсан боловч хадгалаагүй. Pipe холбоостоо <code>names()-ыг</code> залгаснаар баганы нэр хэрхэн өөрчлөгдсөнийг харж болно.</span></p>
<p>Цэвэрлэх холбоосонд <span style="color: orange;">linelist –ын БҮХ нэрс цэвэрлэгдсэн байх үеийг энд харуулав</span>:</p>
<div class="sourceCode" id="cb197"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "case_id"              "generation"           "date_infection"      
##  [4] "date_onset"           "date_hospitalisation" "date_outcome"        
##  [7] "outcome"              "gender"               "hospital"            
## [10] "lon"                  "lat"                  "infector"            
## [13] "source"               "age"                  "age_unit"            
## [16] "row_num"              "wt_kg"                "ht_cm"               
## [19] "ct_blood"             "fever"                "chills"              
## [22] "cough"                "aches"                "vomit"               
## [25] "temp"                 "time_admission"       "merged_header"       
## [28] "x28"</code></pre>
<div id="баганыг-үлдээх" class="section level3 unnumbered">
<h3>Баганыг үлдээх<a class="anchor" aria-label="anchor" href="#%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D1%8B%D0%B3-%D2%AF%D0%BB%D0%B4%D1%8D%D1%8D%D1%85"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Зөвхөн үлдээх шаардлагатай багануудаа л сонго.</strong></p>
<p>Шаардлагатай багануудаа <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>коммандад хашилтгүйгээр оруул. Таны оруулсан дарааллаар хүснэгтийн багана эрэмбэлэгднэ. Байхгүй баганыг <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>–д бичвэл R алдаа заана. (алдаа заахгүйгээр үргэлжлүүлэх талаар <code><a href="https://tidyselect.r-lib.org/reference/all_of.html">any_of()</a></code>–ын тайлбараас үзнэ үү).</p>
<div class="sourceCode" id="cb199"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># linelist датаг select() коммандаар цэвэрлээд names() -ээр баганын нэрсийг хэвлэсэн</span>
<span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">case_id</span>, <span class="va">date_onset</span>, <span class="va">date_hospitalisation</span>, <span class="va">fever</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># баганын нэрсийг хэвлэж харуулах</span></code></pre></div>
<pre><code>## [1] "case_id"              "date_onset"           "date_hospitalisation"
## [4] "fever"</code></pre>
</div>
<div id="clean_tidyselect" class="section level3 unnumbered">
<h3>“tidyselect” туслах функцууд<a class="anchor" aria-label="anchor" href="#clean_tidyselect"><i class="fas fa-link"></i></a>
</h3>
<p>Багана үлдээх, хасах, хувиргах үйлдэл хийхдээ туслах функц ашиглавал хялбар болдог. Эдгээр туслах функцууд <strong>tidyverse</strong>-ын харьяа <strong>tidyselect</strong> багцыннх ба <strong>dplyr</strong> -ын багана сонгох үйлдэлтэй хавсарч хийгддэг.</p>
<p>Жишээ нь <code><a href="https://tidyselect.r-lib.org/reference/everything.html">everything()</a></code> функцээр “бичигдсэнээс бусад баганыг” сонгодог бөгөөд ингэх нь баганын дарааллыг өөрчлөхөд их хэрэгтэй. Дараах код <code>date_onset</code> болон <code>date_hospitalisation</code> багануудыг хамгийн эхэнд (зүүн талд) авчраад, үлдсэн багануудыг ард нь хэвээр нь үлдээсэн. <code><a href="https://tidyselect.r-lib.org/reference/everything.html">everything()</a></code> комманд хоосон хаалттай байгааг анхаар:</p>
<div class="sourceCode" id="cb201"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># date_onset болон date_hospitalisation -г хамгийн урд зөөж авчрах</span>
<span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">date_onset</span>, <span class="va">date_hospitalisation</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "date_onset"           "date_hospitalisation" "case_id"             
##  [4] "generation"           "date_infection"       "date_outcome"        
##  [7] "outcome"              "gender"               "hospital"            
## [10] "lon"                  "lat"                  "infector"            
## [13] "source"               "age"                  "age_unit"            
## [16] "row_num"              "wt_kg"                "ht_cm"               
## [19] "ct_blood"             "fever"                "chills"              
## [22] "cough"                "aches"                "vomit"               
## [25] "temp"                 "time_admission"       "merged_header"       
## [28] "x28"</code></pre>
<p><strong>dplyr</strong> багцын <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/across.html">across()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> нартай хамтран хэрэглэддэг <strong>tidyselect</strong> -ын функцуудыг дор жагсаав :</p>
<ul>
<li><p><code><a href="https://tidyselect.r-lib.org/reference/everything.html">everything()</a></code> - бичсэнээс бусад бүх багануудыг сонгоно<br></p></li>
<li><p><code><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col()</a></code> - сүүлийн багана<br></p></li>
<li><p><code>where()</code> - аливаа функцыг бүх баганад уншуулж үзээд, TRUE тохиодлуудыг сонгоно<br></p></li>
<li>
<p><code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains()</a></code> - заасан үсэг, тэмдэгт (character) агуулсан баганыг сонгох</p>
<ul>
<li>жишээ: <code>select(contains("time"))</code><br>
</li>
</ul>
</li>
<li>
<p><code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with()</a></code> - баганын нэрийн эхлэл хэсгийг тааруулж сонгох</p>
<ul>
<li>жишээ: <code>select(starts_with("date_"))</code><br>
</li>
</ul>
</li>
<li>
<p><code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">ends_with()</a></code> - баганын нэрийн төгсгөл хэсгийг тааруулж сонгох</p>
<ul>
<li>жишээ: <code>select(ends_with("_post"))</code><br>
</li>
</ul>
</li>
<li>
<p><code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">matches()</a></code> -заасан regular expression (regex) тэй таарсан баганыг сонгох</p>
<ul>
<li>жишээ: <code>select(matches("[pt]al"))</code><br>
</li>
</ul>
</li>
<li><p><code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">num_range()</a></code> - x01, x02, x03 зэрэг тоо, дугаараар тааруулж сонгох<br></p></li>
<li>
<p><code><a href="https://tidyselect.r-lib.org/reference/all_of.html">any_of()</a></code> - аль нэг багана байхгүй тохиолдолд алдаа заахгүйгээр үйлдлийг гүйцэтгэнэ.</p>
<ul>
<li>жишээ: <code>select(any_of(date_onset, date_death, cardiac_arrest))</code>
</li>
</ul>
</li>
</ul>
<p>Үүнээс гадна ердийн операторуудыг ашиглаж болно. Жишээ нь <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>-аар хэд хэдэн баганыг жагсааж, <code>:</code> тэмдэгтээр дарааллаж байрласан багануудыг сонгож болно. <code>!</code> (эсрэг),<code>&amp;</code> (БА), <code>|</code> (ЭСВЭЛ) зэрэг тэмдэгтүүдээр багана сонгохдоо туслуулж болно.</p>
<p>Баганыг логик шалгуураар сонгох бол <code>where()</code>-ийг хэрэглэ. Хэрэв <code>where()</code>-ийг функцын дотор бичихээр бол хаалтыг нь хоосон байлгаж болохгүй. Дорх жишээнд зөвхөн тоон утгатай баганууд сонгохыг харууллаа.</p>
<div class="sourceCode" id="cb203"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Тоон утгатай багануудыг сонгох</span>
<span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "generation" "lon"        "lat"        "row_num"    "wt_kg"     
## [6] "ht_cm"      "ct_blood"   "temp"</code></pre>
<p>Нэрэндээ зөвхөн заасан character -ыг агуулагсан багануудыг сонгох бол <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains()</a></code> -ыг хэрэглэ. Мөн<code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">ends_with()</a></code> болон <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with()</a></code> strings -ын байрлалыг илүү тодорхой зааж өгч болно.</p>
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># тодорхой үг, үсэг нэрэндээ агуулсан багануудыг сонгох</span>
<span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"date"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "date_infection"       "date_onset"           "date_hospitalisation"
## [4] "date_outcome"</code></pre>
<p><code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">matches()</a></code> функц <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains()</a></code> -тай төстэй үүрэгтэй боловч regular expression ашигладгаараа онцлог ([Characters and strings]) хэсгээс нэмж харна уу. Энэ функцыг хэрэглэхдээ олон strings -үүдээ (ЭСВЭЛ) хооронд нь босоо зураасаар тусгаарлаад хашилтанд хийнэ :</p>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># олон strings-ийг эрэг хайж, тааруулах</span>
<span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">matches</a></span><span class="op">(</span><span class="st">"onset|hosp|fev"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>   <span class="co"># note the OR symbol "|"</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "date_onset"           "date_hospitalisation" "hospital"            
## [4] "fever"</code></pre>
<p><span style="color: orange;"><strong><em>БОЛГООМЖИЛ:</em></strong> Датанд байхгүй баганын нэрийг эдгээр функцэд өгвөл код алдаа зааж үйлдэл тэр дороо зогсчихдог. Тиймээс заасан strings байхгүй байх магадлалтай тохиолдолд <code><a href="https://tidyselect.r-lib.org/reference/all_of.html">any_of()</a></code> -ийг хэрэглэвэл тохиромжтой. Ялангуяа багана хасахад их хэрэг болдог.</span></p>
<p>Дор жишээнд бичсэн багануудын нэг нь л датанд буй боловч дорх код алдаа заахгүйгүээр үргэлжилж, цэвэрлэх холбоосын йлдлүүд зогсолтгүйгээр гүйцэтгэлээ хийж байна.</p>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">any_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"date_onset"</span>, <span class="st">"village_origin"</span>, <span class="st">"village_detection"</span>, <span class="st">"village_residence"</span>, <span class="st">"village_travel"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "date_onset"</code></pre>
</div>
<div id="баганыг-хасах" class="section level3 unnumbered">
<h3>Баганыг хасах<a class="anchor" aria-label="anchor" href="#%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D1%8B%D0%B3-%D1%85%D0%B0%D1%81%D0%B0%D1%85"><i class="fas fa-link"></i></a>
</h3>
<p>Хасах (“-”) тэмдэг (ж:<code>select(-outcome)</code>) эсвэл баганын нэрс жагсаасан вектороор (дор жишээнд үзүүлсэн) <strong>аль баганыг хасахаа зааж өг</strong>. Бусад баганууд хэвээр үлдэх болно.</p>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">date_onset</span>, <span class="va">fever</span><span class="op">:</span><span class="va">vomit</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># date_onset багана, fever-ээс vomit хүртэлх багануудыг хасах</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "case_id"              "generation"           "date_infection"      
##  [4] "date_hospitalisation" "date_outcome"         "outcome"             
##  [7] "gender"               "hospital"             "lon"                 
## [10] "lat"                  "infector"             "source"              
## [13] "age"                  "age_unit"             "row_num"             
## [16] "wt_kg"                "ht_cm"                "ct_blood"            
## [19] "temp"                 "time_admission"       "merged_header"       
## [22] "x28"</code></pre>
<p><strong>base</strong> R -ын синтакс <code>NULL</code>-ыг ашиглаж баганыг хасч бас болно. Жишээ нь:</p>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span><span class="op">$</span><span class="va">date_onset</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>   <span class="co"># base R -ын синтаксаар date_onset баганыг хасах</span></code></pre></div>
</div>
<div id="дангаараа-үйлдэх-коммандууд" class="section level3 unnumbered">
<h3>Дангаараа үйлдэх коммандууд<a class="anchor" aria-label="anchor" href="#%D0%B4%D0%B0%D0%BD%D0%B3%D0%B0%D0%B0%D1%80%D0%B0%D0%B0-%D2%AF%D0%B9%D0%BB%D0%B4%D1%8D%D1%85-%D0%BA%D0%BE%D0%BC%D0%BC%D0%B0%D0%BD%D0%B4%D1%83%D1%83%D0%B4"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> -ийг дангаар нь хэрэглэж болдог (pipe холбоостой залгаа биш). Энэ тохиолдолд эхний аргумент нь янзлах гэж буй хүснэгтийн нэр байна.</p>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#  id болон насыг харуулсан шинэ linelist үүсгэх</span>
<span class="va">linelist_age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">linelist</span>, <span class="va">case_id</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"age"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># үүсгэсэн linelist-ийн баганын нэрсийг харуул</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">linelist_age</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "case_id"  "age"      "age_unit"</code></pre>
<div id="pipe-холбоосонд-нэмж-залгах" class="section level4 unnumbered">
<h4>Pipe холбоосонд нэмж залгах<a class="anchor" aria-label="anchor" href="#pipe-%D1%85%D0%BE%D0%BB%D0%B1%D0%BE%D0%BE%D1%81%D0%BE%D0%BD%D0%B4-%D0%BD%D1%8D%D0%BC%D0%B6-%D0%B7%D0%B0%D0%BB%D0%B3%D0%B0%D1%85"><i class="fas fa-link"></i></a>
</h4>
<p><code>linelist_raw</code>-хүснэгт дэх дараах баганууд бидэнд шаардлагагүй: <code>row_num</code>, <code>merged_header</code>, <code>x28</code>. Эдгээрийг хасахдаа <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> коммандыг pipe холбоосонд залгаж хасдаг:</p>
<div class="sourceCode" id="cb216"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ЦЭВЭРЛЭХ 'PIPE' ХОЛБООС (түүхий датаг үе шаттайгаар дамжуулан цэвэрлэдэг холбоос)</span>
<span class="co">##################################################################################</span>

<span class="co"># Цэвэрлэх холбоосыг эхлэх</span>
<span class="co">###########################</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    
    <span class="co"># баганын нэрсийг жигдрүүлэх</span>
    <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    
    <span class="co"># зарим баганын нэрийг гараар өөрчил</span>
           <span class="co"># ШИНЭ нэр             # ХУУЧИН нэр</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>date_infection       <span class="op">=</span> <span class="va">infection_date</span>,
           date_hospitalisation <span class="op">=</span> <span class="va">hosp_date</span>,
           date_outcome         <span class="op">=</span> <span class="va">date_of_outcome</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    
    <span class="co"># ЭНЭ ХҮРТЭЛХ ҮЙЛДЭЛ ӨМНӨХ ХЭСЭГТТЭЙ АДИЛ</span>
    <span class="co">#####################################################</span>

    <span class="co"># баганыг хас</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">row_num</span>, <span class="va">merged_header</span>, <span class="va">x28</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
<!-- ======================================================= -->
<!-- ======================================================= -->
</div>
</div>
</div>
<div id="давхардалтыг-арилгах" class="section level2" number="8.6">
<h2>
<span class="header-section-number">8.6</span> Давхардалтыг арилгах<a class="anchor" aria-label="anchor" href="#%D0%B4%D0%B0%D0%B2%D1%85%D0%B0%D1%80%D0%B4%D0%B0%D0%BB%D1%82%D1%8B%D0%B3-%D0%B0%D1%80%D0%B8%D0%BB%D0%B3%D0%B0%D1%85"><i class="fas fa-link"></i></a>
</h2>
<p>Энэхүү номын [De-duplication] хэсгээс давхардалтыг арилгах нэмэлт аргатай танилцаж болно. Энэ хэсэгт бид зөвхөн мөрний энгийн давхардалтыг арилгахыг харуулна.</p>
<p><strong>dplyr</strong> багц <code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct()</a></code> гэсэн функцтэй. Энэ функц датан дах бүх мөрний давхардалтыг шалгасны дараа датаг зөвхөн өвөрмөц мөртэй болгож хувиргадаг. Энэ үйлдлээр зөвхөн 100% адилхан мөрүүдийн давхардалт арилдаг.</p>
<p>Давхардсан мөрийг хайхдаа мөрүүдийг хэсэгчилэн шалгаж болно (default аар бүх мөрийг зэрэг шалгана). Хэдий хэмжээний мөрүүдэд хайгуул хийхээ өөрөө тохируулж болно (давхардалтыг арилгах хэсэгт мөн тайлбарласан). Энэ тохиолдолд зөвхөн тухайн хайлт хийсэн хэсэгт л өвөрмөц мөртэй болдог.</p>
<p>Жишээнд хоосон <code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct()</a></code> цэвэрлэх холбоосонд залгасан байна. Ингэснээр 100% ижилхэн мөрүүдийн давхардал датанаас цэвэрлэгдсэн гэсэн үг (бүх мөр зэрэг шалгагдсан).</p>
<p>Жишээнд <code>linelist</code> -ийн мөрний тоо <code>nrow(linelist)</code> -оор эхэлж байна.</p>
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Давхардалтыг арилгасны дараа үлдсэн мөрийн тоог <code>nrow(linelist)</code> -ээр уншуулж шалгана. Хэрэв мөрийн тоо багассан бол 100% ижил давхардсан мөрнүүд арилсан гэсэн үг.</p>
<p>Pipe холбоосондоо <code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct()</a></code> -ийг залгаж өгөв:</p>
<div class="sourceCode" id="cb218"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ЦЭВЭРЛЭХ 'PIPE' ХОЛБООС (түүхий датаг үе шаттайгаар дамжуулан цэвэрлэдэг холбоос) </span>
<span class="co">##################################################################################</span>

<span class="co"># Цэвэрлэх холбоосыг эхлэх</span>
<span class="co">###########################</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    
    <span class="co"># баганын нэрсийг жигдрүүлэх</span>
    <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    
    <span class="co"># зарим баганын нэрийг гараар өөрчил</span>
            <span class="co"># ШИНЭ нэр             # ХУУЧИН нэр</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>date_infection       <span class="op">=</span> <span class="va">infection_date</span>,
           date_hospitalisation <span class="op">=</span> <span class="va">hosp_date</span>,
           date_outcome         <span class="op">=</span> <span class="va">date_of_outcome</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    
    <span class="co"># баганыг хас</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">row_num</span>, <span class="va">merged_header</span>, <span class="va">x28</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  
    <span class="co"># ЭНЭ ХҮРТЭЛХ ҮЙЛДЭЛ ӨМНӨХ ХЭСЭГТТЭЙ АДИЛ</span>
    <span class="co">#####################################################</span>
    
    <span class="co"># давхардлыг арилгах</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
<!-- ======================================================= -->
<!-- ======================================================= -->
</div>
<div id="багана-үүсгэх-ба-хувиргах" class="section level2" number="8.7">
<h2>
<span class="header-section-number">8.7</span> Багана үүсгэх ба хувиргах<a class="anchor" aria-label="anchor" href="#%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D0%B0-%D2%AF%D2%AF%D1%81%D0%B3%D1%8D%D1%85-%D0%B1%D0%B0-%D1%85%D1%83%D0%B2%D0%B8%D1%80%D0%B3%D0%B0%D1%85"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Шинэ багана нэмэх эсвэл багана хувиргахдаа dplyr-ын <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> функцыг ашиглахыг зөвлөж байна.</strong></p>
<p>Дараах жишээнд <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>-аар хэрхэн шинэ багана нэмэхийг харуулав. Синтакс нь: <code>mutate(new_column_name = value or transformation)</code></p>
<p>R-ын <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> Stata-ын <code>generate</code>коммандтай төстэй боловч хуучин баганыг хувиргадаж болдгоороо онцлог.</p>
<div id="шинэ-багана" class="section level3 unnumbered">
<h3>Шинэ багана<a class="anchor" aria-label="anchor" href="#%D1%88%D0%B8%D0%BD%D1%8D-%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D0%B0"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> -ээр шинэ багана үүсгэх энгийн жишээг дор харуулав. Бүх мөрөндөө 10 гэсэн утгатай <code>new_col</code> хэмээх багана нэмж байна.</p>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>new_col <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>Өөр баганын утгыг оролцуулан тооцоолол хийж бас болно. Дор жишээнд <code>ht_cm</code>, <code>wt_kg</code> гэсэн хуучин хоёр баганы утгыг оролцуулан тооцоолол хийж <code>bmi</code> (Биеийн Жингийн Индекс-БЖИ) -гэсэн шинэ багана үүсгэв (БЖИ = кг/жин^2) .</p>
<div class="sourceCode" id="cb220"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>bmi <span class="op">=</span> <span class="va">wt_kg</span> <span class="op">/</span> <span class="op">(</span><span class="va">ht_cm</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p>Олон багана зэрэг шинээр үүсгэх бол багана тус бүрийг таслалаар тусгаарлаж шинэ мөрөнд бичнэ. Үүнийг дор жишээгээр харуулав. Хуучин баганыг нэтгэхдээ <strong>stringr</strong> -ын <code><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue()</a></code>-эийг бас ашиглаж болдог. ([Characters and strings] -аас харж болно.</p>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_col_demo</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                       
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    new_var_dup    <span class="op">=</span> <span class="va">case_id</span>,             <span class="co"># шинэ багана = хуучин баганыг хувилах</span>
    new_var_static <span class="op">=</span> <span class="fl">7</span>,                   <span class="co"># шинэ багана = бүх утга ижилхэн</span>
    new_var_static <span class="op">=</span> <span class="va">new_var_static</span> <span class="op">+</span> <span class="fl">5</span>,  <span class="co"># хуучин багана дээр шинэ багана үүсгэж болох ба ингэхдээ өөр баганын утгыг оролцуулан тооцоолол хийж болно. </span>
    new_var_paste  <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">"{hospital} on ({date_hospitalisation})"</span><span class="op">)</span> <span class="co">#  бусад баганын утгыг хооронд нь нийлүүлж (paste) шинэ баганаү үсгэж болно.</span>
    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">case_id</span>, <span class="va">hospital</span>, <span class="va">date_hospitalisation</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"new"</span><span class="op">)</span><span class="op">)</span>        <span class="co"># жишээ үзүүлэх зорилгоор зөвхөн шинэ багануудыг харуулсан</span></code></pre></div>
<p>Үүссэн шинэ багануудыг шалга. Жишээ болгож шинээр үүссэн багана, эдгээрий үүсгэхэд оролцсон хуучин багануудыг дор хэвлэлээ :</p>
<div id="htmlwidget-40be30e9afd9597add88" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-40be30e9afd9597add88">{"x":{"filter":"none","vertical":false,"data":[["5fe599","8689b7","11f8ea","b8812a","893f25","be99c8","07e3e8","369449","f393b4","1389ca","2978ac","57a565","fc15ef","2eaa9a","bbfa93","c97dd9","f50e8a","3a7673","7f5a01","ddddee","99e8fa","567136","9371a9","bc2adf","403057","8bd1e8","f327be","42e1a9","90e5fe","959170","8ebf6e","e56412","6d788e","a47529","67be4e","da8ecb","148f18","2cb9a5","f5c142","70a9fe","3ad520","062638","c76676","baacc1","497372","23e499","38cc4a","3789ee","c71dcd","6b70f0"],["Other",null,"St. Mark's Maternity Hospital (SMMH)","Port Hospital","Military Hospital","Port Hospital",null,null,null,null,"Port Hospital","Military Hospital",null,null,"Other","Port Hospital","Port Hospital","Port Hospital",null,"Other","Port Hospital","Port Hospital","St. Mark's Maternity Hospital (SMMH)",null,"Other",null,"St. Marks Maternity Hopital (SMMH)","Military Hospital","Port Hospital","Central Hospital","Military Hospital","Central Hospital",null,"Military Hospital","Other",null,null,"Port Hospital","Port Hospital","Port Hospital",null,"Central Hospital","Military Hospital","Other","Other","Other",null,"St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)",null],["2014-05-15T00:00:00Z","2014-05-14T00:00:00Z","2014-05-18T00:00:00Z","2014-05-20T00:00:00Z","2014-05-22T00:00:00Z","2014-05-23T00:00:00Z","2014-05-29T00:00:00Z","2014-06-03T00:00:00Z","2014-06-06T00:00:00Z","2014-06-07T00:00:00Z","2014-06-08T00:00:00Z","2014-06-15T00:00:00Z","2014-06-17T00:00:00Z","2014-06-17T00:00:00Z","2014-06-20T00:00:00Z","2014-06-19T00:00:00Z","2014-06-23T00:00:00Z","2014-06-24T00:00:00Z","2014-06-27T00:00:00Z","2014-06-28T00:00:00Z","2014-06-29T00:00:00Z","2014-07-03T00:00:00Z","2014-07-09T00:00:00Z","2014-07-09T00:00:00Z","2014-07-11T00:00:00Z","2014-07-11T00:00:00Z","2014-07-13T00:00:00Z","2014-07-14T00:00:00Z","2014-07-14T00:00:00Z","2014-07-13T00:00:00Z","2014-07-14T00:00:00Z","2014-07-17T00:00:00Z","2014-07-17T00:00:00Z","2014-07-18T00:00:00Z","2014-07-19T00:00:00Z","2014-07-20T00:00:00Z","2014-07-20T00:00:00Z","2014-07-22T00:00:00Z","2014-07-24T00:00:00Z","2014-07-26T00:00:00Z","2014-07-24T00:00:00Z","2014-07-27T00:00:00Z","2014-07-25T00:00:00Z","2014-07-27T00:00:00Z","2014-07-31T00:00:00Z","2014-08-01T00:00:00Z","2014-08-03T00:00:00Z","2014-08-02T00:00:00Z","2014-08-02T00:00:00Z","2014-08-04T00:00:00Z"],["5fe599","8689b7","11f8ea","b8812a","893f25","be99c8","07e3e8","369449","f393b4","1389ca","2978ac","57a565","fc15ef","2eaa9a","bbfa93","c97dd9","f50e8a","3a7673","7f5a01","ddddee","99e8fa","567136","9371a9","bc2adf","403057","8bd1e8","f327be","42e1a9","90e5fe","959170","8ebf6e","e56412","6d788e","a47529","67be4e","da8ecb","148f18","2cb9a5","f5c142","70a9fe","3ad520","062638","c76676","baacc1","497372","23e499","38cc4a","3789ee","c71dcd","6b70f0"],[12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12],["Other on (2014-05-15)","NA on (2014-05-14)","St. Mark's Maternity Hospital (SMMH) on (2014-05-18)","Port Hospital on (2014-05-20)","Military Hospital on (2014-05-22)","Port Hospital on (2014-05-23)","NA on (2014-05-29)","NA on (2014-06-03)","NA on (2014-06-06)","NA on (2014-06-07)","Port Hospital on (2014-06-08)","Military Hospital on (2014-06-15)","NA on (2014-06-17)","NA on (2014-06-17)","Other on (2014-06-20)","Port Hospital on (2014-06-19)","Port Hospital on (2014-06-23)","Port Hospital on (2014-06-24)","NA on (2014-06-27)","Other on (2014-06-28)","Port Hospital on (2014-06-29)","Port Hospital on (2014-07-03)","St. Mark's Maternity Hospital (SMMH) on (2014-07-09)","NA on (2014-07-09)","Other on (2014-07-11)","NA on (2014-07-11)","St. Marks Maternity Hopital (SMMH) on (2014-07-13)","Military Hospital on (2014-07-14)","Port Hospital on (2014-07-14)","Central Hospital on (2014-07-13)","Military Hospital on (2014-07-14)","Central Hospital on (2014-07-17)","NA on (2014-07-17)","Military Hospital on (2014-07-18)","Other on (2014-07-19)","NA on (2014-07-20)","NA on (2014-07-20)","Port Hospital on (2014-07-22)","Port Hospital on (2014-07-24)","Port Hospital on (2014-07-26)","NA on (2014-07-24)","Central Hospital on (2014-07-27)","Military Hospital on (2014-07-25)","Other on (2014-07-27)","Other on (2014-07-31)","Other on (2014-08-01)","NA on (2014-08-03)","St. Mark's Maternity Hospital (SMMH) on (2014-08-02)","St. Mark's Maternity Hospital (SMMH) on (2014-08-02)","NA on (2014-08-04)"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>hospital<\/th>\n      <th>date_hospitalisation<\/th>\n      <th>new_var_dup<\/th>\n      <th>new_var_static<\/th>\n      <th>new_var_paste<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p><span style="color: darkgreen;"><strong><em>ЗӨВЛӨГӨӨ:</em></strong> <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> -ын өөр нэгэн хувилбар нь <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute()</a></code> юм. Энэ функц <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> шиг шинэ багана нэмэхээс гадна функц дотор бичигдээгүй бүх баганыг хасдаг.</span></p>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># УНШИГЧИД ХАРАГДАХГҮЙ</span>
<span class="co"># дээр үүсгэсэн баганыг хасна</span>
<span class="co"># linelist &lt;- linelist %&gt;% </span>
<span class="co">#   select(-contains("new_var"))</span></code></pre></div>
</div>
<div id="багана-дах-дата-төрлийг-хувиргах" class="section level3 unnumbered">
<h3>Багана дах дата төрлийг хувиргах<a class="anchor" aria-label="anchor" href="#%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D0%B0-%D0%B4%D0%B0%D1%85-%D0%B4%D0%B0%D1%82%D0%B0-%D1%82%D3%A9%D1%80%D0%BB%D0%B8%D0%B9%D0%B3-%D1%85%D1%83%D0%B2%D0%B8%D1%80%D0%B3%D0%B0%D1%85"><i class="fas fa-link"></i></a>
</h3>
<p>Огноо, тоо, логик (TRUE/FALSE) утгатай баганын дата төрлийг зөв тодорхойлж оруулбал цаашид ажиллахад хялбар байдаг. Жишээ нь хашилттай “2” character гэж уншигддаг бол хашилтгүй 2 -ыг тоо гэж уншина!</p>
<p>Импорт хийж байхдаа баганын дата төрлийг тохируулж болдог ч олон үйлдэлтэй. [R Basics] хэсэгт обьектийн дата төрөл, үүнийг хэрхэн хувиргах талаар дэлгэрүүлж уншиж болно.</p>
<p>Дараах кодоор багануудын төрөл зөв танигдсан эсэхийг шалгана. Мөн <code>skim()</code> -ээр багана дах дата төрлийг харж болно.</p>
<p>Энд харуулснаар <code>age</code> баганын дата төрөл character байна. Энэ багананд математик тооцоолол хийхийн тулд дата төрөл нь тоо байх шаардлагатай!</p>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "character"</code></pre>
<p><code>date_onset</code> баганын төрөл нь мөн character байна! Анализ хийхийн тулд эдгээр багана огноо гэж танигдсан байх шаардлагатай!</p>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">date_onset</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "character"</code></pre>
<p>Эдгээр тохиолдолд <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>-аар баганыг дахин тодорхойлж зөв төрөлд нь хувиргаж болно. Ингэхэд багана дах утга өөрчлөгдөхгүй зөвхөн дата төрөл өөрчлөгддөг. Дорх жишээнд <code>age</code> баганын дата төрлийг тоо болгож хувиргаж байна:</p>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Мөн <code><a href="https://rdrr.io/r/base/character.html">as.character()</a></code>, <code><a href="https://rdrr.io/r/base/logical.html">as.logical()</a></code> функцуудыг дээрхийн адил хэрэглэж болно. Factor төрөлрүү хувиргахдаа <strong>base</strong> R -ын <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> эсвэл <strong>forcats</strong>-ын <code><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor()</a></code>-г хэрэглэдэг. Энэ талаар [Factors] хэсгээс нэмж уншна уу.</p>
<p>Огноог болгоомжтой хувиргах шаардлагатай. [Working with dates] хэсэгт хэд хэдэн аргуудыг дурьдсан. Түүхий дата дах огноонууд бүгд ижилхэн форматтай байвал цаашид Date төрөлд хувиргахад хялбар ( “MM/DD/YYYY”, эсвэл “DD MM YYYY” гэх мэт). Огноог Date төрөлд хувиргасны дараа зөв хувирсан эсэхийг заавал шалгаж бай.</p>
</div>
<div id="бүлэглэсэн-дата" class="section level3 unnumbered">
<h3>Бүлэглэсэн дата<a class="anchor" aria-label="anchor" href="#%D0%B1%D2%AF%D0%BB%D1%8D%D0%B3%D0%BB%D1%8D%D1%81%D1%8D%D0%BD-%D0%B4%D0%B0%D1%82%D0%B0"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> функц <em>бүлэглэгдсэн</em> датанд ( [Grouping data] хэсгийг хар) арай өөр байдлаар хэрэглэдэг. Ихэнх статистикийн <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>, <code><a href="https://rdrr.io/r/stats/median.html">median()</a></code>, <code><a href="https://rdrr.io/r/base/Extremes.html">max()</a></code> зэрэг тооцооллыг нийт датанд биш бүлэглэсэн хэсгүүдэд тооцоолдог.</p>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># насыг бүх мөрний дунджаар хуваах</span>
<span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age_norm <span class="op">=</span> <span class="va">age</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">age</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span>

<span class="co"># насыг эмнэлэгт хэвтсэн бүлгийн дунджаар хуваах</span>
<span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">hospital</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age_norm <span class="op">=</span> <span class="va">age</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">age</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Бүлэглэсэн хүснэгтэд <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate ()</a></code> -г хэрхэн хэрэглэх талаар <a href="https://dplyr.tidyverse.org/reference/mutate.html">tidyverse mutate documentation</a> хэсгээс нэмж уншна уу.</p>
</div>
<div id="clean_across" class="section level3 unnumbered">
<h3>Олон баганыг хувиргах<a class="anchor" aria-label="anchor" href="#clean_across"><i class="fas fa-link"></i></a>
</h3>
<p>Кодыг богино болгох үүднээс багануудыг зэрэг хувиргах шаардлага гардаг. Үүнийг <strong>dplyr</strong> -ын ( <strong>tidyverse</strong> багцуудын нэг) <code><a href="https://dplyr.tidyverse.org/reference/across.html">across()</a></code>-оор хийж болно. <strong>dplyr</strong> -ын фүх функцийг <code><a href="https://dplyr.tidyverse.org/reference/across.html">across()</a></code> -тай хавсарч хэрэглэх боломжтой ч <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> зэрэгтэй илүү хамт хэрэглэдэг.[Descriptive tables] хэсгээс <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> -тай хэрхэн хавсарч хэрэглэж болох талаар харна уу.</p>
<p><code><a href="https://dplyr.tidyverse.org/reference/across.html">across()</a></code>-ын<code>.cols =</code> аргументэд сонгосон багануудаа оруулаад, <code>.fns =</code> аргументэд гүйцэтгэх функцээ зааж өгнө. <code>.fns</code> -д заагдсан функц өөрийн аргументтэй бол таслал аваад <code><a href="https://dplyr.tidyverse.org/reference/across.html">across()</a></code> хаалт дотроо нэмж оруулна.</p>
<div id="across-багана-сонгох" class="section level4 unnumbered">
<h4>
<code>across()</code> багана сонгох<a class="anchor" aria-label="anchor" href="#across-%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D0%B0-%D1%81%D0%BE%D0%BD%D0%B3%D0%BE%D1%85"><i class="fas fa-link"></i></a>
</h4>
<p>Хувиргах багануудаа <code>.cols =</code> -д зааж өг. Баганыг нэг бүрчлэн нэрлэж оруул. Эсвэл “tidyselect” -ын туслах функцээс ашиглаж болно. Сонгосон функцээ <code>.fns =</code>-д зааж өг. Оруулсан функц <strong>хаалтгүйгээр</strong> бичигдсэн байгааг дор жишээнээс харна уу.</p>
<p><code>Дор жишээнд across()</code> дотор бичигдсэн багануудад <code><a href="https://rdrr.io/r/base/character.html">as.character()</a></code> хувиргалт зэрэг хийгдэж байна.</p>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">temp</span>, <span class="va">ht_cm</span>, <span class="va">wt_kg</span><span class="op">)</span>, .fns <span class="op">=</span> <span class="va">as.character</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Багана сонгох үйлдлийг “tidyselect” -ын туслах функцууд ашиглаж хялбарчилдаг. Энэ функцуудын талаар Багана сонгох болон эрэмбэлэх хэсэгт дэлгэрүүлж тайлбарласан. Эдгээр туслах функцэд : <code><a href="https://tidyselect.r-lib.org/reference/everything.html">everything()</a></code>, <code><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col()</a></code>, <code>where()</code>, <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with()</a></code>, <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">ends_with()</a></code>, <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains()</a></code>, <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">matches()</a></code>, <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">num_range()</a></code> <code><a href="https://tidyselect.r-lib.org/reference/all_of.html">any_of()</a></code> орно.</p>
<p>Энд <strong>бүх баганыг</strong> хэрхэн зэрэг character төрөлд хувиргахыг харуулав:</p>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#бүх баганыг character болгож хувиргах</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, .fns <span class="op">=</span> <span class="va">as.character</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Дор зөвхөн нэрэндээ “date” гэсэн үг агуулсан багануудыг character -руу хувиргаж байна (таслал, хаалтны байрлалыг ажигла):</p>
<div class="sourceCode" id="cb231"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#"date" -гэсэн үг нэрэнд нь бичигдсэн бүх баганыг character болгож хувиргах</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"date"</span><span class="op">)</span>, .fns <span class="op">=</span> <span class="va">as.character</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Дор POSIXct хэлбэрт (цаг хугацааг харуулсан түүхий датаны хэлбэр) байсан багануудыг хэрхэн хувиргахыг харуулав. Ингэхдээ <code>is.POSIXct()</code> функцээр багануудыг шалгаад <code>TRUE</code> хариу өгсөн багана болгоныг <code><a href="https://rdrr.io/r/base/as.Date.html">as.Date()</a></code>-руу хувиргаснаар зөв Date хэлбэрт оруулах болно.</p>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu">where</span><span class="op">(</span><span class="va">is.POSIXct</span><span class="op">)</span>, .fns <span class="op">=</span> <span class="va">as.Date</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<ul>
<li>Дээр бичсэнээр <code><a href="https://dplyr.tidyverse.org/reference/across.html">across()</a></code> доторх <code>where()</code> функцээр <code>is.POSIXct</code> функц үнэн (TRUE), худал (FALSE) эсэхийг шалгаж байна.<br>
</li>
<li>Энэхүү <code>is.POSIXct()</code> нь <strong>lubridate</strong> багцын функц. Бусад төстэй “is”-ээр эхэлдэг функцууд <code><a href="https://rdrr.io/r/base/character.html">is.character()</a></code>, <code><a href="https://rdrr.io/r/base/numeric.html">is.numeric()</a></code>, <code><a href="https://rdrr.io/r/base/logical.html">is.logical()</a></code> нар <strong>base R</strong> багцын функцууд.</li>
</ul>
</div>
<div id="across-функцууд" class="section level4 unnumbered">
<h4>
<code>across()</code> функцууд<a class="anchor" aria-label="anchor" href="#across-%D1%84%D1%83%D0%BD%D0%BA%D1%86%D1%83%D1%83%D0%B4"><i class="fas fa-link"></i></a>
</h4>
<p><code>?across()</code> коммандаар зааврыг гаргаж ирж танилцаж <code>across</code> -коммандад функц хэрхэн оруулах талаар дэлгэрэнгүйтэй танилцаж болно . Функц гэдэг ойлголтод хэд хэдэн тодорхойлолт байдаг ба таны зохиосон функц ч бас үүнд ордог.</p>
<ul>
<li><p>Функцын нэрийг дангаар нь өгч болно (ж:<code>mean</code> эсвэл <code>as.character</code>)<br></p></li>
<li><p>Функцыг <strong>purrr</strong>-багцын форматаар уншуулж (ж:<code>~ mean(.x, na.rm = TRUE)</code>) ( [this page][Iteration, loops, and lists]-ээс хар)<br></p></li>
<li>
<p>Олон функцуудыг list -д жагсааж оруулж болно (ж: <code>list(mean = mean, n_miss = ~ sum(is.na(.x))</code>).</p>
<ul>
<li>Олон функц зэрэг оруулж буй үед , multiple transformed columns will be returned per input column, with unique names in the format <code>col_fn</code>. Шинээр үүсэх багануудын нэрийг <strong>glue</strong> -ын <code>.names =</code> аргументээр тохируулж болно ( [Characters and strings]-ээс нэмж хар) <code>{.col}</code> болон <code>{.fn}</code> are shorthand for the input column and function.</li>
</ul>
</li>
</ul>
<p><code><a href="https://dplyr.tidyverse.org/reference/across.html">across()</a></code>-ын талаарх нэмэлт онлайн эх сурвалжууд: <a href="https://www.tidyverse.org/blog/2020/04/dplyr-1-0-0-colwise/">creator Hadley Wickham’s thoughts/rationale</a></p>
</div>
</div>
<div id="coalesce" class="section level3 unnumbered">
<h3>
<code>coalesce()</code><a class="anchor" aria-label="anchor" href="#coalesce"><i class="fas fa-link"></i></a>
</h3>
<p>Энэхүү <strong>dplyr</strong> багцын функц хамгийн эхний дутуу биш утгыг байрлал бүрт олж тогтоодог. Ингэснээр хамгийн эхний боломжит дутуу биш утгыг дутуу утгатай газар таны заавраар “нөхдөг”.</p>
<p>Үүнийг дараах байдлаар тайлбарлая: Таньд хоёр вектор дата байна гэж бодъё. Нэг нь өвчтөний оношлогдсон тосгонууд, нөгөө нь өвчтөний амьдардаг хотууд. Үүний эхний дутуу биш утгыг coalesce-г ашиглаж индекс бүрт олж болно:</p>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">village_detection</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="cn">NA</span>,  <span class="cn">NA</span><span class="op">)</span>
<span class="va">village_residence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"c"</span>, <span class="st">"a"</span>, <span class="st">"d"</span><span class="op">)</span>

<span class="va">village</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/coalesce.html">coalesce</a></span><span class="op">(</span><span class="va">village_detection</span>, <span class="va">village_residence</span><span class="op">)</span>
<span class="va">village</span>    <span class="co"># хэвлэ</span></code></pre></div>
<pre><code>## [1] "a" "b" "a" "d"</code></pre>
<p>Хүснэгтэд мөн адил хэрэглэгднэ: таны заасан багана дах эхний дутуу биш утгыг мөрийн дагуу өөр баганад оноож өгнө (таны заасан дарааллын дагуу ).</p>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>village <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/coalesce.html">coalesce</a></span><span class="op">(</span><span class="va">village_detection</span>, <span class="va">village_residence</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Энэ жишээнд “мөр - дагуух” гүйцэтгэлийг харуулав. Энэ үйлдлийг хэрхэн хийх талаар Мөр-дагуу тооцоолол хэсгээс харна уу.</p>
</div>
<div id="cumulative-математик" class="section level3 unnumbered">
<h3>Cumulative математик<a class="anchor" aria-label="anchor" href="#cumulative-%D0%BC%D0%B0%D1%82%D0%B5%D0%BC%D0%B0%D1%82%D0%B8%D0%BA"><i class="fas fa-link"></i></a>
</h3>
<p>Мөрний утгыг өмнөх мөрний утгатай нэгтгэж sum/mean/min/max зэрэг функцуудээр бодолт хийж үр дүнг cumulative байдлаар харуулах бол дараах функцыг хэрэглэнэ:</p>
<p><code><a href="https://rdrr.io/r/base/cumsum.html">cumsum()</a></code> -аар cumulative нийлбэрийг олно:</p>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">15</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span>     <span class="co"># нийлбэр нэг утга бодогдно</span></code></pre></div>
<pre><code>## [1] 31</code></pre>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">15</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span>  <span class="co"># энэхүү векторын утга тус бүрт cumulative нийлбэр бодогдно</span></code></pre></div>
<pre><code>## [1]  2  6 21 31</code></pre>
<p>Хүснэгтийн хувьд мөн адилхан. Дэгдэлтийн үеийн тохиолдлын сumulative нийлбэрийг дараах кодоор бодно.</p>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cumulative_case_counts</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># linelist-ээс эхэл</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">date_onset</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                 <span class="co"># Огноог тоолох ('n')   </span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>cumulative_cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Мөр бүрт cumulative нийлбэртэй шинэ багана үүсгэ</span></code></pre></div>
<p>Дээрх коммандаар хийсэн хүснэгтийн эхний 10 мөрийг харах:</p>
<div class="sourceCode" id="cb241"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cumulative_case_counts</span>, <span class="fl">10</span><span class="op">)</span></code></pre></div>
<pre><code>##    date_onset n cumulative_cases
## 1  2012-04-15 1                1
## 2  2012-05-05 1                2
## 3  2012-05-08 1                3
## 4  2012-05-31 1                4
## 5  2012-06-02 1                5
## 6  2012-06-07 1                6
## 7  2012-06-14 1                7
## 8  2012-06-21 1                8
## 9  2012-06-24 1                9
## 10 2012-06-25 1               10</code></pre>
<p>Cumulative тохиолдлын тоогоор график хийх тухай [Epidemic curves] хэсгээс уншина уу.</p>
<p>Мөн дараах функцуудын талаар харна уу:<br><code><a href="https://rdrr.io/r/base/cumsum.html">cumsum()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/cumall.html">cummean()</a></code>, <code><a href="https://rdrr.io/r/base/cumsum.html">cummin()</a></code>, <code><a href="https://rdrr.io/r/base/cumsum.html">cummax()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/cumall.html">cumany()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/cumall.html">cumall()</a></code></p>
</div>
<div id="base-r--г-ашиглах" class="section level3 unnumbered">
<h3>
<strong>base</strong> R -г ашиглах<a class="anchor" aria-label="anchor" href="#base-r--%D0%B3-%D0%B0%D1%88%D0%B8%D0%B3%D0%BB%D0%B0%D1%85"><i class="fas fa-link"></i></a>
</h3>
<p><strong>base</strong> R-аар шинэ багана үүсгэх (эсвэл хуучин баганыг өөрчлөх) бол хүснэгтийн нэрийн ард <code>$</code> тэмдэгт тавьж <em>шинэ</em> үүсгэх (эсвэл өөрчлөх) баганын нэрийг шууд ардаас нь залгаж бичдэг. Шинэ баганад утга оруулахдаа оноох оператор <code>&lt;-</code> ашиглана. <strong>base</strong> R -т хүснэгтийн нэрийг баганын нэрний өмнө бичдэг болохыг анхаарна уу (ж: <code>dataframe$column</code>). Дараах жишээнд <code>bmi</code> баганыг <strong>base</strong> R ашиглаж үүсгэж буйг харуулав:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="%D0%B4%D0%B0%D1%82%D0%B0-%D1%86%D1%8D%D0%B2%D1%8D%D1%80%D0%BB%D1%8D%D0%B3%D1%8D%D1%8D-%D0%B1%D0%B0-%D2%AF%D0%BD%D0%B4%D1%81%D1%8D%D0%BD-%D1%84%D1%83%D0%BD%D0%BA%D1%86%D1%83%D1%83%D0%B4.html#cb243-1" aria-hidden="true" tabindex="-1"></a>linelist<span class="sc">$</span>bmi <span class="ot">=</span> linelist<span class="sc">$</span>wt_kg <span class="sc">/</span> (linelist<span class="sc">$</span>ht_cm <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">^</span> <span class="dv">2</span><span class="er">)</span></span></code></pre></div>
</div>
<div id="pipe-холбоосонд-залгах" class="section level3 unnumbered">
<h3>Pipe холбоосонд залгах<a class="anchor" aria-label="anchor" href="#pipe-%D1%85%D0%BE%D0%BB%D0%B1%D0%BE%D0%BE%D1%81%D0%BE%D0%BD%D0%B4-%D0%B7%D0%B0%D0%BB%D0%B3%D0%B0%D1%85"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Дараах кодны төгсгөлд шинэ мөр үүсгэх болон зарим багануудын төрөл хувиргах үйлдлүүдийг pipe холбоосонд залгаж үзүүлэв.</strong></p>
<div class="sourceCode" id="cb244"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ЦЭВЭРЛЭХ 'PIPE' ХОЛБООС (түүхий датаг үе шаттайгаар цэвэрлэдэг холбоос) </span>
<span class="co">##################################################################################</span>

<span class="co"># Цэвэрлэх холбоосыг эхлэх</span>
<span class="co">###########################</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    
    <span class="co"># баганын нэрсийг жигдрүүлэх</span>
    <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    
    <span class="co"># зарим баганын нэрийг гараар өөрчил</span>
            <span class="co"># ШИНЭ нэр             # ХУУЧИН нэр</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>date_infection       <span class="op">=</span> <span class="va">infection_date</span>,
           date_hospitalisation <span class="op">=</span> <span class="va">hosp_date</span>,
           date_outcome         <span class="op">=</span> <span class="va">date_of_outcome</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    
    <span class="co"># баганыг хас</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">row_num</span>, <span class="va">merged_header</span>, <span class="va">x28</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 

    <span class="co"># давхардалтыг арилга</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  
    <span class="co"># ЭНЭ ХҮРТЭЛХ ҮЙЛДЭЛ ӨМНӨХ ХЭСЭГТТЭЙ АДИЛ</span>
    <span class="co">###################################################</span>
    <span class="co"># Шинэ багана нэм</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>bmi <span class="op">=</span> <span class="va">wt_kg</span> <span class="op">/</span> <span class="op">(</span><span class="va">ht_cm</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  
    <span class="co"># баганын төрлийг хувирга</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"date"</span><span class="op">)</span>, <span class="va">as.Date</span><span class="op">)</span>, 
           generation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">generation</span><span class="op">)</span>,
           age        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
</div>
</div>
<div id="утга-өөрчлөх" class="section level2" number="8.8">
<h2>
<span class="header-section-number">8.8</span> Утга өөрчлөх<a class="anchor" aria-label="anchor" href="#%D1%83%D1%82%D0%B3%D0%B0-%D3%A9%D3%A9%D1%80%D1%87%D0%BB%D3%A9%D1%85"><i class="fas fa-link"></i></a>
</h2>
<p>Дараах тохиолдлуудад датаны утгыг өөрчлөх шаардлага гардаг:</p>
<ul>
<li>аливаа нэг утгыг янзлах (ж: аль нэг огнооны жил буруу эсвэл буруу форматтай орсон байх)</li>
<li>янз бүрээр галиглагдаж бичигдсэн утгуудыг жигд болгох</li>
<li>categorical утгатай шинэ багана үүсгэх</li>
<li>numerical утгыг бүлэглэж шинэ багана нэмэх (ж: насны бүлэглэл)</li>
</ul>
<div id="өвөрмөц-утгууд" class="section level3 unnumbered">
<h3>Өвөрмөц утгууд<a class="anchor" aria-label="anchor" href="#%D3%A9%D0%B2%D3%A9%D1%80%D0%BC%D3%A9%D1%86-%D1%83%D1%82%D0%B3%D1%83%D1%83%D0%B4"><i class="fas fa-link"></i></a>
</h3>
<p>Утгыг гараар өөрчлөхийн тулд <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> дотор <code><a href="https://dplyr.tidyverse.org/reference/recode.html">recode()</a></code> -ыг оруулдаг.</p>
<p>Жишээ нь буруу бичигдсэн огноо өөрчлөхдөө (ж: “2014-14-15”) шууд эх дата дээрээ (боловсруулалт хийхийн өмнө) гараар янзалж болно. Эсвэл <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/recode.html">recode()</a></code>-функцуудыг pipe холбоост залгаж огноог өөрчилж болно. Сүүлийн аргыг хэрэглэх нь бусдад нээлттэй (transparent), дахин боловсруулалт хийх боломж олгодгоороо ач холбогдолтой.</p>
<div class="sourceCode" id="cb245"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># алдаатай утгыг засах                   # хуучин утга  # шинэ утга</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>date_onset <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">date_onset</span>, <span class="st">"2014-14-15"</span> <span class="op">=</span> <span class="st">"2014-04-15"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Дээр бичигдсэн <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> үйлдлийг дараах байдлаар уншина: “<code>date_onset</code> баганыг шинэчлэгдсэн <code>date_onset</code> тай тэнцүүлж бичих ба ингэснээр ХУУЧИН УТГА нь ШИНЭ УТГА-аар солигдно”. <code><a href="https://dplyr.tidyverse.org/reference/recode.html">recode()</a></code> функцын энэ дараалал (ХУУЧИН = ШИНЭ) R -ын ихэнх функцэд эсрэгээрээ байдаг (шинэ = хуучин). R хөгжлийн нийгэмлэг үүнийг сайжруулахаар ажиллаж байна.</p>
<p><strong>Нэг баганад олон утгыг зэрэг өөрчлөх жишээг дор харуулав.</strong></p>
<p><code>linelist</code> -ын “hospital” баганыг цэвэрлэх шаардлагатай боллоо. Учир нь хэд хэдэн газар алдаатай бичигдэж, дутуу утгууд болж уншигдсан байна.</p>
<div class="sourceCode" id="cb246"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">hospital</span>, useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span>  <span class="co"># бүх өвөрмөц утгыг (дутуу утгатайгаар) хэвлэ  </span></code></pre></div>
<pre><code>## 
##                      Central Hopital                     Central Hospital 
##                                   11                                  457 
##                           Hospital A                           Hospital B 
##                                  290                                  289 
##                     Military Hopital                    Military Hospital 
##                                   32                                  798 
##                     Mitylira Hopital                    Mitylira Hospital 
##                                    1                                   79 
##                                Other                         Port Hopital 
##                                  907                                   48 
##                        Port Hospital St. Mark's Maternity Hospital (SMMH) 
##                                 1756                                  417 
##   St. Marks Maternity Hopital (SMMH)                                 &lt;NA&gt; 
##                                   11                                 1512</code></pre>
<p>Энэ жишээнд “hospital” багана хэвээр боловч <code><a href="https://dplyr.tidyverse.org/reference/recode.html">recode()</a></code> комманд ашиглаж зарим утгад өөрчлөлт оруулж байна. Тус бүр ардаа таслалтай байгааг анхаар!</p>
<div class="sourceCode" id="cb248"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>hospital <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">hospital</span>,
                     <span class="co"># лавлагаа: ХУУЧИН = ШИНЭ</span>
                      <span class="st">"Mitylira Hopital"</span>  <span class="op">=</span> <span class="st">"Military Hospital"</span>,
                      <span class="st">"Mitylira Hospital"</span> <span class="op">=</span> <span class="st">"Military Hospital"</span>,
                      <span class="st">"Military Hopital"</span>  <span class="op">=</span> <span class="st">"Military Hospital"</span>,
                      <span class="st">"Port Hopital"</span>      <span class="op">=</span> <span class="st">"Port Hospital"</span>,
                      <span class="st">"Central Hopital"</span>   <span class="op">=</span> <span class="st">"Central Hospital"</span>,
                      <span class="st">"other"</span>             <span class="op">=</span> <span class="st">"Other"</span>,
                      <span class="st">"St. Marks Maternity Hopital (SMMH)"</span> <span class="op">=</span> <span class="st">"St. Mark's Maternity Hospital (SMMH)"</span>
                      <span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Одоо <code>hospital</code> баганын галиглал хэрхэн засагдсаныг харья:</p>
<div class="sourceCode" id="cb249"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">hospital</span>, useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##                     Central Hospital                           Hospital A 
##                                  468                                  290 
##                           Hospital B                    Military Hospital 
##                                  289                                  910 
##                                Other                        Port Hospital 
##                                  907                                 1804 
## St. Mark's Maternity Hospital (SMMH)                                 &lt;NA&gt; 
##                                  428                                 1512</code></pre>
<p><span style="color: darkgreen;"><strong><em>ЗӨВЛӨГӨӨ:</em></strong> тэнцүүгийн тэмдгийн ард, урд авах зайн урт чухал биш. Бичсэн кодоо уншихад хялбар байлгах үүднээс = тэмдгийг мөр болгонд тэгшхэн тааруулж бичсэн. Мөн хүмүүст ойлгомжтой болгохын тулд “хэш” (#) тэмдэгтээр аль нь хуучин, шинэ утгаболохыг зааж өгсөн.</span></p>
<p><span style="color: darkgreen;"><strong><em>ЗӨВЛӨГӨӨ:</em></strong> заримдаа <em>хоосон</em> утга датанд орж ирсэн байдаг ( R-ын дутуу утга (<code>NA)</code> болж танигдааuшй). Хоосон утгыг тодорхойлохдоо дундаа зайгүй давхар хашилтан бичдэг (““).</span></p>
</div>
<div id="логик-үйлдлүүд" class="section level3 unnumbered">
<h3>Логик үйлдлүүд<a class="anchor" aria-label="anchor" href="#%D0%BB%D0%BE%D0%B3%D0%B8%D0%BA-%D2%AF%D0%B9%D0%BB%D0%B4%D0%BB%D2%AF%D2%AF%D0%B4"><i class="fas fa-link"></i></a>
</h3>
<p>Энэ хэсэгт логик болон нөхцөл (conditions) ашиглаж баганын утгыг хэрхэн өөрчилдгийг харуулав:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/replace.html">replace()</a></code>, <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else()</a></code> функцыг энгийн логик үйлдэлд хэрэглэнэ.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> функцыг нарийн логик үйлдэлд хэрэглэнэ.</li>
</ul>
</div>
<div id="энгийн-логик-үйлдэл" class="section level3 unnumbered">
<h3>Энгийн логик үйлдэл<a class="anchor" aria-label="anchor" href="#%D1%8D%D0%BD%D0%B3%D0%B8%D0%B9%D0%BD-%D0%BB%D0%BE%D0%B3%D0%B8%D0%BA-%D2%AF%D0%B9%D0%BB%D0%B4%D1%8D%D0%BB"><i class="fas fa-link"></i></a>
</h3>
<div id="replace" class="section level4 unnumbered">
<h4>
<code>replace()</code><a class="anchor" aria-label="anchor" href="#replace"><i class="fas fa-link"></i></a>
</h4>
<p>Энгийн логик шалгуурыг үүгэхдээ <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> дотор <strong>base</strong> R-ын <code><a href="https://rdrr.io/r/base/replace.html">replace()</a></code> функцыг оруулаад үүн дотор шаардлагатай логик нөхцөлөө оруулж өгнө. Синтаксын ерөнхий формат:</p>
<p><code>mutate(col_to_change = replace(col_to_change, мөрний шалгуур үзүүлэлт, шинэ утга))</code>.</p>
<p>Мөн датан дах <strong>аль нэг утгыг өвөрмөц дугаараар нь дуудаж өөрчлөх</strong> үйлдэлд <code><a href="https://rdrr.io/r/base/replace.html">replace()</a></code> -ийг их хэрэглэдэг. Дорх кодоор <code>case_id</code> баганад 2195 гэсэн утга байвал үүнтэй харалдаа орших мөрний gender баганын утгыг “Female” болгож өөрчлөх комманд өгсөн.</p>
<div class="sourceCode" id="cb251"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Жишээ: заасан ганц ажиглалтыг "Female" болгож өөрчлөх</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>gender <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html">replace</a></span><span class="op">(</span><span class="va">gender</span>, <span class="va">case_id</span> <span class="op">==</span> <span class="st">"2195"</span>, <span class="st">"Female"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><strong>base</strong> R -т дээрхитэй ижил үйлдлийг индекслэх тэмдэг буюу дөрвөлжин хаалт <code>[ ]</code> гүйцэтгэдэг (дор жишээнд харуулав). Дор кодыг дараах байдлаар уншина: “<code>linelist</code> хүснэгтийн <code>gender</code> баганыг (<code>case_id</code> баганадаа ‘2195’ гэсэн утгатай тохиолдолд) ‘Female’ болго”.</p>
<div class="sourceCode" id="cb252"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span><span class="op">$</span><span class="va">gender</span><span class="op">[</span><span class="va">linelist</span><span class="op">$</span><span class="va">case_id</span> <span class="op">==</span> <span class="st">"2195"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Female"</span></code></pre></div>
</div>
<div id="ifelse-болон-if_else" class="section level4 unnumbered">
<h4>
<code>ifelse()</code> болон <code>if_else()</code><a class="anchor" aria-label="anchor" href="#ifelse-%D0%B1%D0%BE%D0%BB%D0%BE%D0%BD-if_else"><i class="fas fa-link"></i></a>
</h4>
<p>Энгийн логик үйлдэл хийдэг <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else()</a></code> хэмээх функцууд байдаг ч оронд нь <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> функцыг хэрэглэвэл илүү ойлгомжтой (дэлгэрэнгүйг доор бичсэн). Эдгээр “if else” коммандууд нь <code>if</code> болон <code>else</code> программчлалын хялбаршуулсан хэлбэр. Синтаксын ерөнхий формат:<br><code>ifelse(нөхцөл, хэрэв нөхцөл TRUE бол дуудах утга, нөхцөл FALSE бол дуудах утга)</code></p>
<p>Дор <code>source_known</code> баганыг тодорхойлсон байна. Энэхүү кодоор <code>source</code> баганын мөр бүрт үзлэг хийж дутуу утга <em>байхгүй</em> бол харалдаа мөрний <code>source_known</code> баганын утгыг “known” болгоод, харин <code>source</code> мөрөнд дутуу утга <em>байвал</em> харалдаа мөрний <code>source_known</code> баганын утгыг “unknown” болгох болно.</p>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>source_known <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">source</span><span class="op">)</span>, <span class="st">"known"</span>, <span class="st">"unknown"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><strong>dplyr</strong> багцын <code><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else()</a></code> -ээр огноо их янзалдаг. Үүнийг хэрэглэж байхад FALSE нөхцөлд таарсан утгыг <code>NA</code> гэлгүй <code>NA_real_</code> гэж оруулдаг. Учир нь <code>TRUE</code> огноо бол <code>FALSE</code> бас огноо байх болно.</p>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Нас баралтын огноотой багана үүсгэ. Өвчтөн нас бараагүй бол `NA`-аар бич.</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>date_death <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">==</span> <span class="st">"Death"</span>, <span class="va">date_outcome</span>, <span class="cn">NA_real_</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><strong>Олон зэрэг ifelse -ийг бичихэээс зайлсхий. Оронд нь <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> -ийг хэрэглэ!</strong> Ингэснээр хялбар уншигдаж, алдаа бага гаргадаг.</p>
<div class="inline-figure"><img src="images/ifelse%20bad.png" width="100%" style="display: block; margin: auto;"></div>
<p>Outside of the context of a data frame, if you want to have an object used in your code switch its value, consider using <a href="https://rdrr.io/r/base/switch.html"><code>switch()</code></a> from <strong>base</strong> R {style=“color: red;”}</p>
</div>
</div>
<div id="clean_case_when" class="section level3 unnumbered">
<h3>Комплекс логик үйлдлүүд<a class="anchor" aria-label="anchor" href="#clean_case_when"><i class="fas fa-link"></i></a>
</h3>
<p>Бүлэг үүсгэсэн утгуудад өөрчлөлт оруулах эсвэл комплекс логик үйлдэл хийх бол <strong>dplyr</strong> -ын <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> -ийг хэрэглэвал оновчтой. Энэхүү функц хүснэгтийн мөр болгоныг шалгаад, шалгуурт нийцсэн утгыг заасны дагуу өөрчилдөг.</p>
<p><code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> комманд нь Баруун-Тал/Right-Hand Side (RHS) болон Зүүн-Тал/Left-Hand Side (LHS) -ын зарчмаар бичигдэж “тилда” <code>~</code> тэмдэгээр хуваагддаг. Логик шалгуур нь зүүн талдаа, харин нийцүүлэх утга нь баруун талдаа бичигдэж, тус бүр таслалаар зааглагдна.</p>
<p>Энэ жишээнд <code>age</code> болон <code>age_unit</code> баганыг ашиглаж <code>age_years</code> баганыг үүсгэсэн:</p>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age_years <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
            <span class="va">age_unit</span> <span class="op">==</span> <span class="st">"years"</span>  <span class="op">~</span> <span class="va">age</span>,       <span class="co"># хэрэв age жилээр бичигдсэн бол</span>
            <span class="va">age_unit</span> <span class="op">==</span> <span class="st">"months"</span> <span class="op">~</span> <span class="va">age</span><span class="op">/</span><span class="fl">12</span>,    <span class="co"># хэрэв age сараар бичигдсэн бол</span>
            <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">age_unit</span><span class="op">)</span>      <span class="op">~</span> <span class="va">age</span>,       <span class="co"># хэрэв age_unit-д дутуу утга байвал (age жилээр)</span>
            <span class="cn">TRUE</span>                 <span class="op">~</span> <span class="cn">NA_real_</span><span class="op">)</span><span class="op">)</span> <span class="co"># бусад бүх тохиолдолд дутуу утгаар оруул</span></code></pre></div>
<p>As each row in the data is evaluated, the criteria are applied/evaluated in the order the <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> statements are written - from top-to-bottom. If the top criteria evaluates to <code>TRUE</code> for a given row, the RHS value is assigned, and the remaining criteria are not even tested for that row. Thus, it is best to write the most specific criteria first, and the most general last.</p>
<p>Along those lines, in your final statement, place <code>TRUE</code> on the left-side, which will capture any row that did not meet any of the previous criteria. The right-side of this statement could be assigned a value like “check me!” or missing.</p>
<p><span style="color: red;"><strong><em>DANGER:</em></strong> <strong>Vvalues on the right-side must all be the same class</strong> - either numeric, character, date, logical, etc. To assign missing (<code>NA</code>), you may need to use special variations of <code>NA</code> such as <code>NA_character_</code>, <code>NA_real_</code> (for numeric or POSIX), and <code>as.Date(NA)</code>. Read more in [Working with dates].</span></p>
</div>
<div id="дутуу-утга" class="section level3 unnumbered">
<h3>Дутуу утга<a class="anchor" aria-label="anchor" href="#%D0%B4%D1%83%D1%82%D1%83%D1%83-%D1%83%D1%82%D0%B3%D0%B0"><i class="fas fa-link"></i></a>
</h3>
<p>Дата цэвэрлэгээний үед дутуу утгыг янзалдаг функцуудыг энд тайлбарлав.</p>
<p>Дутуу утгыг олж, янзлах талаар [Missing data] хэсгээс нэмж үзэж болно. Тухайлбал логик шалгуураар дутуу утгыг олдог функцыг <code><a href="https://rdrr.io/r/base/NA.html">is.na()</a></code> гэдэг.</p>
<p><strong><code><a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na()</a></code></strong></p>
<p><code>NA</code> дутуу утгыг өөрөөр тэмдэглэсэн дутуу утгаар (жишээ нь “Missing”) солихдоо <strong>dplyr</strong> -ын <code><a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na()</a></code> функцыг <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> дотор оруулж бичнэ. <code>recode</code> функцын адил баганын нэрийг <code><a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na()</a></code> -ын дотор оруулж бичихийг анхаар.</p>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>hospital <span class="op">=</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na</a></span><span class="op">(</span><span class="va">hospital</span>, <span class="st">"Missing"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><strong>fct_explicit_na()</strong></p>
<p>Энэ <strong>forcats</strong> багцын функц. <strong>forcats</strong> багц factor төрлийн датаг янзалхад зориулагдсан. Factor утга нь <em>дараалалтай</em> ( жишээ нь <code>c("First", "Second", "Third")</code> ) утга болон аливаа шатлал заагдсэн ( жишээ нь: эмнэлэгүүд) утгын R хэлэнд хөрвүүлсэн хэлбэр. [Factors] хэсгээс нэмж харна уу.</p>
<p>Factor датаны <code>NA</code> -г “Missing” болгож өөрчлөхөөр <code><a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na()</a></code> комманд өгвөл <code>invalid factor level, NA generated</code> гэсэн алдаа гарч ирдэг. You have tried to add “Missing” as a value, when it was not defined as a possible level of the factor, and it was rejected.</p>
<p>Ийм тохиолдолд <strong>forcats</strong> багцад байдаг <code><a href="https://forcats.tidyverse.org/reference/fct_explicit_na.html">fct_explicit_na()</a></code> функцыг ашиглах нь тохиромжтой ба энэ функц баганыг factor болгож, <code>NA</code> -г character “(Missing)” хэлбэрт хувиргадаг.</p>
<div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>hospital <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_explicit_na.html">fct_explicit_na</a></span><span class="op">(</span><span class="va">hospital</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Өөр нэгэн хувилбар бол <code><a href="https://forcats.tidyverse.org/reference/fct_expand.html">fct_expand()</a></code> функцээр factor -ын шатлалыг нэмж оруулсны дараа дутуу утгаруу өөрчлөх юм.</p>
<p><strong><code><a href="https://dplyr.tidyverse.org/reference/na_if.html">na_if()</a></code></strong></p>
<p><em>Тодорхой нэг утгыг</em> <code>NA</code>- болгохын тулд <strong>dplyr</strong>’s-ын <code><a href="https://dplyr.tidyverse.org/reference/na_if.html">na_if()</a></code> -г хэрэглэдэг. Доорх комманд нь <code>replace_na()-</code>ын эсрэг үйлдэл хийгднэ. Дараах жишээнд <code>hospital</code> багана дах “Missing” утга болгон <code>NA</code> болж хувирсан байна.</p>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>hospital <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html">na_if</a></span><span class="op">(</span><span class="va">hospital</span>, <span class="st">"Missing"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Тэмдэглэл <code><a href="https://dplyr.tidyverse.org/reference/na_if.html">na_if()</a></code> <strong>-г логик шалгуурт хэрэглэх боломжгүй</strong> (жишээ нь “бүх утга &gt; 99”). Оронд нь <code><a href="https://rdrr.io/r/base/replace.html">replace()</a></code> эсвэл <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> -ыг хэрэглэ:</p>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 40 -өөс дээш градусыг NA  болго</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>temp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html">replace</a></span><span class="op">(</span><span class="va">temp</span>, <span class="va">temp</span> <span class="op">&gt;</span> <span class="fl">40</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>

<span class="co"># 1 Jan 2000 -аас өмнөх огноог дутуу утга болго</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>date_onset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html">replace</a></span><span class="op">(</span><span class="va">date_onset</span>, <span class="va">date_onset</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2000-01-01"</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="цэвэрлэгээний-толь-бичиг" class="section level3 unnumbered">
<h3>Цэвэрлэгээний толь бичиг<a class="anchor" aria-label="anchor" href="#%D1%86%D1%8D%D0%B2%D1%8D%D1%80%D0%BB%D1%8D%D0%B3%D1%8D%D1%8D%D0%BD%D0%B8%D0%B9-%D1%82%D0%BE%D0%BB%D1%8C-%D0%B1%D0%B8%D1%87%D0%B8%D0%B3"><i class="fas fa-link"></i></a>
</h3>
<p><strong>linelist</strong> болон түүний <code>clean_variable_spelling()</code> функцээр цэвэрэлэгээний тольтой (cleaning dictionary) хүснэгтийг янзалдаг. <strong>linelist</strong> багцыг R Epidemics Consortium <a href="https://github.com/reconhub/linelist">RECON</a> боловсруулж гаргасан.</p>
<ol style="list-style-type: decimal">
<li>
<p>Цэвэрлэгээний толийг дараах гурван баганатайгаар байгуул:</p>
<ul>
<li>алдаатай утгуудыг заасан багана<br>
</li>
<li>зөв утгуудыг заасан багана<br>
</li>
<li>өөрчлөлт оруулах баганууд (жишээ нь “.global” гэвэл бүх баганыг өөрчлөх)</li>
</ul>
</li>
</ol>
<p>Тэмдэглэл: аль нэг баганад зориулсан өвөрмөц өөрчлөлтийг .global өөрчлөлт давамгайлж гүйцэтгэгддэг.</p>
<div class="inline-figure"><img src="images/cleaning_dict.png" width="100%" style="display: block; margin: auto;"></div>
<ol start="2" style="list-style-type: decimal">
<li>Цэвэрлэгээний толь бичсэн хүснэгтээ R луу импортло. Энэ жишээг [Download handbook and data] хуудсанд заасны дагуу татаж авч болно.</li>
</ol>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cleaning_dict</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"cleaning_dict.csv"</span><span class="op">)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Түүхий linelist -ийг <code>clean_variable_spelling()</code> функцэд оруулаад <code>wordlists =</code> аргументэд цэвэрлэгээний тольтой хүснэгтээ зааж өгнө. Энэ хүснэгтийн өөрчлөх гэж буй баганын нэрстэй баганыг <code>spelling_vars =</code> аргументэд зааж өгнө ( default)-аар гуравдах багана) . Хэрэв factor болон character бүх баганыг хамруулья гэвэл <code>spelling_vars =</code> аргументийг <code>NULL</code> гэж заана. Энэ функц удаан уншигдаж болохыг анхаар.</li>
</ol>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">linelist</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/linelist/man/clean_variable_spelling.html">clean_variable_spelling</a></span><span class="op">(</span>
    wordlists <span class="op">=</span> <span class="va">cleaning_dict</span>,
    spelling_vars <span class="op">=</span> <span class="st">"col"</span>,        <span class="co"># өөрчлөх баганын нэрстэй багана. default-аар гуравдах багана</span>
  <span class="op">)</span></code></pre></div>
<p>Одоо (баруун тийш нь гүйлгээд) датанд хэрхэн өөрчлөлт орсныг харж болно. Энд <code>gender</code> багана жижгээс том үсэгрүү, шинж тэмдэг агуулсан бүх багана yes/no -өөс 1/0 болж хувирсан байна.</p>
<div id="htmlwidget-93010547ce6bf496d742" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-93010547ce6bf496d742">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1399075200000\" data-max=\"1406419200000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1399939200000\" data-max=\"1407024000000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1400025600000\" data-max=\"1407110400000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1400371200000\" data-max=\"1410566400000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-13.2697246824573\" data-max=\"-13.209391925612\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"8.45171855856465\" data-max=\"8.48802917129884\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"67\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"100\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"11\" data-max=\"241\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"20\" data-max=\"24\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"35.9\" data-max=\"38\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"428.994082840237\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"67\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["5fe599","8689b7","11f8ea","b8812a","893f25","be99c8","07e3e8","369449","f393b4","1389ca","2978ac","57a565","fc15ef","2eaa9a","bbfa93","c97dd9","f50e8a","3a7673","7f5a01","ddddee","99e8fa","567136","9371a9","bc2adf","403057","8bd1e8","f327be","42e1a9","90e5fe","959170","8ebf6e","e56412","6d788e","a47529","67be4e","da8ecb","148f18","2cb9a5","f5c142","70a9fe","3ad520","062638","c76676","baacc1","497372","23e499","38cc4a","3789ee","c71dcd","6b70f0"],[4,4,2,3,3,3,4,4,4,4,4,4,6,5,6,9,10,8,7,6,7,6,8,6,10,8,6,12,5,8,7,9,11,5,8,5,6,11,7,9,7,8,9,12,13,9,8,10,8,7],["2014-05-08",null,null,"2014-05-04","2014-05-18","2014-05-03","2014-05-22","2014-05-28",null,null,"2014-05-30","2014-05-28","2014-06-14","2014-06-07","2014-06-09",null,null,null,"2014-06-23","2014-06-18","2014-06-24",null,null,"2014-07-03",null,"2014-07-10","2014-06-14",null,"2014-06-18","2014-06-29","2014-07-02","2014-07-12","2014-07-12","2014-06-13","2014-07-15","2014-06-20",null,null,"2014-07-20",null,"2014-07-12","2014-07-19","2014-07-18","2014-07-18","2014-07-27",null,"2014-07-19","2014-07-26","2014-07-24",null],["2014-05-13","2014-05-13","2014-05-16","2014-05-18","2014-05-21","2014-05-22","2014-05-27","2014-06-02","2014-06-05","2014-06-05","2014-06-06","2014-06-13","2014-06-16","2014-06-17","2014-06-18","2014-06-19","2014-06-22","2014-06-23","2014-06-25","2014-06-26","2014-06-28","2014-07-02","2014-07-08","2014-07-09","2014-07-09","2014-07-10","2014-07-12","2014-07-12","2014-07-13","2014-07-13","2014-07-14","2014-07-15","2014-07-16","2014-07-17","2014-07-17","2014-07-18","2014-07-19","2014-07-22","2014-07-22","2014-07-24","2014-07-24","2014-07-25","2014-07-25","2014-07-27","2014-07-29","2014-07-30",null,"2014-08-01","2014-08-02","2014-08-03"],["2014-05-15","2014-05-14","2014-05-18","2014-05-20","2014-05-22","2014-05-23","2014-05-29","2014-06-03","2014-06-06","2014-06-07","2014-06-08","2014-06-15","2014-06-17","2014-06-17","2014-06-20","2014-06-19","2014-06-23","2014-06-24","2014-06-27","2014-06-28","2014-06-29","2014-07-03","2014-07-09","2014-07-09","2014-07-11","2014-07-11","2014-07-13","2014-07-14","2014-07-14","2014-07-13","2014-07-14","2014-07-17","2014-07-17","2014-07-18","2014-07-19","2014-07-20","2014-07-20","2014-07-22","2014-07-24","2014-07-26","2014-07-24","2014-07-27","2014-07-25","2014-07-27","2014-07-31","2014-08-01","2014-08-03","2014-08-02","2014-08-02","2014-08-04"],[null,"2014-05-18","2014-05-30",null,"2014-05-29","2014-05-24","2014-06-01","2014-06-07","2014-06-18","2014-06-09","2014-06-15",null,"2014-07-09",null,"2014-06-30","2014-07-11","2014-07-01","2014-06-25","2014-07-06","2014-07-02","2014-07-09","2014-07-07","2014-07-20",null,"2014-07-22","2014-07-16","2014-07-14","2014-07-20","2014-07-16","2014-07-19","2014-07-27","2014-07-19",null,"2014-07-26","2014-08-14","2014-08-01","2014-07-23","2014-08-28","2014-07-28","2014-07-19",null,"2014-08-03",null,null,null,"2014-08-06","2014-08-21","2014-09-13","2014-08-04",null],[null,"Recover","Recover",null,"Recover","Recover","Recover","Death","Recover","Death","Death","Death","Recover","Recover",null,"Recover",null,null,"Death","Death","Recover",null,null,null,"Death",null,"Death","Death",null,"Death","Recover","Death","Recover","Death","Recover",null,"Death","Recover","Recover","Death",null,null,"Death","Death","Death","Death","Recover",null,"Death","Death"],["M","F","M","F","M","F","F","F","M","F","M","M","M","F","F","M","F","F","F","F","M","M","F","M","F","M","M","F","M","F","F","F","M","M","F","M","F","F","F","M","F","M","F","M","M","F","M","F","M","M"],["Other",null,"St. Mark's Maternity Hospital (SMMH)","Port Hospital","Military Hospital","Port Hospital",null,null,null,null,"Port Hospital","Military Hospital",null,null,"Other","Port Hospital","Port Hospital","Port Hospital",null,"Other","Port Hospital","Port Hospital","St. Mark's Maternity Hospital (SMMH)",null,"Other",null,"St. Mark's Maternity Hospital (SMMH)","Military Hospital","Port Hospital","Central Hospital","Military Hospital","Central Hospital",null,"Military Hospital","Other",null,null,"Port Hospital","Port Hospital","Port Hospital",null,"Central Hospital","Military Hospital","Other","Other","Other",null,"St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)",null],[-13.2157351064963,-13.2152339775486,-13.212910703914,-13.2363711169728,-13.2228638912441,-13.222625321098,-13.2331547837254,-13.2320975453153,-13.2225511595637,-13.2572163655863,-13.2206286746001,-13.253989309478,-13.2385127873491,-13.209391925612,-13.2157278814899,-13.2243437095992,-13.2336087079551,-13.21422143145,-13.2339681355349,-13.2535640411465,-13.2250089377786,-13.2160657166043,-13.2680671272333,-13.2266742923612,-13.2160179088168,-13.2482584611565,-13.2156319199566,-13.2142410663192,-13.2614879104088,-13.2452992638476,-13.2630592726116,-13.2343341712241,-13.2199077448676,-13.2227293309912,-13.2343062806506,-13.218781651651,-13.2483677722899,-13.2097478342339,-13.2680867723786,-13.2587535457526,-13.262635786914,-13.2697246824573,-13.2209026809759,-13.2330734719715,-13.2680923666905,-13.2547212675054,-13.2573683214693,-13.2137356012883,-13.2175973322257,-13.2486407324245],[8.46897295100924,8.45171855856465,8.46481700596819,8.4754761613651,8.46082377490923,8.46183062600728,8.46272931462646,8.46144367534271,8.46191259217774,8.47292327643506,8.48401630165138,8.45837125340844,8.47761705512509,8.47570184950483,8.47779946878972,8.47145134147474,8.47804840685363,8.48528034195779,8.46957530395867,8.45957352078114,8.47404889511544,8.48802917129884,8.473437335922,8.48408263734462,8.46242233645879,8.47026822126572,8.46398447480533,8.4641347894342,8.45623094629607,8.48334624336805,8.47493999153642,8.47832062438022,8.4693933891765,8.48480589906514,8.47121232619015,8.48438437371817,8.48466158574339,8.47714159984428,8.46238127010609,8.45568597813113,8.4632880274758,8.47940722413856,8.46353857052336,8.46178968158864,8.47508713872833,8.45825808128071,8.4532568143863,8.4732571907655,8.47911586641933,8.48480340615605],["f547d6",null,null,"f90f5f","11f8ea","aec8ec","893f25","133ee7",null,null,"996f3a","133ee7","37a6f6","9f6884","4802b1",null,null,null,"a75c7f","8e104d","ab634e",null,null,"b799eb",null,"5d9e4d","a15e13",null,"ea3740","beb26e","567136","894024","36e2e7","a2086d","7baf73","eb2277",null,null,"d6584f",null,"312ecf","52ea64","cfd79c","d145b7","174288",null,"53608c","3b096b","f5c142",null],["other",null,null,"other","other","other","other","other",null,null,"other","other","other","other","other",null,null,null,"other","other","other",null,null,"other",null,"other","other",null,"other","funeral","other","funeral","other","other","other","funeral",null,null,"other",null,"other","other","other","other","other",null,"funeral","other","other",null],[2,3,56,18,3,16,16,0,61,27,12,42,19,7,7,13,35,17,11,11,19,54,14,28,6,3,31,6,67,14,10,21,20,45,1,12,3,15,20,36,7,13,14,3,10,1,0,20,26,14],["years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years"],[27,25,91,41,36,56,47,0,86,69,67,84,68,44,34,66,78,47,53,47,71,86,53,69,38,46,68,37,100,56,50,57,65,72,29,69,37,48,54,71,47,61,47,35,53,16,13,59,69,67],[48,59,238,135,71,116,87,11,226,174,112,186,174,90,91,152,214,137,117,131,150,241,131,161,80,69,188,66,233,142,110,182,164,214,26,157,39,154,133,168,100,125,123,67,134,31,36,125,183,169],[22,22,21,23,23,21,21,22,22,22,22,22,22,21,23,22,23,21,22,23,21,23,21,24,23,22,24,23,20,24,24,20,24,21,22,21,23,22,23,23,23,22,23,22,22,22,23,22,22,22],["0",null,null,"0","0","0",null,"0","0","0","0","0","0","0","0","0","0","0",null,"0","0","0","0","0",null,"0","0","0",null,null,"0","0",null,"0","0",null,null,"0","0",null,"0","0",null,"0","0","0","0","0","0",null],["0",null,null,"0","0","0",null,"0","0","0","0","0","0","0","0","0","1","0",null,"0","0","0","1","0",null,"0","0","1",null,null,"0","0",null,"0","0",null,null,"0","0",null,"0","0",null,"0","1","0","0","0","0",null],["1",null,null,"0","1","1",null,"1","1","1","1","1","1","1","1","1","1","1",null,"1","1","1","1","1",null,"1","1","1",null,null,"1","1",null,"1","1",null,null,"1","1",null,"1","1",null,"1","1","1","1","1","0",null],["0",null,null,"0","0","0",null,"0","0","0","0","0","0","0","0","1","0","0",null,"0","0","0","0","0",null,"0","0","0",null,null,"0","0",null,"0","0",null,null,"1","1",null,"0","0",null,"0","0","0","0","0","0",null],["1",null,null,"0","1","1",null,"1","1","0","1","0","0","0","1","0","0","0",null,"0","1","0","0","0",null,"0","0","0",null,null,"0","1",null,"1","1",null,null,"1","1",null,"1","1",null,"1","1","0","1","1","1",null],[36.8,36.9,36.9,36.8,36.9,37.6,37.3,37,36.4,35.9,36.5,36.9,36.5,37.1,36.5,37.3,37,38,38,36,37,36.7,36.9,36.5,37,36.5,37.6,36.6,36.6,36.2,36.4,37.1,37.5,37.5,37.4,36.9,36.4,37.3,37,37.8,36.5,37.5,36.7,37,37.3,36.6,36.5,36.6,37.6,36.8],[null,"09:36","16:48","11:22","12:60","14:13","14:33","09:25","11:16","10:55","16:03","11:14","12:42","11:06","09:10","08:45",null,"15:41","13:34","18:58","12:43","16:33","14:29","07:18","08:11","16:32","16:17","07:32","17:45",null,"13:24","14:43","02:33","11:36","17:28","16:27",null,"20:49",null,"11:38","14:25","13:42","21:22","13:33","19:06","17:14","20:09",null,"10:23","09:09"],[117.1875,71.8184429761563,16.0652496292635,22.4965706447188,71.4144019043841,41.6171224732461,62.0953890870657,0,16.8376536925366,22.7903289734443,53.4119897959184,24.2802636142907,22.4600343506408,54.320987654321,41.0578432556455,28.5664819944598,17.0320552013276,25.0412914912888,38.7172182043977,27.3876813705495,31.5555555555556,14.8069075945662,30.8839811199813,26.6193433895297,59.375,96.6183574879227,19.2394748755093,84.9403122130395,18.4199377406104,27.7722674072605,41.3223140495868,17.2080666586161,24.1671624033314,15.7218971089178,428.994082840237,27.9930220292912,243.261012491782,20.2395007589813,30.527446435638,25.15589569161,47,39.04,31.0661643201798,77.9683671196257,29.5165961238583,166.493236212279,100.308641975309,37.76,20.6037803457852,23.458562375267],[2,3,56,18,3,16,16,0,61,27,12,42,19,7,7,13,35,17,11,11,19,54,14,28,6,3,31,6,67,14,10,21,20,45,1,12,3,15,20,36,7,13,14,3,10,1,0,20,26,14]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>generation<\/th>\n      <th>date_infection<\/th>\n      <th>date_onset<\/th>\n      <th>date_hospitalisation<\/th>\n      <th>date_outcome<\/th>\n      <th>outcome<\/th>\n      <th>gender<\/th>\n      <th>hospital<\/th>\n      <th>lon<\/th>\n      <th>lat<\/th>\n      <th>infector<\/th>\n      <th>source<\/th>\n      <th>age<\/th>\n      <th>age_unit<\/th>\n      <th>wt_kg<\/th>\n      <th>ht_cm<\/th>\n      <th>ct_blood<\/th>\n      <th>fever<\/th>\n      <th>chills<\/th>\n      <th>cough<\/th>\n      <th>aches<\/th>\n      <th>vomit<\/th>\n      <th>temp<\/th>\n      <th>time_admission<\/th>\n      <th>bmi<\/th>\n      <th>age_years<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,9,10,13,15,16,17,23,25,26]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Цэвэрлэгээний тольтой хүснэгтийн баганын нэрс таны одоо бичиж буй коммандны скрипттэй яг таарч байх шаардлагатайг анхаарна уу. Энэ талаар <a href="https://www.repidemicsconsortium.org/linelist/reference/clean_data.html">online reference for the linelist package</a> -ээс харна уу.</p>
<div id="цэвэрлэх-pipe-холбоосонд-залгах" class="section level4 unnumbered">
<h4>Цэвэрлэх pipe холбоосонд залгах<a class="anchor" aria-label="anchor" href="#%D1%86%D1%8D%D0%B2%D1%8D%D1%80%D0%BB%D1%8D%D1%85-pipe-%D1%85%D0%BE%D0%BB%D0%B1%D0%BE%D0%BE%D1%81%D0%BE%D0%BD%D0%B4-%D0%B7%D0%B0%D0%BB%D0%B3%D0%B0%D1%85"><i class="fas fa-link"></i></a>
</h4>
<p><strong>Доорхи pipe холбоосонд багана нэмэх, баганын хувиргах үйлдлүүд залгагдсан.</strong></p>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ЦЭВЭРЛЭХ 'PIPE' ХОЛБООС (түүхий датаг үе шаттайгаар дамжуулан цэвэрлэдэг холбоос)</span>
<span class="co">##################################################################################</span>

<span class="co"># Цэвэрлэх холбоосыг эхлэх</span>
<span class="co">###########################</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    
    <span class="co"># баганын нэрсийг жигдрүүлэх</span>
    <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    
    <span class="co"># зарим баганын нэрийг гараар өөрчил</span>
            <span class="co"># ШИНЭ нэр             # ХУУЧИН нэр</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>date_infection       <span class="op">=</span> <span class="va">infection_date</span>,
           date_hospitalisation <span class="op">=</span> <span class="va">hosp_date</span>,
           date_outcome         <span class="op">=</span> <span class="va">date_of_outcome</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    
    <span class="co"># баганыг хас</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">row_num</span>, <span class="va">merged_header</span>, <span class="va">x28</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 

    <span class="co"># давхардалтыг арилга</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  
    <span class="co"># Шинэ багана нэм</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>bmi <span class="op">=</span> <span class="va">wt_kg</span> <span class="op">/</span> <span class="op">(</span><span class="va">ht_cm</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  
    <span class="co"># баганын төрлийг хувирга</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"date"</span><span class="op">)</span>, <span class="va">as.Date</span><span class="op">)</span>, 
           generation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">generation</span><span class="op">)</span>,
           age        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> |&gt; 
    
    <span class="co"># багана нэм: эмнэлэгт хожуу ирэлт</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>days_onset_hosp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">date_hospitalisation</span> <span class="op">-</span> <span class="va">date_onset</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    
   <span class="co"># ЭНЭ ХҮРТЭЛХ ҮЙЛДЭЛ ӨМНӨХ ХЭСЭГТ ХЭЛЦЭГДСЭН</span>
   <span class="co">###################################################</span>

    <span class="co"># эмнэлэгийн баганууддах утгыг цэвэрлэх</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>hospital <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">hospital</span>,
                      <span class="co"># ХУУЧИН = ШИНЭ</span>
                      <span class="st">"Mitylira Hopital"</span>  <span class="op">=</span> <span class="st">"Military Hospital"</span>,
                      <span class="st">"Mitylira Hospital"</span> <span class="op">=</span> <span class="st">"Military Hospital"</span>,
                      <span class="st">"Military Hopital"</span>  <span class="op">=</span> <span class="st">"Military Hospital"</span>,
                      <span class="st">"Port Hopital"</span>      <span class="op">=</span> <span class="st">"Port Hospital"</span>,
                      <span class="st">"Central Hopital"</span>   <span class="op">=</span> <span class="st">"Central Hospital"</span>,
                      <span class="st">"other"</span>             <span class="op">=</span> <span class="st">"Other"</span>,
                      <span class="st">"St. Marks Maternity Hopital (SMMH)"</span> <span class="op">=</span> <span class="st">"St. Mark's Maternity Hospital (SMMH)"</span>
                      <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>hospital <span class="op">=</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na</a></span><span class="op">(</span><span class="va">hospital</span>, <span class="st">"Missing"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 

    <span class="co"># age_years баганыг үүсгэ (age болон age_unit баганыг ашиглаж)</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age_years <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
          <span class="va">age_unit</span> <span class="op">==</span> <span class="st">"years"</span> <span class="op">~</span> <span class="va">age</span>,
          <span class="va">age_unit</span> <span class="op">==</span> <span class="st">"months"</span> <span class="op">~</span> <span class="va">age</span><span class="op">/</span><span class="fl">12</span>,
          <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">age_unit</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span>,
          <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_real_</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
<!-- ======================================================= -->
<!-- ======================================================= -->
</div>
</div>
</div>
<div id="num_cats" class="section level2" number="8.9">
<h2>
<span class="header-section-number">8.9</span> Тоог ангилах<a class="anchor" aria-label="anchor" href="#num_cats"><i class="fas fa-link"></i></a>
</h2>
<p>Энэ хэсэгт numeric баганаас хэрхэн categorical (ангилсан) утгатай багана үүсгэх талаар үзнэ. Тоон (numeric) ангилалын жишээнд насны ангилал, шинжилгээний үзүүлэлтийн ангилал зэрэг орно. Гол хэрэглэгдэх функцууд:</p>
<ul>
<li>
<strong>epikit</strong> багцын <code>age_categories()</code><br>
</li>
<li>
<strong>base R -ын</strong> <code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code><br>
</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code><br>
</li>
<li>
<code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/ranking.html">ntile()</a></code>зэрэг кванталууд</li>
</ul>
<div id="тархалтыг-шалгах" class="section level3 unnumbered">
<h3>Тархалтыг шалгах<a class="anchor" aria-label="anchor" href="#%D1%82%D0%B0%D1%80%D1%85%D0%B0%D0%BB%D1%82%D1%8B%D0%B3-%D1%88%D0%B0%D0%BB%D0%B3%D0%B0%D1%85"><i class="fas fa-link"></i></a>
</h3>
<p>Жишээнд <code>age_years</code> баганыг ашиглаж <code>age_cat</code> баганыг үүсгэх болно.</p>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># linelist -хүснэгт дэх нас заасан баганын дата төрлийг тогтоох</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age_years</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "numeric"</code></pre>
<p>Эхлээд датаны тархалтын дүрсийг шалгаж хуваах цэгүүдээ (cut-points) тогтооно. [ggplot basics] хэсгээс дэлгэрүүлж харна уу.</p>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># тархалтын дүрсийг шалга</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age_years</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-214-1.png" width="672" height="50%"></div>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age_years</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##    0.00    6.00   13.00   16.04   23.00   84.00     107</code></pre>
<p><span style="color: orange;"><strong><em>АНХААРУУЛГА</em></strong> Заримдаа тоон хувьсагч нар “character” хэлбэрээр импортлогдох тохиолдол байдаг. Энэ нь тухайн хувьсагчын аль нэг утганд тоон биш тэмдэгт агуулагдсан байснаас болдог. Жишээ нь нас заасан баганад “2 сар” (2 months) гэж бичигдэх, бутархай тоонд цэг биш таслал тавигдах тохиолдлууд байдаг (“4,5” -аар дөрөв аравны тав гэсэн санаа илэрхийлсэн байх).</span></p>
<!-- ======================================================= -->
</div>
<div id="age_categories" class="section level3 unnumbered">
<h3>
<code>age_categories()</code><a class="anchor" aria-label="anchor" href="#age_categories"><i class="fas fa-link"></i></a>
</h3>
<p>Тоон баганын утгад ангилалал үүсгэх бол <strong>epikit</strong> багцын <code>age_categories()</code> -ыг хэрэглэвэл хялбар (тэмдэглэл: энэхүү функцыг тоон биш хувьсагчид хэрэглэж бас болдог ). Ингэснээр үүссэн багана нь автоматаар эрэмбэлэгдсэн (ordered) factor болдог ач холбогдолтой.</p>
<p>Шаардлагатай оролтууд:</p>
<ul>
<li>Тоон вектор (багана)<br>
</li>
<li>
<code>breakers =</code> аргумент - шинэ үүсэх ангиллын хуваагдах цэгүүдийг заасан тоон векторуудыг оруулна.</li>
</ul>
<p>Эхлээд энгийн жишээ авч үзье:</p>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Энгийн жишээ</span>
<span class="co">################</span>
<span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">epikit</span><span class="op">)</span>                    <span class="co"># багцыг ачаалла</span>

<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    age_cat <span class="op">=</span> <span class="fu">age_categories</span><span class="op">(</span>             <span class="co"># багана үүсгэ</span>
      <span class="va">age_years</span>,                            <span class="co"># шинэ багана үүсгэхэд ашиглах numeric багана</span>
      breakers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span>,        <span class="co"># хуваагдах цэгүүд</span>
                   <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">60</span>, <span class="fl">70</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># хүснэгтийг харуул</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age_cat</span>, useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##   0-4   5-9 10-14 15-19 20-29 30-39 40-49 50-59 60-69   70+  &lt;NA&gt; 
##  1227  1223  1048   827  1216   597   251    78    27     7   107</code></pre>
<p>The break values you specify are by default the lower bounds - that is, they are included in the “higher” group / the groups are “open” on the lower/left side. As shown below, you can add 1 to each break value to achieve groups that are open at the top/right.</p>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># дээд хязгаарыг ижилхэн ангилалд оруулж байна</span>
<span class="co">############################################</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    age_cat <span class="op">=</span> <span class="fu">age_categories</span><span class="op">(</span>
      <span class="va">age_years</span>, 
      breakers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span>, <span class="fl">11</span>, <span class="fl">16</span>, <span class="fl">21</span>, <span class="fl">31</span>, <span class="fl">41</span>, <span class="fl">51</span>, <span class="fl">61</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># хүснэгтийг харуул</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age_cat</span>, useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##   0-5  6-10 11-15 16-20 21-30 31-40 41-50 51-60 61-70   71+  &lt;NA&gt; 
##  1469  1195  1040   770  1149   547   231    70    24     6   107</code></pre>
<p>Ангиллын нэрсийг <code>separator =</code> аргументээр тохируулж болно. Default тэмдэг нь “-”.</p>
<p>Тоон утгын дээд хязгаарыг хэрхэхийг <code>ceiling =</code>аргументээр тохируулна. Дээд хязгаар тогтоох бол <code>ceiling = TRUE</code>гэж өгнө. Ингэснээр хамгийн дээд тогтоосон тоогоор ангилал дуусч “XX+” гэсэн ангилал үүсэхгүй. Энэхүү зааж өгсөн дээд хязгаараас их (эсвэл <code>upper =</code> -т зааж өгсөн) ямар ч тоо <code>NA</code> ангилалд орно. Доор жишээнд <code>ceiling = TRUE</code> гэж өгсөн тул XX+ ангилал үүсэхгүй, 70 -аас дээш (зааж өгсөн хамгийн дээд хязгаар) тоо <code>NA</code> болж хувирсан.</p>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ceiling аргументийг TRUE дээр тохируулсан</span>
<span class="co">##########################</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    age_cat <span class="op">=</span> <span class="fu">age_categories</span><span class="op">(</span>
      <span class="va">age_years</span>, 
      breakers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">60</span>, <span class="fl">70</span><span class="op">)</span>,
      ceiling <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="co"># 70 бол дээд хязгаар ба үүнээс дээш тоо NA болно</span>

<span class="co"># хүснэгтийг харуул</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age_cat</span>, useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##   0-4   5-9 10-14 15-19 20-29 30-39 40-49 50-59 60-70  &lt;NA&gt; 
##  1227  1223  1048   827  1216   597   251    78    28   113</code></pre>
<p>Мөн <code>breakers =</code> аргументийн оронд та өөрөө <code>lower =</code>, <code>upper =</code>, <code>by =</code> гэсэн аргументуудэд хуваах цэгүүдтэы тоон дарааллыг оруулж өгч болно:</p>
<ul>
<li>
<code>lower =</code> таны зааж өгсөн хамгийн бага тоо - default нь 0<br>
</li>
<li>
<code>upper =</code> таны зааж өгсөн хамгийн их тоо<br>
</li>
<li>
<code>by =</code> ангилал хоорондын интервал</li>
</ul>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    age_cat <span class="op">=</span> <span class="fu">age_categories</span><span class="op">(</span>
      <span class="va">age_years</span>, 
      lower <span class="op">=</span> <span class="fl">0</span>,
      upper <span class="op">=</span> <span class="fl">100</span>,
      by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span>

<span class="co"># хүснэгтийг харуул</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age_cat</span>, useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##   0-9 10-19 20-29 30-39 40-49 50-59 60-69 70-79 80-89 90-99  100+  &lt;NA&gt; 
##  2450  1875  1216   597   251    78    27     6     1     0     0   107</code></pre>
<p>энэ функцын Help хуудаснаас нэмэлт мэдээллийг үзэж болно (R console-д <code>?age_categories</code> гэсэн коммандаар гаргана).</p>
<!-- ======================================================= -->
</div>
<div id="cut" class="section level3 unnumbered">
<h3>
<code>cut()</code><a class="anchor" aria-label="anchor" href="#cut"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code> бол <strong>base</strong> R -д багтдаг <code>age_categories()</code> -тай адил үйлдэлтэй функц. Гэвч <code>age_categories()</code> дээр ажиллахад илүү хялбар. <code>age_categories()</code> -аас гол ялгаатай шинжүүд:</p>
<ul>
<li>Өөр багц суулгаж/уншуулах шаардлагагүй.<br>
</li>
<li>Ангилал баруун/зүүн талруугаа нээлттэй/хаалттай эсэхийг зааж өгч болно.<br>
</li>
<li>Ангиллын нэрсийг та өөрөө оруулж өгнө.<br>
</li>
<li>Хамгийн бага ангилалдаа 0-г оруулах бол өөрөө зааж өгөх шаардлагатай.</li>
</ul>
<p><code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code> дотор эхлээд ангилах гэж буй numeric баганаа (<code>age_years</code>) оруулаад, хуваах цэгүүдээ <code>breaks=</code>аргументэд тоон вектор хэлбэрээр <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> -д оруулна. <code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code> -аар үүсгэгдсэн багана эрэмбэлэгдсэн factor төрөл болдог.</p>
<p>Default-аар баруун/дээд тал “нээлттэй” (зүүн/доод тал нь “хаалттай” ) байдаг. Энэ нь <code>age_categories()</code> функцэд эсрэгээрээ хийгддэг. Default тэмдэглэгээ нь “(A, B]” бөгөөд энэ нь A ороогүй B орсон гэсэн утгатай. <strong>Үүний эсрэг хийх бол <code>right = TRUE</code> гэж зааж өгнө.</strong></p>
<p>Үүнээс болоод хамгийн бага тоотой ангилалд default -аар “0” ордоггүй ба “0” утга <code>NA</code> болж хувирдаг. Гэтэл зарим тохиолдолд тухайлбал нярай хүүхдүүдийн нас 0 гэж кодлогддог зэргийг анхаарч байх шаардлагатай. Үүнийг өөрчлөхийн тулд <code>include.lowest = TRUE</code> гэсэн аргументийг нэмснээр “0” утга хамгийн бага тоотой ангилалд багтдаг. Автоматаар үүссэн ангиллын нэр хамгийн бага ангилалд “[A],B]” болдог. Note that if you include the <code>include.lowest = TRUE</code> argument <strong>and</strong> <code>right = TRUE</code>, the extreme inclusion will now apply to the <em>highest</em> break point value and category, not the lowest.</p>
<p>Үүсгэсэн ангилалд нэр өгөхдөө <code>labels =</code> аргументэд оруулна. Гараар бичигдэх тул алдаа гаргахаас сэргийлээрэй! Cross-tabulation (солбисон хүснэгт) ашиглаж алдаагаа шалгаарай</p>
<p><code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code> ашиглаж <code>age_years</code> баганаас <code>age_cat</code> гэсэн шинэ багана үүсгэх жишээг дор харуулав:</p>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Тоон age хувьсагчийг хувааж, ангилагдсан багана үүсгэ</span>
<span class="co"># Ангиллын доод хязгаар нь битүү харин дээд хязгаар нь нээллттэй байна.</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    age_cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span>
      <span class="va">age_years</span>,
      breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span>,
                 <span class="fl">30</span>, <span class="fl">50</span>, <span class="fl">70</span>, <span class="fl">100</span><span class="op">)</span>,
      include.lowest <span class="op">=</span> <span class="cn">TRUE</span>         <span class="co"># 0 -г доод ангиолд багтаа</span>
      <span class="op">)</span><span class="op">)</span>

<span class="co"># ангилал тус бүр дэх ажиглалтын тоог жагсааж хар</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age_cat</span>, useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##    [0,5]   (5,10]  (10,15]  (15,20]  (20,30]  (30,50]  (50,70] (70,100] 
##     1469     1195     1040      770     1149      778       94        6 
##     &lt;NA&gt; 
##      107</code></pre>
<p><strong>Хийсэн ажлаа шалга!!!</strong> Насны тоон үзүүлэлтүүд зөв ангилалдаа орсон эсэхийг тоон болон ангилагдсан багануудыг солбиж харуулсан хүснэгтээр шалга. Ялангуяа захын утгуудыг шалгаарай (жишээ нь 15- ын тоо 10-15, 16-20 гэсэн ангилалуудын ойролцоо байгаа эсэх).</p>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Тоон болон ангилагдсан баганыг солбиж харуулсан хүснэгт</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="st">"Numeric Values"</span> <span class="op">=</span> <span class="va">linelist</span><span class="op">$</span><span class="va">age_years</span>,   <span class="co"># ойлгомжтой болгох үүднээс багануудад нэр өгсөн</span>
      <span class="st">"Categories"</span>     <span class="op">=</span> <span class="va">linelist</span><span class="op">$</span><span class="va">age_cat</span>,
      useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span>                        <span class="co"># NA утгуудыг шалгахаа бүү мартаарай</span></code></pre></div>
<pre><code>##                     Categories
## Numeric Values       [0,5] (5,10] (10,15] (15,20] (20,30] (30,50] (50,70]
##   0                    136      0       0       0       0       0       0
##   0.0833333333333333     1      0       0       0       0       0       0
##   0.25                   2      0       0       0       0       0       0
##   0.333333333333333      6      0       0       0       0       0       0
##   0.416666666666667      1      0       0       0       0       0       0
##   0.5                    6      0       0       0       0       0       0
##   0.583333333333333      3      0       0       0       0       0       0
##   0.666666666666667      3      0       0       0       0       0       0
##   0.75                   3      0       0       0       0       0       0
##   0.833333333333333      1      0       0       0       0       0       0
##   0.916666666666667      1      0       0       0       0       0       0
##   1                    275      0       0       0       0       0       0
##   1.5                    2      0       0       0       0       0       0
##   2                    308      0       0       0       0       0       0
##   3                    246      0       0       0       0       0       0
##   4                    233      0       0       0       0       0       0
##   5                    242      0       0       0       0       0       0
##   6                      0    241       0       0       0       0       0
##   7                      0    256       0       0       0       0       0
##   8                      0    239       0       0       0       0       0
##   9                      0    245       0       0       0       0       0
##   10                     0    214       0       0       0       0       0
##   11                     0      0     220       0       0       0       0
##   12                     0      0     224       0       0       0       0
##   13                     0      0     191       0       0       0       0
##   14                     0      0     199       0       0       0       0
##   15                     0      0     206       0       0       0       0
##   16                     0      0       0     186       0       0       0
##   17                     0      0       0     164       0       0       0
##   18                     0      0       0     141       0       0       0
##   19                     0      0       0     130       0       0       0
##   20                     0      0       0     149       0       0       0
##   21                     0      0       0       0     158       0       0
##   22                     0      0       0       0     149       0       0
##   23                     0      0       0       0     125       0       0
##   24                     0      0       0       0     144       0       0
##   25                     0      0       0       0     107       0       0
##   26                     0      0       0       0     100       0       0
##   27                     0      0       0       0     117       0       0
##   28                     0      0       0       0      85       0       0
##   29                     0      0       0       0      82       0       0
##   30                     0      0       0       0      82       0       0
##   31                     0      0       0       0       0      68       0
##   32                     0      0       0       0       0      84       0
##   33                     0      0       0       0       0      78       0
##   34                     0      0       0       0       0      58       0
##   35                     0      0       0       0       0      58       0
##   36                     0      0       0       0       0      33       0
##   37                     0      0       0       0       0      46       0
##   38                     0      0       0       0       0      45       0
##   39                     0      0       0       0       0      45       0
##   40                     0      0       0       0       0      32       0
##   41                     0      0       0       0       0      34       0
##   42                     0      0       0       0       0      26       0
##   43                     0      0       0       0       0      31       0
##   44                     0      0       0       0       0      24       0
##   45                     0      0       0       0       0      27       0
##   46                     0      0       0       0       0      25       0
##   47                     0      0       0       0       0      16       0
##   48                     0      0       0       0       0      21       0
##   49                     0      0       0       0       0      15       0
##   50                     0      0       0       0       0      12       0
##   51                     0      0       0       0       0       0      13
##   52                     0      0       0       0       0       0       7
##   53                     0      0       0       0       0       0       4
##   54                     0      0       0       0       0       0       6
##   55                     0      0       0       0       0       0       9
##   56                     0      0       0       0       0       0       7
##   57                     0      0       0       0       0       0       9
##   58                     0      0       0       0       0       0       6
##   59                     0      0       0       0       0       0       5
##   60                     0      0       0       0       0       0       4
##   61                     0      0       0       0       0       0       2
##   62                     0      0       0       0       0       0       1
##   63                     0      0       0       0       0       0       5
##   64                     0      0       0       0       0       0       1
##   65                     0      0       0       0       0       0       5
##   66                     0      0       0       0       0       0       3
##   67                     0      0       0       0       0       0       2
##   68                     0      0       0       0       0       0       1
##   69                     0      0       0       0       0       0       3
##   70                     0      0       0       0       0       0       1
##   72                     0      0       0       0       0       0       0
##   73                     0      0       0       0       0       0       0
##   76                     0      0       0       0       0       0       0
##   84                     0      0       0       0       0       0       0
##   &lt;NA&gt;                   0      0       0       0       0       0       0
##                     Categories
## Numeric Values       (70,100] &lt;NA&gt;
##   0                         0    0
##   0.0833333333333333        0    0
##   0.25                      0    0
##   0.333333333333333         0    0
##   0.416666666666667         0    0
##   0.5                       0    0
##   0.583333333333333         0    0
##   0.666666666666667         0    0
##   0.75                      0    0
##   0.833333333333333         0    0
##   0.916666666666667         0    0
##   1                         0    0
##   1.5                       0    0
##   2                         0    0
##   3                         0    0
##   4                         0    0
##   5                         0    0
##   6                         0    0
##   7                         0    0
##   8                         0    0
##   9                         0    0
##   10                        0    0
##   11                        0    0
##   12                        0    0
##   13                        0    0
##   14                        0    0
##   15                        0    0
##   16                        0    0
##   17                        0    0
##   18                        0    0
##   19                        0    0
##   20                        0    0
##   21                        0    0
##   22                        0    0
##   23                        0    0
##   24                        0    0
##   25                        0    0
##   26                        0    0
##   27                        0    0
##   28                        0    0
##   29                        0    0
##   30                        0    0
##   31                        0    0
##   32                        0    0
##   33                        0    0
##   34                        0    0
##   35                        0    0
##   36                        0    0
##   37                        0    0
##   38                        0    0
##   39                        0    0
##   40                        0    0
##   41                        0    0
##   42                        0    0
##   43                        0    0
##   44                        0    0
##   45                        0    0
##   46                        0    0
##   47                        0    0
##   48                        0    0
##   49                        0    0
##   50                        0    0
##   51                        0    0
##   52                        0    0
##   53                        0    0
##   54                        0    0
##   55                        0    0
##   56                        0    0
##   57                        0    0
##   58                        0    0
##   59                        0    0
##   60                        0    0
##   61                        0    0
##   62                        0    0
##   63                        0    0
##   64                        0    0
##   65                        0    0
##   66                        0    0
##   67                        0    0
##   68                        0    0
##   69                        0    0
##   70                        0    0
##   72                        1    0
##   73                        3    0
##   76                        1    0
##   84                        1    0
##   &lt;NA&gt;                      0  107</code></pre>
<p><strong><code>NA</code> утгуудад дахин нэр өгөх</strong></p>
<p><code>NA</code> -утгуудыг “Missing” гэсэн нэртэй ангилалд оруулж болно. Шинээр үүсэх багана factor учир (хязгаарлагдмал утгууд) шууд <code><a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na()</a></code> аар хувиргалт хийх боломжгүй. [Factors] хэсэгт тайлбарсанчлан <strong>forcats</strong> багцын <code><a href="https://forcats.tidyverse.org/reference/fct_explicit_na.html">fct_explicit_na()</a></code> функцыг хэрэглээрэй.</p>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  
  <span class="co"># cut() -аар age_cat-ыг үүсгэнэ. Factor төрлийн багана үүснэ.     </span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age_cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span>
    <span class="va">age_years</span>,
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">50</span>, <span class="fl">70</span>, <span class="fl">100</span><span class="op">)</span>,          
    right <span class="op">=</span> <span class="cn">FALSE</span>,
    include.lowest <span class="op">=</span> <span class="cn">TRUE</span>,        
    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0-4"</span>, <span class="st">"5-9"</span>, <span class="st">"10-14"</span>, <span class="st">"15-19"</span>, <span class="st">"20-29"</span>, <span class="st">"30-49"</span>, <span class="st">"50-69"</span>, <span class="st">"70-100"</span><span class="op">)</span><span class="op">)</span>,
         
    <span class="co"># Дутуу утгыг тодорхой болго</span>
    age_cat <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_explicit_na.html">fct_explicit_na</a></span><span class="op">(</span>
      <span class="va">age_cat</span>,
      na_level <span class="op">=</span> <span class="st">"Missing age"</span><span class="op">)</span>  <span class="co"># нэрийг өөрөө өгч болно</span>
  <span class="op">)</span>    

<span class="co"># ангилал тус бүр дэх ажиглалтын тоог харуулсан хүснэгт</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age_cat</span>, useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##         0-4         5-9       10-14       15-19       20-29       30-49 
##        1227        1223        1048         827        1216         848 
##       50-69      70-100 Missing age        &lt;NA&gt; 
##         105           7         107           0</code></pre>
<p><strong>Хуваах, нэрлэх үйлдлийг хялбарчлах</strong></p>
<p>Аливаа векторыг түргэн хугацаанд хувааж, нэр өгөх жишээг дор харуулав. [R basics] хэсгийн <code><a href="https://rdrr.io/r/base/seq.html">seq()</a></code>, <code><a href="https://rdrr.io/r/base/rep.html">rep()</a></code> -ийн тайлбараас нэмж үзэж болно.</p>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#  0 -ээс 90 хүртэлх тоог 5 аар хуваасан цэгүүд үүсгэ. </span>
<span class="va">age_seq</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">90</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="va">age_seq</span>

<span class="co"># Дээрх үүссэн ангиллуудад нэр өг (cut() default тохируулгатай)</span>
<span class="va">age_labels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">age_seq</span> <span class="op">+</span> <span class="fl">1</span>, <span class="st">"-"</span>, <span class="va">age_seq</span> <span class="op">+</span> <span class="fl">5</span><span class="op">)</span>
<span class="va">age_labels</span>

<span class="co"># ажиглалтын тоо хоёр векторт адилхан байна</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">age_seq</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">age_labels</span><span class="op">)</span></code></pre></div>
<p><code><a href="https://rdrr.io/r/base/cut.html">?cut</a></code> коммандыг R console -д өгч <code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code> функцын Help хуудаснаас нэмж тодруулж болно.</p>
</div>
<div id="квантил-хуваагдлууд" class="section level3 unnumbered">
<h3>Квантил хуваагдлууд<a class="anchor" aria-label="anchor" href="#%D0%BA%D0%B2%D0%B0%D0%BD%D1%82%D0%B8%D0%BB-%D1%85%D1%83%D0%B2%D0%B0%D0%B0%D0%B3%D0%B4%D0%BB%D1%83%D1%83%D0%B4"><i class="fas fa-link"></i></a>
</h3>
<p>In common understanding, “quantiles” or “percentiles” typically refer to a value below which a proportion of values fall. Жишээ нь, <code>linelist</code> -ийн нас заасан баганын 95 дах персентил гэдэг нь нас заасан бүх утгын 95% нь орж буй утгуудыг хэлнэ.</p>
<p>Ердийн хэллэгт “квантил”, “децил” гэдэг нь аливаа датаг 4 эсвэл 10 тэнцүү хуваахыг хэлдэг (хуваасан тооноос нэг илүү ангилал үүсэхийг анхаараарай).</p>
<p>Квантилаар хуваахдаа <strong>base</strong> R-ын <strong>stats</strong> багц дах <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code> функцыг ашигладаг. Та тоон вектор болон 0-оос 1 хүртэлх магадлал оноогдсон векторыг (ж: нэг баганадах тоо) оруулж өгнө. Эдгээр нь тоон векторууд юм. Энэ функцын статистикийн аргачлалын талаар <code><a href="https://rdrr.io/r/stats/quantile.html">?quantile</a></code>комманд өгч уншна уу.</p>
<ul>
<li>хэрэв таны оруулсан тоон вектор дутуу утгатай бол <code>na.rm = TRUE</code> гэж тохируулах хэрэгтэй.<br>
</li>
<li>
<code>names = FALSE</code> гэж тохируулснаар нэрлэгдээгүй тоон векторыг гаргаж ирнэ.</li>
</ul>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age_years</span>,               <span class="co"># ажиллах гэж буй тоон вектороо зааж өгнө</span>
  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.25</span>, <span class="fl">.50</span>, <span class="fl">.75</span>, <span class="fl">.90</span>, <span class="fl">.95</span><span class="op">)</span>,   <span class="co"># персентилээ зааж өгнө</span>
  na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>                            <span class="co"># дутуу утгыг үл тоох </span></code></pre></div>
<pre><code>##  0% 25% 50% 75% 90% 95% 
##   0   6  13  23  33  41</code></pre>
<p><code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code> -аар бодогдсон хуваагдах цэгүүдээ <code>age_categories()</code>, <code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code> функцын оролтод оруулж болно. Дор жишээнд <code>age_years</code> багана дах утгыг <code>quantiles()</code> -д өгч хуваагдах цэгүүдийг бодож гарган <code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code> коммандад өгснөөр <code>deciles</code> баганыг үүсгэж буй жишээг харуулав. Гарсан үр дүнгийн хувийг <strong>janitor</strong> багцын <code>tabyl()</code> функцийг ашиглаж харуулав ( [Descriptive tables] хуудсаас харна уу). Ангилалууд яг тэнцүү 10% -аар хуваагдаагүйг ажиглаарай.</p>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                                <span class="co"># linelist-ээс эхэл</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>deciles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">age_years</span>,           <span class="co"># cut()-аар age_years баганасс decile баганыг үүсгэ</span>
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span>                      <span class="co"># quantile()-аар хуваагдах цэгүүдийг тодорхойл</span>
      <span class="va">age_years</span>,                               <span class="co"># age_years дээр хэрэгжүүл</span>
      probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,             <span class="co"># 0.0 -ээс 1.0 -ыг 0.1 -ээр хуваа</span>
      na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,                           <span class="co"># дутуу утгуудыг үл тоох</span>
    include.lowest <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>             <span class="co"># cut() -д  0 насыг оролцуул</span>
  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">deciles</span><span class="op">)</span>                   <span class="co"># хүснэгт болгож харуулах</span></code></pre></div>
<pre><code>##  deciles   n    percent valid_percent
##    [0,2] 748 0.11319613    0.11505922
##    (2,5] 721 0.10911017    0.11090601
##    (5,7] 497 0.07521186    0.07644978
##   (7,10] 698 0.10562954    0.10736810
##  (10,13] 635 0.09609564    0.09767728
##  (13,17] 755 0.11425545    0.11613598
##  (17,21] 578 0.08746973    0.08890940
##  (21,26] 625 0.09458232    0.09613906
##  (26,33] 596 0.09019370    0.09167820
##  (33,84] 648 0.09806295    0.09967697
##     &lt;NA&gt; 107 0.01619249            NA</code></pre>
</div>
<div id="тэнцүү-хэмжээтэй-бүлгүүд-үүсгэх" class="section level3 unnumbered">
<h3>Тэнцүү хэмжээтэй бүлгүүд үүсгэх<a class="anchor" aria-label="anchor" href="#%D1%82%D1%8D%D0%BD%D1%86%D2%AF%D2%AF-%D1%85%D1%8D%D0%BC%D0%B6%D1%8D%D1%8D%D1%82%D1%8D%D0%B9-%D0%B1%D2%AF%D0%BB%D0%B3%D2%AF%D2%AF%D0%B4-%D2%AF%D2%AF%D1%81%D0%B3%D1%8D%D1%85"><i class="fas fa-link"></i></a>
</h3>
<p>Тооноос бүлэг үүсгэх өөр нэгэн функц бол <strong>dplyr</strong> багцын <code><a href="https://dplyr.tidyverse.org/reference/ranking.html">ntile()</a></code> юм. Энэ функц таны датаг яг тэнцүү бүлгүүдэд хуваахыг оролддог. <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code> -аас ялгаатай тал нь <em>нэг тоо хоёр өөр бүлэгт орж болдог тул анхаарах хэрэгтэй.</em> Хуваагдах тоон вектор болон үүсгэх бүлгүүдийн тоог оруулж өгөх хэрэгэтй. <code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code> функцээр үүсгэгдсэн баганын утга тухайн бүлгийн нэр байдаг бол <code><a href="https://dplyr.tidyverse.org/reference/ranking.html">ntile()</a></code>-ээр үүссэн багана дах утга зөвхөн бүлгийн дугаарууд болохыг анхаарна.</p>
<div class="sourceCode" id="cb287"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ntile()-аар бүлэг үүсгэ</span>
<span class="va">ntile_data</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>even_groups <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">ntile</a></span><span class="op">(</span><span class="va">age_years</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>

<span class="co"># бүлэг тус бүрт ноогдох ажиглалтын тоо пропорцыг харуулах</span>
<span class="va">ntile_table</span> <span class="op">&lt;-</span> <span class="va">ntile_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">even_groups</span><span class="op">)</span>
  
<span class="co"># зах хязгаарыг харуулах үүднээс min/max -г мөн нэмж харуул</span>
<span class="va">ntile_ranges</span> <span class="op">&lt;-</span> <span class="va">ntile_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">even_groups</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>
    min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">age_years</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,
    max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">age_years</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<pre><code>## Warning in min(age_years, na.rm = T): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(age_years, na.rm = T): no non-missing arguments to max;
## returning -Inf</code></pre>
<div class="sourceCode" id="cb290"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># нэгтгэж, хэвлэ - зарим утга олон бүлэгт зэрэг орж болохыг анхаар</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">ntile_table</span>, <span class="va">ntile_ranges</span>, by <span class="op">=</span> <span class="st">"even_groups"</span><span class="op">)</span></code></pre></div>
<pre><code>##  even_groups   n    percent valid_percent min  max
##            1 651 0.09851695    0.10013844   0    2
##            2 650 0.09836562    0.09998462   2    5
##            3 650 0.09836562    0.09998462   5    7
##            4 650 0.09836562    0.09998462   7   10
##            5 650 0.09836562    0.09998462  10   13
##            6 650 0.09836562    0.09998462  13   17
##            7 650 0.09836562    0.09998462  17   21
##            8 650 0.09836562    0.09998462  21   26
##            9 650 0.09836562    0.09998462  26   33
##           10 650 0.09836562    0.09998462  33   84
##           NA 107 0.01619249            NA Inf -Inf</code></pre>
<!-- ======================================================= -->
</div>
<div id="case_when" class="section level3 unnumbered">
<h3>
<code>case_when()</code><a class="anchor" aria-label="anchor" href="#case_when"><i class="fas fa-link"></i></a>
</h3>
<p><strong>dplyr</strong> -ын <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> -ыг ашиглаж тоон баганаас ангилал үүсгэж бас болно. Гэхдээ шууд автоматаар эрэмбэлэгдсэн factor төрлийн багана үүсдэг тул <strong>epikit</strong> -ын <code>age_categories()</code> эсвэл <code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code> -ыг хэрэглэх нь илүү хялбар байдаг.</p>
<p>Хэрэв <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> -г хэрэглэх бол Re-code values хэсгээс хэрхэн зөв хэрэглэх талаар үзнэ үү. Мөн энэ үед бүх баруун гар талын утгууд ижил төрөл байх хэрэгтэй. Хэрэв <code>NA</code> -г баруун гар талд бичих бол “Missing” эсвэл <code>NA</code> -г төлөөлсөн тусгай <code>NA_character_</code> хэрэглэх шаардлагатай.</p>
</div>
<div id="цэвэрлэх-холбоост-залгах" class="section level3 unnumbered">
<h3>Цэвэрлэх холбоост залгах<a class="anchor" aria-label="anchor" href="#%D1%86%D1%8D%D0%B2%D1%8D%D1%80%D0%BB%D1%8D%D1%85-%D1%85%D0%BE%D0%BB%D0%B1%D0%BE%D0%BE%D1%81%D1%82-%D0%B7%D0%B0%D0%BB%D0%B3%D0%B0%D1%85"><i class="fas fa-link"></i></a>
</h3>
<p>Жишээгээр хоёр ангилагдсан баганыг цэвэрлэх pipe холбоостоо залгаж өгч харууллаа.</p>
<div class="sourceCode" id="cb292"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ЦЭВЭРЛЭХ 'PIPE' ХОЛБООС (түүхий датаг үе шаттайгаар дамжуулан цэвэрлэдэг холбоос)</span>
<span class="co">##################################################################################</span>

<span class="co"># Цэвэрлэх холбоосыг эхлэх</span>
<span class="co">###########################</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    
    <span class="co"># баганын нэрсийг жигдрүүлэх</span>
    <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    
    <span class="co"># зарим баганын нэрийг гараар өөрчил</span>
            <span class="co"># ШИНЭ нэр             # ХУУЧИН нэр</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>date_infection       <span class="op">=</span> <span class="va">infection_date</span>,
           date_hospitalisation <span class="op">=</span> <span class="va">hosp_date</span>,
           date_outcome         <span class="op">=</span> <span class="va">date_of_outcome</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    
    <span class="co"># баганыг хас</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">row_num</span>, <span class="va">merged_header</span>, <span class="va">x28</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 

    <span class="co"># давхардалтыг арилга</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  
    <span class="co"># Шинэ багана нэм</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>bmi <span class="op">=</span> <span class="va">wt_kg</span> <span class="op">/</span> <span class="op">(</span><span class="va">ht_cm</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  
    <span class="co"># баганын төрлийг хувирга</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"date"</span><span class="op">)</span>, <span class="va">as.Date</span><span class="op">)</span>, 
           generation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">generation</span><span class="op">)</span>,
           age        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> |&gt; 
    
    <span class="co"># багана нэм: эмнэлэгт хожуу ирэлт</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>days_onset_hosp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">date_hospitalisation</span> <span class="op">-</span> <span class="va">date_onset</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 

    <span class="co"># эмнэлэгийн баганууддах утгыг цэвэрлэх</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>hospital <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">hospital</span>,
                      <span class="co"># ХУУЧИН = ШИНЭ</span>
                      <span class="st">"Mitylira Hopital"</span>  <span class="op">=</span> <span class="st">"Military Hospital"</span>,
                      <span class="st">"Mitylira Hospital"</span> <span class="op">=</span> <span class="st">"Military Hospital"</span>,
                      <span class="st">"Military Hopital"</span>  <span class="op">=</span> <span class="st">"Military Hospital"</span>,
                      <span class="st">"Port Hopital"</span>      <span class="op">=</span> <span class="st">"Port Hospital"</span>,
                      <span class="st">"Central Hopital"</span>   <span class="op">=</span> <span class="st">"Central Hospital"</span>,
                      <span class="st">"other"</span>             <span class="op">=</span> <span class="st">"Other"</span>,
                      <span class="st">"St. Marks Maternity Hopital (SMMH)"</span> <span class="op">=</span> <span class="st">"St. Mark's Maternity Hospital (SMMH)"</span>
                      <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>hospital <span class="op">=</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na</a></span><span class="op">(</span><span class="va">hospital</span>, <span class="st">"Missing"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 

    <span class="co"># age_years баганыг үүсгэ (age болон age_unit баганыг ашиглаж)</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age_years <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
          <span class="va">age_unit</span> <span class="op">==</span> <span class="st">"years"</span> <span class="op">~</span> <span class="va">age</span>,
          <span class="va">age_unit</span> <span class="op">==</span> <span class="st">"months"</span> <span class="op">~</span> <span class="va">age</span><span class="op">/</span><span class="fl">12</span>,
          <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">age_unit</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span>,
          <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_real_</span><span class="op">)</span><span class="op">)</span> |&gt; 
  
   <span class="co"># ЭНЭ ХҮРТЭЛХ ҮЙЛДЭЛ ӨМНӨХ ХЭСЭГТ ХЭЛЦЭГДСЭН</span>
   <span class="co">################################################### </span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
          <span class="co"># насны ангилал: өөрөө оруулах</span>
          age_cat <span class="op">=</span> <span class="fu">epikit</span><span class="fu">::</span><span class="fu"><a href="https://r4epi.github.io/epikit/reference/age_categories.html">age_categories</a></span><span class="op">(</span><span class="va">age_years</span>, breakers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">50</span>, <span class="fl">70</span><span class="op">)</span><span class="op">)</span>,
        
          <span class="co"># насны ангилал: 0 -оос 85 хүртэл 5 -аар</span>
          age_cat5 <span class="op">=</span> <span class="fu">epikit</span><span class="fu">::</span><span class="fu"><a href="https://r4epi.github.io/epikit/reference/age_categories.html">age_categories</a></span><span class="op">(</span><span class="va">age_years</span>, breakers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">85</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
</div>
</div>
<div id="мөр-нэмэх" class="section level2" number="8.10">
<h2>
<span class="header-section-number">8.10</span> Мөр нэмэх<a class="anchor" aria-label="anchor" href="#%D0%BC%D3%A9%D1%80-%D0%BD%D1%8D%D0%BC%D1%8D%D1%85"><i class="fas fa-link"></i></a>
</h2>
<div id="нэг-нэгээр-нэмэх" class="section level3 unnumbered">
<h3>нэг нэгээр нэмэх<a class="anchor" aria-label="anchor" href="#%D0%BD%D1%8D%D0%B3-%D0%BD%D1%8D%D0%B3%D1%8D%D1%8D%D1%80-%D0%BD%D1%8D%D0%BC%D1%8D%D1%85"><i class="fas fa-link"></i></a>
</h3>
<p>Мөрийг <strong>dplyr</strong>-ын <code><a href="https://tibble.tidyverse.org/reference/add_row.html">add_row()</a></code> -аар оруулах нь гар ажиллагаа ихтэй байдаг. Энэ үед багана тус бүр нэг төрлийн дата агуулсан байх шаардлагатайг санаарай (character, numeric, logical гэх мэт). Тиймээс нэмэх мөрийн дата төрлийг тааруулах шаардлагатай.</p>
<div class="sourceCode" id="cb293"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html">add_row</a></span><span class="op">(</span>row_num <span class="op">=</span> <span class="fl">666</span>,
          case_id <span class="op">=</span> <span class="st">"abc"</span>,
          generation <span class="op">=</span> <span class="fl">4</span>,
          `infection date` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-10-10"</span><span class="op">)</span>,
          .before <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><code>.before</code> болон <code>.after.</code> аргументээр нэмэх мөрийн байрлалыг зааж өгдөг. Жишээ нь<code>.before = 3</code> гэвэл шинэ мөрийг одоогийн 3 дугаар мөрний өмнө нэм гэсэн үг. Default -аар мөрийг баганын төгсгөлд нэмдэг. Тодорхойлгоогүй багануудыг дутуу утгаар (<code>NA</code>) -авах болно.</p>
<p>Шинэ үүссэн <em>мөрийн дугаар</em> хачин харагдаж болох ба (“…23”) but the row numbers in the pre-existing rows <em>have</em> changed. So if using the command twice, examine/test the insertion carefully.</p>
<p>Хэрэв зааж өгсөн дата төрөл нь таарахгүй бол дараахийн адил алдаа гарч ирнэ:</p>
<pre><code>Error: Can't combine ..1$infection date &lt;date&gt; and ..2$infection date &lt;character&gt;.</code></pre>
<p>(огноо төрлийн мөр нэмэхдээ огноогоо <code><a href="https://rdrr.io/r/base/as.Date.html">as.Date()</a></code> функцэд оруулж өгөөрэй ( <code>as.Date("2020-10-10")</code>).</p>
</div>
<div id="мөрүүдийг-холбох" class="section level3 unnumbered">
<h3>Мөрүүдийг холбох<a class="anchor" aria-label="anchor" href="#%D0%BC%D3%A9%D1%80%D2%AF%D2%AF%D0%B4%D0%B8%D0%B9%D0%B3-%D1%85%D0%BE%D0%BB%D0%B1%D0%BE%D1%85"><i class="fas fa-link"></i></a>
</h3>
<p>Нэг хүснэгтийн мөрийг өөр нэг хүснэгтийн доороос залгах бол <strong>dplyr</strong> -ын <code><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows()</a></code>- ыг хэрэглэдэг. Энэ талаар [Joining data] хэсэгт илүү тайлбарласан.</p>
<!-- ======================================================= -->
<!-- ======================================================= -->
<!-- ======================================================= -->
</div>
</div>
<div id="мөрийг-шүүх" class="section level2" number="8.11">
<h2>
<span class="header-section-number">8.11</span> Мөрийг шүүх<a class="anchor" aria-label="anchor" href="#%D0%BC%D3%A9%D1%80%D0%B8%D0%B9%D0%B3-%D1%88%D2%AF%D2%AF%D1%85"><i class="fas fa-link"></i></a>
</h2>
<p>Багануудыг цэвэрлээд, шинэ утгуудыг оруулсны дараа нийтлэг хийгддэг алхам бол <strong>dplyr</strong> -ын <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> -ээр мөрөнд шүүлт хийх юм.</p>
<p><code>TRUE</code> байх ёстой логикийг <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> дотор зааж өгнө. Дараах хэсгүүдэд энгийн болон комплекс логик шалгуураар хэрхэн мөрийг шүүдгийг харуулав.</p>
<!-- ======================================================= -->
<div id="энгийн-шүүлт-хийх" class="section level3 unnumbered">
<h3>Энгийн шүүлт хийх<a class="anchor" aria-label="anchor" href="#%D1%8D%D0%BD%D0%B3%D0%B8%D0%B9%D0%BD-%D1%88%D2%AF%D2%AF%D0%BB%D1%82-%D1%85%D0%B8%D0%B9%D1%85"><i class="fas fa-link"></i></a>
</h3>
<p>Логик шалгуурт нийцсэн мөрүүдийг <code>linelist</code> хүснэгтэд шүүж гаргаж ирэх жишээг харуулав. <strong>Зөвхөн хаалтан доторх логик шалгуурт <code>TRUE</code> нөхцлүүд л үлддэг.</strong></p>
<p>Энэ жишээний логик шалгуур нь <code>gender == "f"</code>. Үүнийг үгчилбэл gender багана дах утгууд “f” (үсгийн том жижиг хамааатай) -тэй тэнцүү байна уу гэсэн үг.</p>
<p>Шүүлтүүр уншигдахын өмнө <code>linelist</code> дэх мөрийн тоо <code>nrow(linelist)</code>.</p>
<div class="sourceCode" id="cb295"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">gender</span> <span class="op">==</span> <span class="st">"f"</span><span class="op">)</span>   <span class="co"># gender баганад "f" гэсэн мөрүүдийг л авч үлднэ</span></code></pre></div>
<p>Шүүж ялгасны дараа <code>linelist</code> хүснэгтэд <code>linelist %&gt;% filter(gender == "f") %&gt;% nrow()</code> мөр үлдсэн.</p>
</div>
<div id="дутуу-утгуудыг-ялгах" class="section level3 unnumbered">
<h3>Дутуу утгуудыг ялгах<a class="anchor" aria-label="anchor" href="#%D0%B4%D1%83%D1%82%D1%83%D1%83-%D1%83%D1%82%D0%B3%D1%83%D1%83%D0%B4%D1%8B%D0%B3-%D1%8F%D0%BB%D0%B3%D0%B0%D1%85"><i class="fas fa-link"></i></a>
</h3>
<p>Нийтлэг хийдэг үйлдлүүдийн нэг бол дутуу утгатай мөрүүдийг ялгах юм. Ингэхдээ шууд <code>filter(!is.na(column) &amp; !is.na(column))</code> коммандыг өгөхийн оронд <strong>tydir</strong> багцын яг энэ үйлдэлд зориулсан <code><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na()</a></code> функцыг хэрэглэвэл оновчтой. Энэ функцын хаалтыг хоосон орхивол дутуу утга агуулсан мөр болгоныг арилгах болно. Баганын нэрийг зааж өгч болно эсвэл “tidyselect” функцын тусламжтай (<a href="%D0%B4%D0%B0%D1%82%D0%B0-%D1%86%D1%8D%D0%B2%D1%8D%D1%80%D0%BB%D1%8D%D0%B3%D1%8D%D1%8D-%D0%B1%D0%B0-%D2%AF%D0%BD%D0%B4%D1%81%D1%8D%D0%BD-%D1%84%D1%83%D0%BD%D0%BA%D1%86%D1%83%D1%83%D0%B4.html#clean_tidyselect">above</a>) багануудыг сонгож дутуу утгыг шүүж болно.</p>
<div class="sourceCode" id="cb296"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">case_id</span>, <span class="va">age_years</span><span class="op">)</span>  <span class="co"># case_id, age_years багануудад дутуу утгатай  мөрийг арилгах</span></code></pre></div>
<p>[Missing data] хэсгээс дутуу утгыг янзлах төрөл бүрийн аргатай танилцаж болно.</p>
</div>
<div id="мөрийн-дугаараар-шүүлт-хийх" class="section level3 unnumbered">
<h3>Мөрийн дугаараар шүүлт хийх<a class="anchor" aria-label="anchor" href="#%D0%BC%D3%A9%D1%80%D0%B8%D0%B9%D0%BD-%D0%B4%D1%83%D0%B3%D0%B0%D0%B0%D1%80%D0%B0%D0%B0%D1%80-%D1%88%D2%AF%D2%AF%D0%BB%D1%82-%D1%85%D0%B8%D0%B9%D1%85"><i class="fas fa-link"></i></a>
</h3>
<p>Хүснэгт болон tibble-ийн эхний баганын зүүн талд мөрийн дугаар харагддаг (R Viewer цонхоор харахад). Энэ дугаарууд бие даасан багана биш боловч <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> хийхэд хэрэглэгддэг.</p>
<p>Дугаараар нь шүүлт хийхдээ <strong>логик шалгуурын нөхцлийн нэг хэсэгт dplyr</strong> -ын <code><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number()</a></code> функцыг нээлттэй хааллтайгаар оруулдаг. Логик нөхцөлд <code>%in%</code> оператор болон жагсаасан тоо шаардлагатай (дор үзүүлсний дагуу). Эхний N мөрийг харахаын тулд <strong>dplyr</strong> функцын <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> функцыг хэрэглэнэ үү.</p>
<div class="sourceCode" id="cb297"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Эхний 100 мөр</span>
<span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>     <span class="co"># tail() -аар сүүлийн мөрүүдийг харж болно</span>

<span class="co"># Эхний 5 мөр</span>
<span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span><span class="op">(</span><span class="op">)</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span>

<span class="co"># Заасан гурван баганын 2-20 дах мөрийг харуул</span>
<span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fl">2</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">date_onset</span>, <span class="va">outcome</span>, <span class="va">age</span><span class="op">)</span></code></pre></div>
<p>You can also convert the row numbers to a true column by piping your data frame to the <strong>tibble</strong> function <code><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column()</a></code> (do not put anything in the parentheses).</p>
<!-- ======================================================= -->
</div>
<div id="комплекс-шүүлт-хийх" class="section level3 unnumbered">
<h3>Комплекс шүүлт хийх<a class="anchor" aria-label="anchor" href="#%D0%BA%D0%BE%D0%BC%D0%BF%D0%BB%D0%B5%D0%BA%D1%81-%D1%88%D2%AF%D2%AF%D0%BB%D1%82-%D1%85%D0%B8%D0%B9%D1%85"><i class="fas fa-link"></i></a>
</h3>
<p>Илүү комплекс логик шүүлт хийхдээ хаалт <code>( )</code>, ЭСВЭЛ <code>|</code>, үгүйсгэх <code>!</code>, <code>%in%</code>, БОЛОН <code>&amp;</code> операторуудыг ашигладаг.</p>
<p>Тэмдэглэл: <code>!</code> операторыг үгүйсгэх логик шалгуурын өмнө тавьдаг. Жишээ нь <code>!is.na(column)</code> комманд өгөхөд тухайн баганад <em>дутуу утга байхгүй</em> бол <code>TRUE</code> гэж гарна. Үүний адил <code>!column %in% c("a", "b", "c")</code> комманд өгөхөд баганын утга вектор биш бол <code>TRUE</code> гэж гарна.</p>
<div id="датаг-шалга" class="section level4 unnumbered">
<h4>Датаг шалга<a class="anchor" aria-label="anchor" href="#%D0%B4%D0%B0%D1%82%D0%B0%D0%B3-%D1%88%D0%B0%D0%BB%D0%B3%D0%B0"><i class="fas fa-link"></i></a>
</h4>
<p>Доорх коммандаар өвчний эхлэлийг харуулсан гистограмм хийгднэ. Зургаас харахад 2012-2013 оны хооронд гарсан жижиг дэгдэлтийн дата түүхий датаны нэг хэсэг болж орсон байна. <strong>Бидний анализдаа энэхүү өмнөх дэгдэлтийн датаг арилгах шаардлагатай.</strong></p>
<div class="sourceCode" id="cb298"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">date_onset</span>, breaks <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-232-1.png" width="50%"></div>
</div>
<div id="тоон-болон-огноон-датаны-дутуу-утгад-шүүлт-хийх" class="section level4 unnumbered">
<h4>Тоон болон огноон датаны дутуу утгад шүүлт хийх<a class="anchor" aria-label="anchor" href="#%D1%82%D0%BE%D0%BE%D0%BD-%D0%B1%D0%BE%D0%BB%D0%BE%D0%BD-%D0%BE%D0%B3%D0%BD%D0%BE%D0%BE%D0%BD-%D0%B4%D0%B0%D1%82%D0%B0%D0%BD%D1%8B-%D0%B4%D1%83%D1%82%D1%83%D1%83-%D1%83%D1%82%D0%B3%D0%B0%D0%B4-%D1%88%D2%AF%D2%AF%D0%BB%D1%82-%D1%85%D0%B8%D0%B9%D1%85"><i class="fas fa-link"></i></a>
</h4>
<p>2013 оны 6 сараас хойшхи мөрүүдийг <code>date_onset</code> баганад шууд шүүлт хийснээр ялгах боломжтой уу? <strong>Анхааруулга! <code>filter(date_onset &gt; as.Date("2013-06-01")))</code> комманд өгвөл дараагийн дэгдэлт дэх дутуу утгатай бүх мөрийг утгагдах болохыг анхаар!</strong></p>
<p><span style="color: red;"><strong><em>АЮУЛТАЙ:</em></strong> Тоон болон огноонд их (&gt;) багын (&lt;) тэмдэг хэрэглэхээр дутуу утгатай (<code>NA</code>) бүх мөр арилчихдаг! Учир нь <code>NA</code> нь хязгааргүй их эсвэл бага утга гэж уншигддаг.</span></p>
<p><em>(Огноо болон <strong>lubridate</strong> багцтай ажиллах талаар [Working with dates] хэсгээс үзээрэй)</em></p>
</div>
<div id="шүүлтүүрийн-загвар-гаргах" class="section level4 unnumbered">
<h4>Шүүлтүүрийн загвар гаргах<a class="anchor" aria-label="anchor" href="#%D1%88%D2%AF%D2%AF%D0%BB%D1%82%D2%AF%D2%AF%D1%80%D0%B8%D0%B9%D0%BD-%D0%B7%D0%B0%D0%B3%D0%B2%D0%B0%D1%80-%D0%B3%D0%B0%D1%80%D0%B3%D0%B0%D1%85"><i class="fas fa-link"></i></a>
</h4>
<p>Солбисон хүснэгтээр зөв мөрүүд хамрагдсан эсэхийг шалга:</p>
<div class="sourceCode" id="cb299"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span>Hospital  <span class="op">=</span> <span class="va">linelist</span><span class="op">$</span><span class="va">hospital</span>,                     <span class="co"># эмнэлэгийн нэр</span>
      YearOnset <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">date_onset</span><span class="op">)</span>,  <span class="co"># өвчний эхэлсэн (date_onset) жил</span>
      useNA     <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span>                              <span class="co"># дутуу утгыг харуул</span></code></pre></div>
<pre><code>##                                       YearOnset
## Hospital                               2012 2013 2014 2015 &lt;NA&gt;
##   Central Hospital                        0    0  351   99   18
##   Hospital A                            229   46    0    0   15
##   Hospital B                            227   47    0    0   15
##   Military Hospital                       0    0  676  200   34
##   Missing                                 0    0 1117  318   77
##   Other                                   0    0  684  177   46
##   Port Hospital                           9    1 1372  347   75
##   St. Mark's Maternity Hospital (SMMH)    0    0  322   93   13
##   &lt;NA&gt;                                    0    0    0    0    0</code></pre>
<p>Энэхүү датанаас эхний дэгдэлтийн (2012 болон 2013 онуудын) хэсгийг шүүхийн тулд ямар шалгуур нэмж болох вэ? Үүнээс харахад:</p>
<ul>
<li>2012 болон 2013 онд болсон эхний дэгдэлтүүд A , B эмнэлэгт гарч Port эмнэлэгт ердөө 10 тохиолдол бүртгэгдсэн байна.<br>
</li>
<li>Хоёрдах дэгдэлтийн үед A болон B эмнэлэгүүдэд дэгдэлт гараагүй. Port эмнэлэгт дэгдэлт гарсан байна.</li>
</ul>
<p>Дараах хэсгийг хасах хэрэгтэй:</p>
<ul>
<li>
<p>А, B, Port эмнэлэгүүдийн тохиолдлуудын өвчин эхэлсэн өдөр нь 2012, 2013 онд тэмдэглэгдсэн мөрүүд <code>nrow(linelist %&gt;% filter(hospital %in% c("Hospital A", "Hospital B") | date_onset &lt; as.Date("2013-06-01")))</code>:</p>
<ul>
<li>2012 болон 2013 онд тэмдэглэгдсэн өвчний эхлэлтэй мөрүүдийг хасах <code>nrow(linelist %&gt;% filter(date_onset &lt; as.Date("2013-06-01")))</code>
</li>
<li>A болон B эмнэлэгийн огноо нь дутуу мөрүүдийг хасах <code>nrow(linelist %&gt;% filter(hospital %in% c('Hospital A', 'Hospital B') &amp; is.na(date_onset)))</code><br>
</li>
<li>Огноо нь дутуу утгатай бусад мөрийг <strong>хасахгүй</strong> байх <code>nrow(linelist %&gt;% filter(!hospital %in% c('Hospital A', 'Hospital B') &amp; is.na(date_onset)))</code>.</li>
</ul>
</li>
</ul>
<p>Эхлээд linelist -ийн мөрийн тоо nrow(linelist)` байсан. Шүүлт хийх нөхцөл:</p>
<div class="sourceCode" id="cb301"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="co"># Өвчний эхлэл нь 2013  оны 6 сарын 1 нээс хойш ЭСВЭЛ өвчин эхэлсэн огноо нь дутуу бичигдсн , B эмнэлэгээс эмнэлэгийн бус тохиолдол</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">date_onset</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2013-06-01"</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">date_onset</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">hospital</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hospital A"</span>, <span class="st">"Hospital B"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 6019</code></pre>
<p>Солбицох хүснэгт дахин хийж үзвэл A болон B эмнэлэгүүдийн дата бүтнээрээ, Port эмнэлэгт 2012, 2013 онд гарсан 10 тохиолдлын мөрүүд хасагдаж бусад утгууд хэвэндээ байна (яг бидний зорьсны дагуу).</p>
<div class="sourceCode" id="cb303"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span>Hospital  <span class="op">=</span> <span class="va">linelist</span><span class="op">$</span><span class="va">hospital</span>,                     <span class="co"># Эмнэлэгийн нэр</span>
      YearOnset <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">date_onset</span><span class="op">)</span>,  <span class="co"># өвчин эхэлсэн (date_onset) жил</span>
      useNA     <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span>                              <span class="co"># дутуу утгыг харуул</span></code></pre></div>
<pre><code>##                                       YearOnset
## Hospital                               2014 2015 &lt;NA&gt;
##   Central Hospital                      351   99   18
##   Military Hospital                     676  200   34
##   Missing                              1117  318   77
##   Other                                 684  177   46
##   Port Hospital                        1372  347   75
##   St. Mark's Maternity Hospital (SMMH)  322   93   13
##   &lt;NA&gt;                                    0    0    0</code></pre>
<p>Шүүлт хийх ганц коммандаар олон нөхцөл зэрэг оруулж (таслалаар тугаарлан) оруулж болно. Эсвэл ойлгомжтой болгох үүднээс нөхцөл тус бүрт filter() -т оруулж pipe -аар залгаж болно.</p>
<p><em>Тэмдэглэл: зарим уншигчид шууд <code>date_hospitalisation</code> шүүлтүүрийг ашиглах нь хялбар болохыг анзаарсан байх. Энэ нь дутуу утга байхгүй 100% бүрэн. бүртгэл юм. Таны зөв. Дээрх жишээний хувьд бол комплекс шүүлт хэрхэн хийхийг үзүүлэх үүднээс <code>date_onset</code>-г сонгосон гэдгийг анхаарна уу.</em></p>
</div>
</div>
<div id="бие-даасан-үйлдэл" class="section level3 unnumbered">
<h3>Бие даасан үйлдэл<a class="anchor" aria-label="anchor" href="#%D0%B1%D0%B8%D0%B5-%D0%B4%D0%B0%D0%B0%D1%81%D0%B0%D0%BD-%D2%AF%D0%B9%D0%BB%D0%B4%D1%8D%D0%BB"><i class="fas fa-link"></i></a>
</h3>
<p>Шүүлт хийх үйлдлийг дангаар нь бас гүйцэтгэж болно (pipe холбоосонд залгалгүйгээр). Энэ тохиолдолд <strong>dplyr</strong> -ын бусад функцын адил эхний аргумент нь дата хүснэгт өөрөө байх болно.</p>
<div class="sourceCode" id="cb305"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># dataframe &lt;- filter(хүснэгт, мөрийг үлдээх нөхцлүүд )</span>

<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">linelist</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">case_id</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><strong>base</strong> R -ын дөрвөлжин <code>[ ]</code> хаалтыг (сонгосон багана, мөрийг заадаг) ашиглан хүссэн хэсгээ салгаж үзэж болно.</p>
<div class="sourceCode" id="cb306"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># dataframe &lt;- dataframe[row conditions, column conditions] (blank means keep all)</span>

<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">case_id</span><span class="op">)</span>, <span class="op">]</span></code></pre></div>
</div>
<div id="мөрүүдийг-түргэн-шалгах" class="section level3 unnumbered">
<h3>Мөрүүдийг түргэн шалгах<a class="anchor" aria-label="anchor" href="#%D0%BC%D3%A9%D1%80%D2%AF%D2%AF%D0%B4%D0%B8%D0%B9%D0%B3-%D1%82%D2%AF%D1%80%D0%B3%D1%8D%D0%BD-%D1%88%D0%B0%D0%BB%D0%B3%D0%B0%D1%85"><i class="fas fa-link"></i></a>
</h3>
<p>Дата янзалж байх явцад зарим мөрийг яаралтай шалгах шаардлага цөөнгүй гардаг. RStudio дээр дата хүснэгттийг хэвлэж үзэхэд <strong>base</strong> R -ын функц <code><a href="https://rdrr.io/r/utils/View.html">View()</a></code>-ийг хэрэглэдэг.</p>
<p>linelist-ийг RStudio-д харах код:</p>
<div class="sourceCode" id="cb307"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/View.html">View</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></code></pre></div>
<p>Доор тодорхой нэг нүдийг шалгаж харах хоёр аргыг харуулав (тодорхий мөр, тодорхой багана):</p>
<p><strong>dplyr -ын <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> болон <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> функцууд:</strong></p>
<p>Авч үлдэх мөрүүдээ <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> -т, багануудаа <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> -д оруулэ pipe -аар холбож <code><a href="https://rdrr.io/r/utils/View.html">View()</a></code> дотор бичнэ. Жишээ нь дараах 3 тохиолдлын өвчин эхэлсэн болон эмнэлэгт хэвтсэн огноог харахын тулд доорхи коммандыг өгнө:</p>
<div class="sourceCode" id="cb308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/View.html">View</a></span><span class="op">(</span><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">case_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"11f8ea"</span>, <span class="st">"76b97a"</span>, <span class="st">"47a5f5"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">date_onset</span>, <span class="va">date_hospitalisation</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><strong>base</strong> R -ын <code>[ ]</code> хаалтыг ашиглан хүссэн хэсгээ салгаж үзэж, дээрхитэй ижил үр дүнг гаргаж бас болно.</p>
<div class="sourceCode" id="cb309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/View.html">View</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">[</span><span class="va">linelist</span><span class="op">$</span><span class="va">case_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"11f8ea"</span>, <span class="st">"76b97a"</span>, <span class="st">"47a5f5"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"date_onset"</span>, <span class="st">"date_hospitalisation"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div id="pipe-холбоост-залгах" class="section level4 unnumbered">
<h4>Pipe холбоост залгах<a class="anchor" aria-label="anchor" href="#pipe-%D1%85%D0%BE%D0%BB%D0%B1%D0%BE%D0%BE%D1%81%D1%82-%D0%B7%D0%B0%D0%BB%D0%B3%D0%B0%D1%85"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb310"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ЦЭВЭРЛЭХ 'PIPE' ХОЛБООС (түүхий датаг үе шаттайгаар дамжуулан цэвэрлэдэг холбоос)</span>
<span class="co">##################################################################################</span>

<span class="co"># Цэвэрлэх холбоосыг эхлэх</span>
<span class="co">###########################</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    
    <span class="co"># баганын нэрсийг жигдрүүлэх</span>
    <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    
    <span class="co"># зарим баганын нэрийг гараар өөрчил</span>
            <span class="co"># ШИНЭ нэр             # ХУУЧИН нэр</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>date_infection       <span class="op">=</span> <span class="va">infection_date</span>,
           date_hospitalisation <span class="op">=</span> <span class="va">hosp_date</span>,
           date_outcome         <span class="op">=</span> <span class="va">date_of_outcome</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    
    <span class="co"># баганыг хас</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">row_num</span>, <span class="va">merged_header</span>, <span class="va">x28</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 

    <span class="co"># давхардалтыг арилга</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  
    <span class="co"># Шинэ багана нэм</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>bmi <span class="op">=</span> <span class="va">wt_kg</span> <span class="op">/</span> <span class="op">(</span><span class="va">ht_cm</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  
    <span class="co"># баганын төрлийг хувирга</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"date"</span><span class="op">)</span>, <span class="va">as.Date</span><span class="op">)</span>, 
           generation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">generation</span><span class="op">)</span>,
           age        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> |&gt; 
    
    <span class="co"># багана нэм: эмнэлэгт хожуу ирэлт</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>days_onset_hosp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">date_hospitalisation</span> <span class="op">-</span> <span class="va">date_onset</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 

    <span class="co"># эмнэлэгийн баганууддах утгыг цэвэрлэх</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>hospital <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">hospital</span>,
                      <span class="co"># ХУУЧИН = ШИНЭ</span>
                      <span class="st">"Mitylira Hopital"</span>  <span class="op">=</span> <span class="st">"Military Hospital"</span>,
                      <span class="st">"Mitylira Hospital"</span> <span class="op">=</span> <span class="st">"Military Hospital"</span>,
                      <span class="st">"Military Hopital"</span>  <span class="op">=</span> <span class="st">"Military Hospital"</span>,
                      <span class="st">"Port Hopital"</span>      <span class="op">=</span> <span class="st">"Port Hospital"</span>,
                      <span class="st">"Central Hopital"</span>   <span class="op">=</span> <span class="st">"Central Hospital"</span>,
                      <span class="st">"other"</span>             <span class="op">=</span> <span class="st">"Other"</span>,
                      <span class="st">"St. Marks Maternity Hopital (SMMH)"</span> <span class="op">=</span> <span class="st">"St. Mark's Maternity Hospital (SMMH)"</span>
                      <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>hospital <span class="op">=</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na</a></span><span class="op">(</span><span class="va">hospital</span>, <span class="st">"Missing"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 

    <span class="co"># age_years баганыг үүсгэ (age болон age_unit баганыг ашиглаж)</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age_years <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
          <span class="va">age_unit</span> <span class="op">==</span> <span class="st">"years"</span> <span class="op">~</span> <span class="va">age</span>,
          <span class="va">age_unit</span> <span class="op">==</span> <span class="st">"months"</span> <span class="op">~</span> <span class="va">age</span><span class="op">/</span><span class="fl">12</span>,
          <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">age_unit</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span>,
          <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_real_</span><span class="op">)</span><span class="op">)</span> |&gt; 
  
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
          <span class="co"># насны ангилал: өөрөө оруулах</span>
          age_cat <span class="op">=</span> <span class="fu">epikit</span><span class="fu">::</span><span class="fu"><a href="https://r4epi.github.io/epikit/reference/age_categories.html">age_categories</a></span><span class="op">(</span><span class="va">age_years</span>, breakers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">50</span>, <span class="fl">70</span><span class="op">)</span><span class="op">)</span>,
        
          <span class="co"># насны ангилал: 0 -оос 85 хүртэл 5 -аар</span>
          age_cat5 <span class="op">=</span> <span class="fu">epikit</span><span class="fu">::</span><span class="fu"><a href="https://r4epi.github.io/epikit/reference/age_categories.html">age_categories</a></span><span class="op">(</span><span class="va">age_years</span>, breakers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">85</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> |&gt; 
    
   <span class="co"># ЭНЭ ХҮРТЭЛХ ҮЙЛДЭЛ ӨМНӨХ ХЭСЭГТ ХЭЛЦЭГДСЭН</span>
   <span class="co">################################################### </span>
    
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span>
          <span class="co"># case_id баганад дутуу утгагүй мөрүүдийг л үлдээ</span>
          <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">case_id</span><span class="op">)</span>,  
          
          <span class="co"># зөвхөн хоёрдах дэгдэлтийн датаг үлдээ</span>
          <span class="va">date_onset</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2013-06-01"</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">date_onset</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">hospital</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hospital A"</span>, <span class="st">"Hospital B"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
<!-- ======================================================= -->
<!-- ======================================================= -->
</div>
</div>
</div>
<div id="мөр-дагуу-тооцоолол" class="section level2" number="8.12">
<h2>
<span class="header-section-number">8.12</span> Мөр дагуу тооцоолол<a class="anchor" aria-label="anchor" href="#%D0%BC%D3%A9%D1%80-%D0%B4%D0%B0%D0%B3%D1%83%D1%83-%D1%82%D0%BE%D0%BE%D1%86%D0%BE%D0%BE%D0%BB%D0%BE%D0%BB"><i class="fas fa-link"></i></a>
</h2>
<p>Хэрэв мөр дагуу уртаашаа тооцоолол хийх бол <strong>dplyr</strong>-ын <code><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise()</a></code> функцыг хэрэглэ. Онлайн винньетийг <a href="https://cran.r-project.org/web/packages/dplyr/vignettes/rowwise.html">row-wise calculations</a>- ээс нэмж үзнэ үү .<br></p>
<p>Дор жишээнд linelist датанд <code><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise()</a></code> функц мөр болгоныг уртааш нь шалгаж үзээд “yes” гэсэн утгатай нүднүүдийн нийлбэртэй шинэ багана нэмсэн. Шалгагдах багануудыг <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> функцэд нэрээр нь вектороор <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> уагсааж оруулна. <code><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise()</a></code> функц нь <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> функцын нэг төрөл тул үйлдлээ хийж дуусаад эргүүлээд <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup()</a></code> коммандаар задлах шаардлагатай ([Grouping data] хэсэг).</p>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>num_symptoms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">fever</span>, <span class="va">chills</span>, <span class="va">cough</span>, <span class="va">aches</span>, <span class="va">vomit</span><span class="op">)</span> <span class="op">==</span> <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">fever</span>, <span class="va">chills</span>, <span class="va">cough</span>, <span class="va">aches</span>, <span class="va">vomit</span>, <span class="va">num_symptoms</span><span class="op">)</span> <span class="co"># үзүүлэх зорилготой</span></code></pre></div>
<pre><code>## # A tibble: 5,888 x 6
##    fever chills cough aches vomit num_symptoms
##    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;        &lt;int&gt;
##  1 no    no     yes   no    yes              2
##  2 &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;            NA
##  3 &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;            NA
##  4 no    no     no    no    no               0
##  5 no    no     yes   no    yes              2
##  6 no    no     yes   no    yes              2
##  7 &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;            NA
##  8 no    no     yes   no    yes              2
##  9 no    no     yes   no    yes              2
## 10 no    no     yes   no    no               1
## # ... with 5,878 more rows</code></pre>
<p>Шалгах багануудыг сонгохдоо “tidyselect” туслах функцуудыг ( <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> хэсэгт тайлбарласны дагуу) хэрэглэж болно. Зөвхөн тохируулгыг нь солиход л болно (<strong>dplyr</strong> -ын <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> зэрэг функц биш учраас).</p>
<p><strong>dplyr</strong> -ын <code><a href="https://dplyr.tidyverse.org/reference/c_across.html">c_across()</a></code> дотор нөхцлөө оруулж өгнө. Учир нь <code>c_across</code> (<a href="https://dplyr.tidyverse.org/reference/c_across.html">documentation</a>) функц <code><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise()</a></code> -аар ажилладаг. Жишээ нь дараах код ажиллах дараалал нь:</p>
<ul>
<li>эхлээд <code><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise()</a></code> гүйцэтгэгдэх ба ингэснээр үүний дараа хийгдэх үйлдэл (<code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code>) мөр болгонд хийгднэ (багануудын нийлбэр биш).</li>
<li>
<code>num_NA_dates</code> хэмээх шинэ баганыг нэмж, defined for each row as the number of columns (with name containing “date”) for which <code><a href="https://rdrr.io/r/base/NA.html">is.na()</a></code> evaluated to TRUE (they are missing data).<br>
</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup()</a></code> хийснээр дараагийн хийгдэх үйлдлүүдэд <code><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise()</a></code> нөлөөлөхгүй байх болно.</li>
</ul>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>num_NA_dates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/c_across.html">c_across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"date"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">num_NA_dates</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"date"</span><span class="op">)</span><span class="op">)</span> <span class="co"># үзүүлэх зорилготой</span></code></pre></div>
<pre><code>## # A tibble: 5,888 x 5
##    num_NA_dates date_infection date_onset date_hospitalisation date_outcome
##           &lt;int&gt; &lt;date&gt;         &lt;date&gt;     &lt;date&gt;               &lt;date&gt;      
##  1            1 2014-05-08     2014-05-13 2014-05-15           NA          
##  2            1 NA             2014-05-13 2014-05-14           2014-05-18  
##  3            1 NA             2014-05-16 2014-05-18           2014-05-30  
##  4            1 2014-05-04     2014-05-18 2014-05-20           NA          
##  5            0 2014-05-18     2014-05-21 2014-05-22           2014-05-29  
##  6            0 2014-05-03     2014-05-22 2014-05-23           2014-05-24  
##  7            0 2014-05-22     2014-05-27 2014-05-29           2014-06-01  
##  8            0 2014-05-28     2014-06-02 2014-06-03           2014-06-07  
##  9            1 NA             2014-06-05 2014-06-06           2014-06-18  
## 10            1 NA             2014-06-05 2014-06-07           2014-06-09  
## # ... with 5,878 more rows</code></pre>
<p>Нэмж <code><a href="https://rdrr.io/r/base/Extremes.html">max()</a></code> гэх мэт бусад функцыг хэрэглэж болно. <code><a href="https://rdrr.io/r/base/Extremes.html">max()</a></code>-аар мөр болгон дах хамгийн шинэ огноог харуулдаг:</p>
<div class="sourceCode" id="cb315"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>latest_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/c_across.html">c_across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"date"</span><span class="op">)</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">latest_date</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"date"</span><span class="op">)</span><span class="op">)</span>  <span class="co"># үзүүлэх зорилготой</span></code></pre></div>
<pre><code>## # A tibble: 5,888 x 5
##    latest_date date_infection date_onset date_hospitalisation date_outcome
##    &lt;date&gt;      &lt;date&gt;         &lt;date&gt;     &lt;date&gt;               &lt;date&gt;      
##  1 2014-05-15  2014-05-08     2014-05-13 2014-05-15           NA          
##  2 2014-05-18  NA             2014-05-13 2014-05-14           2014-05-18  
##  3 2014-05-30  NA             2014-05-16 2014-05-18           2014-05-30  
##  4 2014-05-20  2014-05-04     2014-05-18 2014-05-20           NA          
##  5 2014-05-29  2014-05-18     2014-05-21 2014-05-22           2014-05-29  
##  6 2014-05-24  2014-05-03     2014-05-22 2014-05-23           2014-05-24  
##  7 2014-06-01  2014-05-22     2014-05-27 2014-05-29           2014-06-01  
##  8 2014-06-07  2014-05-28     2014-06-02 2014-06-03           2014-06-07  
##  9 2014-06-18  NA             2014-06-05 2014-06-06           2014-06-18  
## 10 2014-06-09  NA             2014-06-05 2014-06-07           2014-06-09  
## # ... with 5,878 more rows</code></pre>
</div>
<div id="эрэмбэлэн-ялгах" class="section level2" number="8.13">
<h2>
<span class="header-section-number">8.13</span> Эрэмбэлэн ялгах<a class="anchor" aria-label="anchor" href="#%D1%8D%D1%80%D1%8D%D0%BC%D0%B1%D1%8D%D0%BB%D1%8D%D0%BD-%D1%8F%D0%BB%D0%B3%D0%B0%D1%85"><i class="fas fa-link"></i></a>
</h2>
<p>Мөрийг баганын утгаар эрэмбэлэх бол <strong>dplyr</strong> функцын <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code> -ыг хэрэглэнэ.</p>
<p>Багануудыг эрэмбэлэх дарааллын дагуу жагсааж бичнэ. Хэрэв эрэмбэлэлтийг аль нэг баганын ангиллын дагуу хийх бол <code>.by_group = TRUE</code> гэж аргументийг тохируулна ([Grouping data] хэсгээс харна уу).</p>
<p>Default-аар бол баганын утга “ихсэх” дарааллаар эрэмбэлэгддэг (тоо болон үсгэн утга). Баганын нэрийг <code><a href="https://dplyr.tidyverse.org/reference/desc.html">desc()</a></code> -д оруулсанаар “буурах” дараалалд оруулж болно.</p>
<p>Ялангуяа тайлан, илтгэлд зориулсан хүснэгт ([Tables for presentation]) дээр ажиллахад <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code> -ыг ашиглавал оновчтой. <code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice()</a></code> -аар ангилал тус бүрийн “оройн” мөрүүдийг харуулж болно. Мөн factor-ын шатлалыг харагдах байдлаар нь эрэмбэлж тохируулж болдог.</p>
<p>Жишээ нь, linelist датаг <code>hospital</code> баганын дагуу эрэмбэлээд, дараа нь <code>date_onset</code> -ээр буурах дарааллаар эрэмбэлэе гэвэл дараах байдлаар кодыг бичнэ:</p>
<div class="sourceCode" id="cb317"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">hospital</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">date_onset</span><span class="op">)</span><span class="op">)</span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="%D1%84%D0%B0%D0%B9%D0%BB-%D0%B8%D0%BC%D0%BF%D0%BE%D1%80%D1%82%D0%BB%D0%BE%D0%B6-%D1%8D%D0%BA%D1%81%D0%BF%D0%BE%D1%80%D1%82%D0%BB%D0%BE%D1%85.html"><span class="header-section-number">7</span> Файл импортлож экспортлох</a></div>
<div class="next"><a href="%D0%BE%D0%B3%D0%BD%D0%BE%D0%BE%D1%82%D0%BE%D0%B9-%D0%B0%D0%B6%D0%B8%D0%BB%D0%BB%D0%B0%D1%85-%D0%BD%D1%8C.html"><span class="header-section-number">9</span> Огноотой ажиллах нь</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li>
<a class="nav-link" href="#%D0%B4%D0%B0%D1%82%D0%B0-%D1%86%D1%8D%D0%B2%D1%8D%D1%80%D0%BB%D1%8D%D0%B3%D1%8D%D1%8D-%D0%B1%D0%B0-%D2%AF%D0%BD%D0%B4%D1%81%D1%8D%D0%BD-%D1%84%D1%83%D0%BD%D0%BA%D1%86%D1%83%D1%83%D0%B4"><span class="header-section-number">8</span> Дата цэвэрлэгээ ба үндсэн функцууд</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%D2%AF%D0%BD%D0%B4%D1%81%D1%8D%D0%BD-%D1%84%D1%83%D0%BD%D0%BA%D1%86%D1%83%D1%83%D0%B4">Үндсэн функцууд</a></li>
<li><a class="nav-link" href="#%D0%BD%D1%8D%D1%80-%D1%82%D0%BE%D0%BC%D1%8C%D1%91%D0%BE">Нэр томьёо</a></li>
</ul>
</li>
<li><a class="nav-link" href="#%D1%86%D1%8D%D0%B2%D1%8D%D1%80%D0%BB%D1%8D%D1%85-%D1%85%D0%BE%D0%BB%D0%B1%D0%BE%D0%BE%D1%81"><span class="header-section-number">8.1</span> Цэвэрлэх холбоос</a></li>
<li><a class="nav-link" href="#%D0%B1%D0%B0%D0%B3%D1%86%D1%83%D1%83%D0%B4%D1%8B%D0%B3-%D0%B0%D1%87%D0%B0%D0%B0%D0%BB%D0%BB%D0%B0%D1%85"><span class="header-section-number">8.2</span> Багцуудыг ачааллах</a></li>
<li>
<a class="nav-link" href="#%D0%B4%D0%B0%D1%82%D0%B0%D0%B3-%D0%B8%D0%BC%D0%BF%D0%BE%D1%80%D1%82%D0%BB%D0%BE%D1%85"><span class="header-section-number">8.3</span> Датаг импортлох</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%D0%B8%D0%BC%D0%BF%D0%BE%D1%80%D1%82-%D1%85%D0%B8%D0%B9%D1%85">Импорт хийх</a></li>
<li><a class="nav-link" href="#%D1%82%D0%BE%D0%B9%D0%BC%D0%BB%D0%BE%D0%BD-%D2%AF%D0%B7%D1%8D%D1%85">Тоймлон үзэх</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D1%8B%D0%BD-%D0%BD%D1%8D%D1%80%D1%81"><span class="header-section-number">8.4</span> Баганын нэрс</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82-%D1%86%D1%8D%D0%B2%D1%8D%D1%80%D0%BB%D1%8D%D0%B3%D1%8D%D1%8D">Автомат цэвэрлэгээ</a></li>
<li><a class="nav-link" href="#%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D1%8B%D0%BD-%D0%BD%D1%8D%D1%80%D0%B8%D0%B9%D0%B3-%D0%B3%D0%B0%D1%80%D0%B0%D0%B0%D1%80-%D1%86%D1%8D%D0%B2%D1%8D%D1%80%D0%BB%D1%8D%D1%85">Баганын нэрийг гараар цэвэрлэх</a></li>
<li><a class="nav-link" href="#%D0%B1%D1%83%D1%81%D0%B0%D0%B4">Бусад</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D0%B0-%D1%81%D0%BE%D0%BD%D0%B3%D0%BE%D1%85-%D0%B1%D0%BE%D0%BB%D0%BE%D0%BD-%D1%8D%D1%80%D1%8D%D0%BC%D0%B1%D1%8D%D0%BB%D1%8D%D1%85"><span class="header-section-number">8.5</span> Багана сонгох болон эрэмбэлэх</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D1%8B%D0%B3-%D2%AF%D0%BB%D0%B4%D1%8D%D1%8D%D1%85">Баганыг үлдээх</a></li>
<li><a class="nav-link" href="#clean_tidyselect">“tidyselect” туслах функцууд</a></li>
<li><a class="nav-link" href="#%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D1%8B%D0%B3-%D1%85%D0%B0%D1%81%D0%B0%D1%85">Баганыг хасах</a></li>
<li><a class="nav-link" href="#%D0%B4%D0%B0%D0%BD%D0%B3%D0%B0%D0%B0%D1%80%D0%B0%D0%B0-%D2%AF%D0%B9%D0%BB%D0%B4%D1%8D%D1%85-%D0%BA%D0%BE%D0%BC%D0%BC%D0%B0%D0%BD%D0%B4%D1%83%D1%83%D0%B4">Дангаараа үйлдэх коммандууд</a></li>
</ul>
</li>
<li><a class="nav-link" href="#%D0%B4%D0%B0%D0%B2%D1%85%D0%B0%D1%80%D0%B4%D0%B0%D0%BB%D1%82%D1%8B%D0%B3-%D0%B0%D1%80%D0%B8%D0%BB%D0%B3%D0%B0%D1%85"><span class="header-section-number">8.6</span> Давхардалтыг арилгах</a></li>
<li>
<a class="nav-link" href="#%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D0%B0-%D2%AF%D2%AF%D1%81%D0%B3%D1%8D%D1%85-%D0%B1%D0%B0-%D1%85%D1%83%D0%B2%D0%B8%D1%80%D0%B3%D0%B0%D1%85"><span class="header-section-number">8.7</span> Багана үүсгэх ба хувиргах</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%D1%88%D0%B8%D0%BD%D1%8D-%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D0%B0">Шинэ багана</a></li>
<li><a class="nav-link" href="#%D0%B1%D0%B0%D0%B3%D0%B0%D0%BD%D0%B0-%D0%B4%D0%B0%D1%85-%D0%B4%D0%B0%D1%82%D0%B0-%D1%82%D3%A9%D1%80%D0%BB%D0%B8%D0%B9%D0%B3-%D1%85%D1%83%D0%B2%D0%B8%D1%80%D0%B3%D0%B0%D1%85">Багана дах дата төрлийг хувиргах</a></li>
<li><a class="nav-link" href="#%D0%B1%D2%AF%D0%BB%D1%8D%D0%B3%D0%BB%D1%8D%D1%81%D1%8D%D0%BD-%D0%B4%D0%B0%D1%82%D0%B0">Бүлэглэсэн дата</a></li>
<li><a class="nav-link" href="#clean_across">Олон баганыг хувиргах</a></li>
<li><a class="nav-link" href="#coalesce">coalesce()</a></li>
<li><a class="nav-link" href="#cumulative-%D0%BC%D0%B0%D1%82%D0%B5%D0%BC%D0%B0%D1%82%D0%B8%D0%BA">Cumulative математик</a></li>
<li><a class="nav-link" href="#base-r--%D0%B3-%D0%B0%D1%88%D0%B8%D0%B3%D0%BB%D0%B0%D1%85">base R -г ашиглах</a></li>
<li><a class="nav-link" href="#pipe-%D1%85%D0%BE%D0%BB%D0%B1%D0%BE%D0%BE%D1%81%D0%BE%D0%BD%D0%B4-%D0%B7%D0%B0%D0%BB%D0%B3%D0%B0%D1%85">Pipe холбоосонд залгах</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#%D1%83%D1%82%D0%B3%D0%B0-%D3%A9%D3%A9%D1%80%D1%87%D0%BB%D3%A9%D1%85"><span class="header-section-number">8.8</span> Утга өөрчлөх</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%D3%A9%D0%B2%D3%A9%D1%80%D0%BC%D3%A9%D1%86-%D1%83%D1%82%D0%B3%D1%83%D1%83%D0%B4">Өвөрмөц утгууд</a></li>
<li><a class="nav-link" href="#%D0%BB%D0%BE%D0%B3%D0%B8%D0%BA-%D2%AF%D0%B9%D0%BB%D0%B4%D0%BB%D2%AF%D2%AF%D0%B4">Логик үйлдлүүд</a></li>
<li><a class="nav-link" href="#%D1%8D%D0%BD%D0%B3%D0%B8%D0%B9%D0%BD-%D0%BB%D0%BE%D0%B3%D0%B8%D0%BA-%D2%AF%D0%B9%D0%BB%D0%B4%D1%8D%D0%BB">Энгийн логик үйлдэл</a></li>
<li><a class="nav-link" href="#clean_case_when">Комплекс логик үйлдлүүд</a></li>
<li><a class="nav-link" href="#%D0%B4%D1%83%D1%82%D1%83%D1%83-%D1%83%D1%82%D0%B3%D0%B0">Дутуу утга</a></li>
<li><a class="nav-link" href="#%D1%86%D1%8D%D0%B2%D1%8D%D1%80%D0%BB%D1%8D%D0%B3%D1%8D%D1%8D%D0%BD%D0%B8%D0%B9-%D1%82%D0%BE%D0%BB%D1%8C-%D0%B1%D0%B8%D1%87%D0%B8%D0%B3">Цэвэрлэгээний толь бичиг</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#num_cats"><span class="header-section-number">8.9</span> Тоог ангилах</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%D1%82%D0%B0%D1%80%D1%85%D0%B0%D0%BB%D1%82%D1%8B%D0%B3-%D1%88%D0%B0%D0%BB%D0%B3%D0%B0%D1%85">Тархалтыг шалгах</a></li>
<li><a class="nav-link" href="#age_categories">age_categories()</a></li>
<li><a class="nav-link" href="#cut">cut()</a></li>
<li><a class="nav-link" href="#%D0%BA%D0%B2%D0%B0%D0%BD%D1%82%D0%B8%D0%BB-%D1%85%D1%83%D0%B2%D0%B0%D0%B0%D0%B3%D0%B4%D0%BB%D1%83%D1%83%D0%B4">Квантил хуваагдлууд</a></li>
<li><a class="nav-link" href="#%D1%82%D1%8D%D0%BD%D1%86%D2%AF%D2%AF-%D1%85%D1%8D%D0%BC%D0%B6%D1%8D%D1%8D%D1%82%D1%8D%D0%B9-%D0%B1%D2%AF%D0%BB%D0%B3%D2%AF%D2%AF%D0%B4-%D2%AF%D2%AF%D1%81%D0%B3%D1%8D%D1%85">Тэнцүү хэмжээтэй бүлгүүд үүсгэх</a></li>
<li><a class="nav-link" href="#case_when">case_when()</a></li>
<li><a class="nav-link" href="#%D1%86%D1%8D%D0%B2%D1%8D%D1%80%D0%BB%D1%8D%D1%85-%D1%85%D0%BE%D0%BB%D0%B1%D0%BE%D0%BE%D1%81%D1%82-%D0%B7%D0%B0%D0%BB%D0%B3%D0%B0%D1%85">Цэвэрлэх холбоост залгах</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#%D0%BC%D3%A9%D1%80-%D0%BD%D1%8D%D0%BC%D1%8D%D1%85"><span class="header-section-number">8.10</span> Мөр нэмэх</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%D0%BD%D1%8D%D0%B3-%D0%BD%D1%8D%D0%B3%D1%8D%D1%8D%D1%80-%D0%BD%D1%8D%D0%BC%D1%8D%D1%85">нэг нэгээр нэмэх</a></li>
<li><a class="nav-link" href="#%D0%BC%D3%A9%D1%80%D2%AF%D2%AF%D0%B4%D0%B8%D0%B9%D0%B3-%D1%85%D0%BE%D0%BB%D0%B1%D0%BE%D1%85">Мөрүүдийг холбох</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#%D0%BC%D3%A9%D1%80%D0%B8%D0%B9%D0%B3-%D1%88%D2%AF%D2%AF%D1%85"><span class="header-section-number">8.11</span> Мөрийг шүүх</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%D1%8D%D0%BD%D0%B3%D0%B8%D0%B9%D0%BD-%D1%88%D2%AF%D2%AF%D0%BB%D1%82-%D1%85%D0%B8%D0%B9%D1%85">Энгийн шүүлт хийх</a></li>
<li><a class="nav-link" href="#%D0%B4%D1%83%D1%82%D1%83%D1%83-%D1%83%D1%82%D0%B3%D1%83%D1%83%D0%B4%D1%8B%D0%B3-%D1%8F%D0%BB%D0%B3%D0%B0%D1%85">Дутуу утгуудыг ялгах</a></li>
<li><a class="nav-link" href="#%D0%BC%D3%A9%D1%80%D0%B8%D0%B9%D0%BD-%D0%B4%D1%83%D0%B3%D0%B0%D0%B0%D1%80%D0%B0%D0%B0%D1%80-%D1%88%D2%AF%D2%AF%D0%BB%D1%82-%D1%85%D0%B8%D0%B9%D1%85">Мөрийн дугаараар шүүлт хийх</a></li>
<li><a class="nav-link" href="#%D0%BA%D0%BE%D0%BC%D0%BF%D0%BB%D0%B5%D0%BA%D1%81-%D1%88%D2%AF%D2%AF%D0%BB%D1%82-%D1%85%D0%B8%D0%B9%D1%85">Комплекс шүүлт хийх</a></li>
<li><a class="nav-link" href="#%D0%B1%D0%B8%D0%B5-%D0%B4%D0%B0%D0%B0%D1%81%D0%B0%D0%BD-%D2%AF%D0%B9%D0%BB%D0%B4%D1%8D%D0%BB">Бие даасан үйлдэл</a></li>
<li><a class="nav-link" href="#%D0%BC%D3%A9%D1%80%D2%AF%D2%AF%D0%B4%D0%B8%D0%B9%D0%B3-%D1%82%D2%AF%D1%80%D0%B3%D1%8D%D0%BD-%D1%88%D0%B0%D0%BB%D0%B3%D0%B0%D1%85">Мөрүүдийг түргэн шалгах</a></li>
</ul>
</li>
<li><a class="nav-link" href="#%D0%BC%D3%A9%D1%80-%D0%B4%D0%B0%D0%B3%D1%83%D1%83-%D1%82%D0%BE%D0%BE%D1%86%D0%BE%D0%BE%D0%BB%D0%BE%D0%BB"><span class="header-section-number">8.12</span> Мөр дагуу тооцоолол</a></li>
<li><a class="nav-link" href="#%D1%8D%D1%80%D1%8D%D0%BC%D0%B1%D1%8D%D0%BB%D1%8D%D0%BD-%D1%8F%D0%BB%D0%B3%D0%B0%D1%85"><span class="header-section-number">8.13</span> Эрэмбэлэн ялгах</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Тархвар судлаачийн R гарын авлага</strong>" was written by гарын авлагын баг. It was last built on 2022-01-05.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
